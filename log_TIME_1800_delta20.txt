===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1-CUTS_-1-TIME_1800.0', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=1800.0, delta=20.0, obbt=-1, cuts=-1, pretrained_path='./saved_models/ARCH_2x200-EPOCHS_50-ID_10000/checkpoint_0.th')

RESUME_|ARCH_2x200-EPOCHS_50-ID_10000|checkpoint_0.th-ID_10000-TIME_1800.0-DELTA_20.0
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x200-EPOCHS_50-ID_10000/checkpoint_0.th'
=> loaded pretrained arch 98.14, with accuracy '2x200'
Test: [49/79]	Loss 0.0004 (0.0901) ([0.000]+[0.000])	Prec@1 100.000 (97.750)
 * Prec@1 98.140
Correct label is  tensor(3)  || Wrong label is  tensor(9)
Set parameter TokenServer to value "licences.gerad.lan"
Model for sequential:
800 variables
410 constraints
400 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0            (1, 200)          200          200            0            0

relu_1              (1, 200)          200            0            0          200

linear_2            (1, 200)          200          200            0            0

relu_3              (1, 200)          200            0            0          200

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 1800
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1979 rows, 2378 columns and 203130 nonzeros
Model fingerprint: 0x7045ad77
Model has 400 general constraints
Variable types: 2378 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e-08, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [4e-05, 2e+01]
Presolve removed 646 rows and 425 columns
Presolve time: 0.37s
Presolved: 1333 rows, 1953 columns, 200150 nonzeros
Variable types: 1650 continuous, 303 integer (303 binary)

Root relaxation: objective 9.696970e+02, 1696 iterations, 0.23 seconds (0.57 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  969.69696    0  210          -  969.69696      -     -    0s
     0     0  944.08321    0  241          -  944.08321      -     -    2s
     0     0  917.62833    0  236          -  917.62833      -     -    2s
     0     0  908.58651    0  221          -  908.58651      -     -    2s
     0     0  891.21210    0  238          -  891.21210      -     -    3s
     0     0  888.98309    0  235          -  888.98309      -     -    3s
     0     0  886.33481    0  229          -  886.33481      -     -    3s
     0     0  886.17966    0  232          -  886.17966      -     -    3s
     0     0  886.17772    0  232          -  886.17772      -     -    3s
     0     0  865.12374    0  231          -  865.12374      -     -    4s
     0     0  855.91197    0  230          -  855.91197      -     -    4s
     0     0  844.46628    0  231          -  844.46628      -     -    4s
     0     0  825.53341    0  224          -  825.53341      -     -    5s
     0     0  811.52607    0  222          -  811.52607      -     -    5s
     0     0  788.63407    0  229          -  788.63407      -     -    5s
     0     0  786.47463    0  225          -  786.47463      -     -    5s
     0     0  784.33023    0  227          -  784.33023      -     -    5s
     0     0  783.93215    0  226          -  783.93215      -     -    5s
     0     0  783.89698    0  227          -  783.89698      -     -    5s
     0     0  737.68238    0  221          -  737.68238      -     -    6s
     0     0  733.36780    0  217          -  733.36780      -     -    6s
     0     0  715.95446    0  219          -  715.95446      -     -    6s
     0     0  713.73943    0  220          -  713.73943      -     -    6s
     0     0  711.58848    0  218          -  711.58848      -     -    6s
     0     0  710.74949    0  221          -  710.74949      -     -    6s
     0     0  710.18411    0  221          -  710.18411      -     -    6s
     0     0  710.10757    0  219          -  710.10757      -     -    6s
     0     0  583.19216    0  244          -  583.19216      -     -    7s
     0     0  565.26140    0  242          -  565.26140      -     -    7s
     0     0  556.65107    0  241          -  556.65107      -     -    7s
     0     0  547.98776    0  240          -  547.98776      -     -    7s
     0     0  545.31798    0  240          -  545.31798      -     -    7s
     0     0  543.98241    0  241          -  543.98241      -     -    7s
     0     0  543.32071    0  243          -  543.32071      -     -    7s
     0     0  543.17771    0  241          -  543.17771      -     -    7s
     0     0  517.98764    0  245          -  517.98764      -     -    8s
     0     0  511.09380    0  243          -  511.09380      -     -    8s
     0     0  508.69196    0  243          -  508.69196      -     -    8s
     0     0  506.91133    0  243          -  506.91133      -     -    8s
     0     0  506.06939    0  242          -  506.06939      -     -    8s
     0     0  505.59575    0  243          -  505.59575      -     -    8s
     0     0  505.28483    0  244          -  505.28483      -     -    8s
     0     0  484.08773    0  240          -  484.08773      -     -    9s
     0     0  479.54857    0  238          -  479.54857      -     -    9s
     0     0  478.36619    0  239          -  478.36619      -     -    9s
     0     0  476.79274    0  238          -  476.79274      -     -    9s
     0     0  476.11212    0  239          -  476.11212      -     -    9s
     0     0  475.45860    0  239          -  475.45860      -     -   10s
     0     0  475.31518    0  239          -  475.31518      -     -   10s
     0     0  466.17728    0  245          -  466.17728      -     -   10s
     0     0  465.56784    0  242          -  465.56784      -     -   10s
     0     0  465.10597    0  243          -  465.10597      -     -   10s
     0     0  444.87109    0  246          -  444.87109      -     -   11s
     0     0  443.03220    0  246          -  443.03220      -     -   11s
     0     0  441.78334    0  246          -  441.78334      -     -   11s
     0     0  441.04948    0  245          -  441.04948      -     -   11s
     0     0  440.64605    0  245          -  440.64605      -     -   11s
     0     0  436.27276    0  245          -  436.27276      -     -   12s
     0     0  434.49550    0  246          -  434.49550      -     -   13s
     0     0  433.99166    0  245          -  433.99166      -     -   13s
     0     0  433.15689    0  248          -  433.15689      -     -   13s
H    0     0                     -24.6536920  433.15689  1857%     -   14s
H    0     0                     -24.6536920  433.15689  1857%     -   17s
     0     2  433.15689    0  248  -24.65369  433.15689  1857%     -   17s
    31    64  358.81348    5  238  -24.65369  399.40797  1720%   529   21s
H   36    64                     -24.6536919  399.07307  1719%   500   21s
H   49    64                     -24.6536913  387.77861  1673%   496   21s
    63    96  349.46201    6  238  -24.65369  382.92410  1653%   553   25s
   191   224  318.44541    8  228  -24.65369  373.92244  1617%   470   31s
   501   568  290.23741   12  225  -24.65369  373.92244  1617%   341   35s
  1293  1393  243.58671   18  218  -24.65369  373.92244  1617%   239   40s
  2394  2337  191.27734   32  194  -24.65369  373.92244  1617%   189   45s
  2723  2523  179.88857   35  193  -24.65369  373.92244  1617%   183   67s
H 2728  2523                     -24.6536911  373.92244  1617%   183   67s
H 2734  2523                     -24.6536910  373.92244  1617%   183   67s
H 2737  2523                     -24.6536909  373.92244  1617%   183   67s
H 2752  2523                     -24.6536889  373.92244  1617%   183   67s
H 2753  2523                     -24.6536846  373.92244  1617%   183   67s
  3223  3260  166.97898   38  186  -24.65368  373.92244  1617%   173   70s
  5061  4662  114.88206   53  166  -24.65368  373.92244  1617%   146   76s
  5487  4920  208.09882   26  248  -24.65368  373.92244  1617%   144  123s
  5489  4921  328.53896   10  211  -24.65368  373.92244  1617%   144  126s
  5504  4931  117.59606   50  245  -24.65368  373.92244  1617%   144  130s
  5514  4938  238.40296   25  252  -24.65368  373.92244  1617%   143  135s
  5528  4947   63.61448   77  251  -24.65368  360.99516  1564%   143  141s
  5538  4954  130.09448   48  257  -24.65368  352.44719  1530%   143  145s
  5544  4958  166.67289   39  260  -24.65368  336.48952  1465%   142  151s
  5555  4965  111.98173   60  259  -24.65368  316.50963  1384%   142  155s
  5565  4972   84.66555   50  261  -24.65368  305.86238  1341%   142  160s
  5566  4973  122.44856   50  261  -24.65368  305.86238  1341%   142  167s
  5568  4977  291.56493   11  252  -24.65368  304.51005  1335%   146  171s
  5582  5000  237.20266   14  249  -24.65368  274.23637  1212%   147  175s
  5598  5027  233.11079   15  249  -24.65368  258.40282  1148%   149  180s
  5662  5068  225.60369   16  244  -24.65368  256.54552  1141%   154  185s
H 5663  4817                     -23.2594165  256.54552  1203%   154  185s
H 5675  4575                     -22.7934178  256.54552  1226%   154  185s
H 5684  4346                     -22.7827781  256.54552  1226%   155  185s
H 5687  4131                     -21.9756992  256.54552  1267%   155  185s
  5863  4267  210.95268   19  232  -21.97570  256.54552  1267%   159  190s
  6118  4434  198.71463   22  235  -21.97570  256.54552  1267%   163  197s
  6276  4575  198.75270   24  237  -21.97570  256.54552  1267%   163  200s
  6657  4822  183.46002   28  232  -21.97570  256.54552  1267%   165  205s
H 6744  4640                     -18.5167333  256.54552  1485%   165  208s
H 6761  4441                     -17.9628701  256.54552  1528%   166  208s
H 6769  4255                     -17.8341487  256.54552  1539%   166  208s
H 6772  4080                     -17.4682292  256.54552  1569%   165  208s
H 6773  3913                     -17.4655871  256.54552  1569%   165  208s
  6981  4195  166.07801   31  228  -17.46559  256.54552  1569%   166  210s
  8026  4758  150.91144   36  220  -17.46559  256.54552  1569%   163  215s
  9242  5421  125.08025   41  210  -17.46559  256.54552  1569%   160  220s
 10310  5998  116.78961   45  203  -17.46559  256.54552  1569%   156  227s
H10324  5829                     -15.1704585  256.54552  1791%   157  227s
H10336  5672                     -14.8789575  256.54552  1824%   157  227s
H10341  5512                     -13.0319161  256.54552  2069%   157  227s
 10875  5936  105.34983   48  199  -13.03192  256.54552  2069%   155  230s
 11667  6367   93.83467   52  194  -13.03192  256.54552  2069%   153  276s
H11669  6094                      -8.4917366  256.54552  3121%   153  276s
 11997  6009   93.94841   52  193   -8.49174  256.54552  3121%   151  302s
H11999  5880                      -8.4917344  256.54552  3121%   151  302s
 12508  6467   87.59029   55  190   -8.49173  256.54552  3121%   150  306s
 13492  7202   75.83124   60  182   -8.49173  256.54552  3121%   148  312s
H13496  7177                      -7.7465460  256.54552  3412%   148  312s
 14350  7993   66.67037   65  175   -7.74655  256.54552  3412%   146  315s
H14799  8298                      -7.7160346  256.54552  3425%   145  319s
H14800  8287                      -7.3894588  256.54552  3572%   145  319s
H14854  8273                      -7.1268748  256.54552  3700%   145  319s
 15115  8814   55.23839   72  160   -7.12687  256.54552  3700%   145  321s
 16563 10193   41.00817   81  145   -7.12687  256.54552  3700%   142  326s
 18163 11741   26.77307   90  137   -7.12687  256.54552  3700%   140  330s
 20799 14224   10.26591  113  106   -7.12687  256.54552  3700%   138  336s
H21862 14611                      -6.4722055  256.54552  4064%   136  341s
H22079 14529                      -5.5381947  256.54552  4732%   136  341s
 23389 16441     cutoff  137        -5.53819  253.61898  4679%   134  347s
 25985 18776   72.24106   74  162   -5.53819  248.87713  4594%   130  352s
 28659 21058   70.02389   52  180   -5.53819  238.26385  4402%   125  357s
 30136 23403  223.11982   17  236   -5.53819  227.27909  4204%   123  362s
 34220 25383  208.58342   21  227   -5.53819  224.02828  4145%   119  367s
H36603 26711                      -5.4789378  224.02828  4189%   117  373s
H36730 26709                      -5.4446399  224.02828  4215%   117  373s
H36735 26696                      -5.2675647  224.02828  4353%   117  373s
H36849 26559                      -4.3459590  224.02828  5255%   117  373s
H36964 26487                      -4.0279863  224.02828  5662%   117  373s
H37193 25684                      -0.6450843  224.02828      -   117  402s
H37203 25666                      -0.5576646  224.02828      -   117  402s
H37204 25660                      -0.5302130  224.02828      -   117  402s
H37217 25650                      -0.5012831  224.02828      -   117  402s
H37220 25530                      -0.0274517  224.02828      -   117  402s
 37232 26468  165.59148   29  218   -0.02745  224.02828      -   117  405s
H40039 27521                       1.4148943  224.02828      -   115  439s
H40045 27479                       1.5518721  224.02828      -   115  439s

Cutting planes:
  Gomory: 11
  Cover: 5
  Implied bound: 23
  MIR: 1010
  Flow cover: 1142
  Inf proof: 3
  Relax-and-lift: 13

Explored 40075 nodes (4635069 simplex iterations) in 439.15 seconds (1120.92 work units)
Thread count was 32 (of 96 available processors)

Solution count 10: 1.55187 1.41489 -0.0274517 ... -5.26756

Optimization achieved user objective limit
Best objective 1.551872083197e+00, best bound 2.240282817683e+02, gap 14336.0018%
Solution is classified as 9
Time elapsed for full adv. : 439.9426 sec

{'Acc': 98.14, 'Loss': 0.0013320106081664562, 'Elapsed': 439.170578956604, 'Nodes': 40075.0, 'Arch': '2x200'}
Saved to ./res/GRID/OBBT_-1-CUTS_-1-TIME_1800.0/RESUME_|ARCH_2x200-EPOCHS_50-ID_10000|checkpoint_0.th-ID_10000-TIME_1800.0-DELTA_20.0.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1-CUTS_-1-TIME_1800.0', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=1800.0, delta=20.0, obbt=-1, cuts=-1, pretrained_path='./saved_models/ARCH_2x200-EPOCHS_50-ID_10000/checkpoint_1.th', seed=0)

RESUME_|ARCH_2x200-EPOCHS_50-ID_10000|checkpoint_1.th-ID_10000-TIME_1800.0-DELTA_20.0
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x200-EPOCHS_50-ID_10000/checkpoint_1.th'
=> loaded pretrained arch 98.04, with accuracy '2x200'
Test: [49/79]	Loss 0.0000 (0.0958) ([0.000]+[0.000])	Prec@1 100.000 (97.578)
 * Prec@1 98.040
Correct label is  tensor(3)  || Wrong label is  tensor(9)
Model for sequential:
800 variables
410 constraints
400 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0            (1, 200)          200          200            0            0

relu_1              (1, 200)          200            0            0          200

linear_2            (1, 200)          200          200            0            0

relu_3              (1, 200)          200            0            0          200

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 1800
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1979 rows, 2378 columns and 203130 nonzeros
Model fingerprint: 0xd26601cd
Model has 400 general constraints
Variable types: 2378 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [5e-07, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-05, 2e+01]
Presolve removed 644 rows and 423 columns
Presolve time: 0.38s
Presolved: 1335 rows, 1955 columns, 200156 nonzeros
Variable types: 1651 continuous, 304 integer (304 binary)

Root relaxation: objective 1.003807e+03, 1902 iterations, 0.22 seconds (0.54 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 1003.80691    0  207          - 1003.80691      -     -    0s
     0     0  963.93676    0  206          -  963.93676      -     -    2s
     0     0  944.68788    0  221          -  944.68788      -     -    2s
     0     0  935.44225    0  227          -  935.44225      -     -    2s
     0     0  926.83995    0  229          -  926.83995      -     -    3s
     0     0  926.71862    0  224          -  926.71862      -     -    3s
     0     0  925.84582    0  225          -  925.84582      -     -    3s
     0     0  901.69913    0  220          -  901.69913      -     -    4s
     0     0  891.83580    0  203          -  891.83580      -     -    4s
     0     0  887.60887    0  222          -  887.60887      -     -    4s
     0     0  880.60311    0  233          -  880.60311      -     -    4s
     0     0  864.35134    0  235          -  864.35134      -     -    4s
     0     0  864.35134    0  233          -  864.35134      -     -    5s
     0     0  849.18711    0  233          -  849.18711      -     -    5s
     0     0  846.04233    0  233          -  846.04233      -     -    5s
     0     0  841.49300    0  235          -  841.49300      -     -    5s
     0     0  840.70273    0  235          -  840.70273      -     -    5s
     0     0  840.58806    0  236          -  840.58806      -     -    5s
     0     0  840.57998    0  235          -  840.57998      -     -    5s
     0     0  760.18377    0  229          -  760.18377      -     -    6s
     0     0  751.39781    0  235          -  751.39781      -     -    6s
     0     0  736.91273    0  231          -  736.91273      -     -    6s
     0     0  733.21413    0  229          -  733.21413      -     -    6s
     0     0  732.60672    0  231          -  732.60672      -     -    6s
     0     0  731.50685    0  229          -  731.50685      -     -    6s
     0     0  731.00227    0  231          -  731.00227      -     -    6s
     0     0  730.50227    0  231          -  730.50227      -     -    6s
     0     0  730.48311    0  231          -  730.48311      -     -    6s
     0     0  670.45957    0  224          -  670.45957      -     -    7s
     0     0  666.27165    0  225          -  666.27165      -     -    7s
     0     0  665.10777    0  225          -  665.10777      -     -    7s
     0     0  664.85510    0  227          -  664.85510      -     -    7s
     0     0  635.08827    0  226          -  635.08827      -     -    7s
     0     0  617.50648    0  237          -  617.50648      -     -    7s
     0     0  613.40766    0  239          -  613.40766      -     -    8s
     0     0  611.33529    0  240          -  611.33529      -     -    8s
     0     0  610.38613    0  237          -  610.38613      -     -    8s
     0     0  609.36892    0  238          -  609.36892      -     -    8s
     0     0  608.60214    0  237          -  608.60214      -     -    8s
     0     0  608.34506    0  238          -  608.34506      -     -    8s
     0     0  583.30301    0  238          -  583.30301      -     -    9s
     0     0  580.92617    0  238          -  580.92617      -     -    9s
     0     0  579.26546    0  237          -  579.26546      -     -    9s
     0     0  577.80903    0  241          -  577.80903      -     -    9s
     0     0  577.07029    0  237          -  577.07029      -     -    9s
     0     0  576.90314    0  237          -  576.90314      -     -    9s
     0     0  562.33060    0  236          -  562.33060      -     -    9s
     0     0  561.55694    0  235          -  561.55694      -     -   10s
     0     0  560.16076    0  238          -  560.16076      -     -   10s
     0     0  559.54538    0  239          -  559.54538      -     -   10s
     0     0  556.40014    0  239          -  556.40014      -     -   10s
     0     0  555.41676    0  238          -  555.41676      -     -   10s
     0     0  554.24603    0  241          -  554.24603      -     -   10s
     0     0  553.79373    0  239          -  553.79373      -     -   10s
     0     0  553.59713    0  242          -  553.59713      -     -   10s
     0     0  542.15108    0  243          -  542.15108      -     -   11s
     0     0  541.46505    0  242          -  541.46505      -     -   11s
     0     0  540.76179    0  244          -  540.76179      -     -   11s
     0     0  540.40777    0  246          -  540.40777      -     -   11s
     0     0  539.19095    0  244          -  539.19095      -     -   11s
H    0     0                     -23.1436863  539.19095  2430%     -   12s
     0     0  539.19095    0  244  -23.14369  539.19095  2430%     -   12s
     0     2  539.19095    0  244  -23.14369  539.19095  2430%     -   14s
     1     4  522.89073    1  238  -23.14369  539.18197  2430%   236   15s
H   34    64                     -23.1436862  481.23009  2179%   433   17s
H   38    64                     -23.1436861  481.23009  2179%   423   17s
H   45    64                     -23.1436848  481.23009  2179%   400   17s
    95   128  455.92086    6  231  -23.14368  472.77906  2143%   485   20s
   613   679  369.17001   12  226  -23.14368  472.35419  2141%   314   25s
  2062  2074  284.50341   23  210  -23.14368  472.35419  2141%   197   30s
  2198  2106  267.52390   26  206  -23.14368  472.35419  2141%   195   45s
H 2200  2106                     -23.1435953  472.35419  2141%   195   45s
H 2204  2106                     -23.0641187  472.35419  2148%   196   45s
  3425  3372  164.46226   45  183  -23.06412  472.35419  2148%   179   52s
H 3440  3372                     -22.1908531  472.35419  2229%   179   52s
H 3451  3369                     -21.2507085  472.35419  2323%   179   52s
H 3452  3363                     -20.6728512  472.35419  2385%   179   52s
H 3453  3330                     -18.2216343  472.35419  2692%   179   52s
  4404  4383  117.79232   61  163  -18.22163  472.35419  2692%   167   55s
H 4712  4429                     -13.5357030  472.35419  3590%   164   58s
H 4728  4422                     -13.3349403  472.35419  3642%   164   58s
H 4745  4419                     -13.2809434  472.35419  3657%   165   58s
H 4778  4413                     -12.9832036  472.35419  3738%   164   58s
H 4779  4408                     -12.6360546  472.35419  3838%   164   58s
H 4788  4390                     -11.5074287  472.35419  4205%   164   58s
H 4806  4382                     -11.1281680  472.35419  4345%   164   58s
H 4829  4380                     -11.0316019  472.35419  4382%   164   58s
  5675  5549   71.60876   85  136  -11.03160  472.35419  4382%   155   60s
  6597  6037  267.14572   26  244  -11.03160  472.35419  4382%   148  105s
H 6598  5736                     -11.0316012  472.35419  4382%   148  107s
H 6598  5449                     -11.0316010  472.35419  4382%   148  107s
  6600  5450    1.29321   74  220  -11.03160  472.35419  4382%   148  110s
  6619  5463  348.82816   15  246  -11.03160  472.35419  4382%   147  115s
  6631  5471   50.75409   70  247  -11.03160  423.94768  3943%   147  120s
  6649  5483  165.38883   48  247  -11.03160  395.80070  3688%   147  126s
H 6652  5210                     -11.0316006  393.18468  3664%   147  128s
  6656  5212  195.38421   36  250  -11.03160  389.07576  3627%   146  130s
  6659  5214  388.38207    8  250  -11.03160  388.38207  3621%   146  138s
H 6662  4957                     -11.0316000  388.38207  3621%   149  141s
  6666  4959  116.04507   50  227  -11.03160  388.38207  3621%   149  145s
  6685  4972  261.45835   24  248  -11.03160  360.86461  3371%   148  150s
  6693  4977   20.78554   61  247  -11.03160  350.05740  3273%   148  155s
  6697  4980  267.14572   26  246  -11.03160  348.74678  3261%   148  193s
  6699  4983   75.46729   46  244  -11.03160  348.74678  3261%   149  195s
  6702  4985  120.29501   52  232  -11.03160  179.11446  1724%   149  200s
  6710  4990   91.29286   77  234  -11.03160  153.37498  1490%   149  205s
  6720  4997   74.34479   76  223  -11.03160  138.25770  1353%   149  210s
  6724  5000   43.71184   69  224  -11.03160  136.25327  1335%   149  252s
H 6727  4752                     -11.0315972   88.85923   905%   150  258s
  6728  4752   25.71452   89  187  -11.03160   83.82003   860%   150  261s
  6736  4758   78.64101   71  211  -11.03160   78.64101   813%   150  265s
  6741  4761   77.13249    8  230  -11.03160   77.13249   799%   150  270s
  6743  4762   76.83144   43  237  -11.03160   76.83144   796%   150  332s
  6747  4766   76.83144    9  187  -11.03160   76.83144   796%   150  337s
  6756  4772   76.39002   36  237  -11.03160   76.39002   792%   150  341s
  6758  4774   76.04060   18  236  -11.03160   76.04060   789%   150  345s
  6762  4776   75.38055   13  222  -11.03160   75.38055   783%   150  411s
  6766  4780   75.38055   50  187  -11.03160   75.38055   783%   150  417s
  6774  4786   29.18656   52  224  -11.03160   75.29803   783%   150  420s
  6777  4788   74.43147   21  221  -11.03160   74.43147   775%   150  425s
  6780  4790   74.31752   46  216  -11.03160   74.31752   774%   150  486s
  6844  4865   67.59053   64  199  -11.03160   70.17532   736%   151  490s
H 6878  4646                     -10.9153087   70.16467   743%   151  491s
H 6880  4417                     -10.4935906   70.16467   769%   151  491s
H 6893  4196                     -10.4903052   70.16467   769%   151  491s
  7274  4473   55.20007   70  183  -10.49031   70.16467   769%   148  495s
H 7652  4514                     -10.4812266   70.16467   769%   144  506s
H 7653  4319                     -10.4664213   70.16467   770%   144  506s
H 7661  4130                     -10.4564132   70.16467   771%   144  506s
H 7667  3952                     -10.4410978   70.16467   772%   144  506s
H 7679  3780                     -10.4170661   70.16467   774%   144  506s
  8698  4423   56.65096   80  187  -10.41707   70.16467   774%   132  519s
H 8732  4281                     -10.4170661   70.16467   774%   132  553s
H 8733  4130                     -10.4170661   70.16467   774%   132  553s
  9253  4491   55.34119   83  182  -10.41707   70.16467   774%   128  555s
*12686  6016             271      -6.1473947   70.16467  1241%   110  559s
 13488  6543   41.70080  104  139   -6.14739   70.16467  1241%   106  560s
H17027  7399                       5.5575685   70.16467  1163%  94.3  563s

Cutting planes:
  Gomory: 17
  MIR: 154
  Flow cover: 2

Explored 17597 nodes (1639668 simplex iterations) in 563.24 seconds (1106.26 work units)
Thread count was 32 (of 96 available processors)

Solution count 10: 5.55757 -6.14739 -10.4171 ... -13.2809

Optimization achieved user objective limit
Best objective 5.557568527463e+00, best bound 7.016466921183e+01, gap 1162.5066%
Solution is classified as 9
Time elapsed for full adv. : 563.3936 sec

{'Acc': 98.04, 'Loss': 0.0010240235133096576, 'Elapsed': 563.2452549934387, 'Nodes': 17597.0, 'Arch': '2x200'}
Saved to ./res/GRID/OBBT_-1-CUTS_-1-TIME_1800.0/RESUME_|ARCH_2x200-EPOCHS_50-ID_10000|checkpoint_1.th-ID_10000-TIME_1800.0-DELTA_20.0.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1-CUTS_-1-TIME_1800.0', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=1800.0, delta=20.0, obbt=-1, cuts=-1, pretrained_path='./saved_models/ARCH_2x200-EPOCHS_50-ID_10000/checkpoint_2.th', seed=0)

RESUME_|ARCH_2x200-EPOCHS_50-ID_10000|checkpoint_2.th-ID_10000-TIME_1800.0-DELTA_20.0
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x200-EPOCHS_50-ID_10000/checkpoint_2.th'
=> loaded pretrained arch 97.95, with accuracy '2x200'
Test: [49/79]	Loss 0.0002 (0.0949) ([0.000]+[0.000])	Prec@1 100.000 (97.484)
 * Prec@1 97.950
Correct label is  tensor(3)  || Wrong label is  tensor(5)
Model for sequential:
800 variables
410 constraints
400 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0            (1, 200)          200          200            0            0

relu_1              (1, 200)          200            0            0          200

linear_2            (1, 200)          200          200            0            0

relu_3              (1, 200)          200            0            0          200

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 1800
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1979 rows, 2378 columns and 203130 nonzeros
Model fingerprint: 0x6b125f9b
Model has 400 general constraints
Variable types: 2378 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [5e-07, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [5e-05, 2e+01]
Presolve removed 650 rows and 429 columns
Presolve time: 0.36s
Presolved: 1329 rows, 1949 columns, 200141 nonzeros
Variable types: 1648 continuous, 301 integer (301 binary)

Root relaxation: objective 1.017107e+03, 1753 iterations, 0.25 seconds (0.66 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 1017.10747    0  217          - 1017.10747      -     -    0s
     0     0  977.07376    0  212          -  977.07376      -     -    2s
     0     0  962.02941    0  211          -  962.02941      -     -    2s
     0     0  939.79817    0  209          -  939.79817      -     -    2s
     0     0  925.73016    0  220          -  925.73016      -     -    2s
     0     0  923.42729    0  221          -  923.42729      -     -    3s
     0     0  923.37607    0  223          -  923.37607      -     -    3s
     0     0  880.57254    0  213          -  880.57254      -     -    4s
     0     0  852.56038    0  205          -  852.56038      -     -    4s
     0     0  842.03141    0  204          -  842.03141      -     -    4s
     0     0  824.99356    0  205          -  824.99356      -     -    4s
     0     0  806.96364    0  213          -  806.96364      -     -    4s
     0     0  775.33997    0  223          -  775.33997      -     -    4s
     0     0  772.69898    0  221          -  772.69898      -     -    4s
     0     0  771.57022    0  224          -  771.57022      -     -    5s
     0     0  769.57977    0  223          -  769.57977      -     -    5s
     0     0  769.45161    0  223          -  769.45161      -     -    5s
     0     0  769.43207    0  223          -  769.43207      -     -    5s
     0     0  735.11912    0  220          -  735.11912      -     -    5s
     0     0  716.79350    0  216          -  716.79350      -     -    5s
     0     0  690.98216    0  221          -  690.98216      -     -    5s
     0     0  684.58873    0  221          -  684.58873      -     -    5s
     0     0  683.41108    0  222          -  683.41108      -     -    6s
     0     0  682.28888    0  224          -  682.28888      -     -    6s
     0     0  681.67248    0  222          -  681.67248      -     -    6s
     0     0  681.58498    0  223          -  681.58498      -     -    6s
     0     0  562.04068    0  232          -  562.04068      -     -    6s
     0     0  548.09458    0  230          -  548.09458      -     -    6s
     0     0  543.06866    0  232          -  543.06866      -     -    6s
     0     0  538.79436    0  231          -  538.79436      -     -    7s
     0     0  537.05470    0  233          -  537.05470      -     -    7s
     0     0  536.77720    0  233          -  536.77720      -     -    7s
     0     0  502.46508    0  234          -  502.46508      -     -    7s
     0     0  496.51626    0  230          -  496.51626      -     -    7s
     0     0  493.80261    0  233          -  493.80261      -     -    7s
     0     0  492.83029    0  233          -  492.83029      -     -    7s
     0     0  490.92745    0  233          -  490.92745      -     -    8s
     0     0  490.45305    0  233          -  490.45305      -     -    8s
     0     0  463.47597    0  233          -  463.47597      -     -    8s
     0     0  459.82973    0  235          -  459.82973      -     -    8s
     0     0  458.48692    0  236          -  458.48692      -     -    8s
     0     0  457.40463    0  236          -  457.40463      -     -    8s
     0     0  457.05189    0  237          -  457.05189      -     -    8s
     0     0  452.92017    0  241          -  452.92017      -     -    9s
     0     0  451.46625    0  240          -  451.46625      -     -    9s
     0     0  450.65625    0  238          -  450.65625      -     -    9s
     0     0  449.77145    0  237          -  449.77145      -     -    9s
     0     0  449.02591    0  239          -  449.02591      -     -    9s
     0     0  448.70299    0  238          -  448.70299      -     -    9s
     0     0  447.41390    0  238          -  447.41390      -     -   10s
H    0     0                     -16.2939697  447.41390  2846%     -   10s
     0     0  447.41390    0  238  -16.29397  447.41390  2846%     -   11s
     0     2  447.41390    0  238  -16.29397  447.41390  2846%     -   13s
     7    16  405.28868    3  234  -16.29397  425.30988  2710%   338   15s
    95   128  356.24294    6  234  -16.29397  390.56015  2497%   349   22s
H   96   128                     -16.1470548  390.56015  2519%   345   22s
H  106   128                     -16.1104770  390.56015  2524%   366   22s
H  112   128                     -15.9533797  390.56015  2548%   355   22s
H  118   128                     -14.8084546  390.56015  2737%   354   22s
   225   262  340.41498    8  233  -14.80845  390.56015  2737%   345   25s
   657   738  267.59094   13  223  -14.80845  390.56015  2737%   289   30s
  1021  1054  224.67857   16  212  -14.80845  390.56015  2737%   252   46s
  1189  1222  216.36249   18  216  -14.80845  390.56015  2737%   239   50s
H 1191  1222                      -2.1408055  390.56015      -   239   50s
  1819  1843  182.09882   23  206   -2.14081  390.56015      -   206   55s
  2511  2559  142.84070   30  199   -2.14081  390.56015      -   198   60s
* 3774  3612             244      -1.5296782  390.56015      -   173   64s
  3865  3824   94.99639   43  178   -1.52968  390.56015      -   172   65s
  4674  4287    9.95101   80  238   -1.52968  390.56015      -   165  107s
  4676  4288  274.13700   13  213   -1.52968  390.56015      -   165  111s
  4695  4301   77.52115   72  241   -1.52968  390.56015      -   164  116s
  4709  4310   87.51854   45  242   -1.52968  381.59634      -   164  121s
  4723  4320   61.43352   39  247   -1.52968  345.71414      -   163  125s
  4733  4326   34.73769   59  249   -1.52968  330.94375      -   163  130s
  4735  4328    7.31543   80  252   -1.52968  330.51755      -   163  175s
H 4738  4114                      -1.5296782  199.89505      -   166  181s
  4740  4115   50.19478   49  241   -1.52968  175.38104      -   166  185s
  4755  4125  153.65997   11  232   -1.52968  153.65997      -   165  190s
  4763  4130   30.34898  146  227   -1.52968  146.54555  9680%   165  195s
  4765  4132   26.37525   64  228   -1.52968  145.58792  9618%   165  235s
  4769  4135   97.80203    8  189   -1.52968   97.80203  6494%   167  241s
  4776  4140   86.83381   13  193   -1.52968   86.83381  5777%   166  245s
  4781  4143   85.00906   34  231   -1.52968   85.00906  5657%   166  250s
  4783  4145   38.84805   56  232   -1.52968   84.53991  5627%   166  309s
  4785  4147   84.53991   35  238   -1.52968   84.53991  5627%   167  311s
  4788  4149   84.53991   15  235   -1.52968   84.53991  5627%   167  315s
  4796  4154   13.41621   89  235   -1.52968   83.27153  5544%   167  321s
  4800  4157   15.82013   53  218   -1.52968   82.41624  5488%   167  384s
  4802  4160   82.41624   11  238   -1.52968   82.41624  5488%   167  386s
H 4803  3952                      -1.5296781   82.41624  5488%   167  387s
  4805  3953    9.98596   75  220   -1.52968   82.41624  5488%   167  390s
  4813  3958   82.07532   23  231   -1.52968   82.07532  5466%   167  395s
  4817  3961   81.45314   41  230   -1.52968   81.45314  5425%   167  400s
  4818  3962   15.81485   77  230   -1.52968   81.45314  5425%   167  463s
  4820  3964   81.45314   14  238   -1.52968   81.45314  5425%   168  465s
H 4821  3766                      -1.5296714   81.45314  5425%   168  466s
  4823  3767   61.43352   39  234   -1.52967   81.45314  5425%   168  470s
  4833  3774   34.73769   59  226   -1.52967   81.16009  5406%   167  476s
  4836  3776   44.48960   46  199   -1.52967   80.78596  5381%   167  480s
  4837  3776    5.57212   98  199   -1.52967   80.78596  5381%   167  486s
  4869  3831   38.55114   87  171   -1.52967   75.94398  5065%   169  490s
  5452  4235   29.59334   96  162   -1.52967   75.33092  5025%   159  495s
H 5977  4352                       3.1418062   75.33092  2298%   148  508s

Cutting planes:
  Gomory: 14
  MIR: 171

Explored 6014 nodes (900918 simplex iterations) in 508.13 seconds (938.02 work units)
Thread count was 32 (of 96 available processors)

Solution count 8: 3.14181 -1.52967 -1.52968 ... -16.1471

Optimization achieved user objective limit
Best objective 3.141806210925e+00, best bound 7.533092118807e+01, gap 2297.6947%
Solution is classified as 5
Time elapsed for full adv. : 508.3169 sec

{'Acc': 97.95, 'Loss': 0.0013240360422059894, 'Elapsed': 508.13863801956177, 'Nodes': 6014.0, 'Arch': '2x200'}
Saved to ./res/GRID/OBBT_-1-CUTS_-1-TIME_1800.0/RESUME_|ARCH_2x200-EPOCHS_50-ID_10000|checkpoint_2.th-ID_10000-TIME_1800.0-DELTA_20.0.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1-CUTS_-1-TIME_1800.0', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=1800.0, delta=20.0, obbt=-1, cuts=-1, pretrained_path='./saved_models/ARCH_6x100-EPOCHS_50-ID_10000/checkpoint_0.th', seed=0)

RESUME_|ARCH_6x100-EPOCHS_50-ID_10000|checkpoint_0.th-ID_10000-TIME_1800.0-DELTA_20.0
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_6x100-EPOCHS_50-ID_10000/checkpoint_0.th'
=> loaded pretrained arch 97.6, with accuracy '6x100'
Test: [49/79]	Loss 0.0025 (0.2426) ([0.003]+[0.000])	Prec@1 100.000 (97.156)
 * Prec@1 97.600
Correct label is  tensor(3)  || Wrong label is  tensor(9)
Model for sequential:
1200 variables
610 constraints
600 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0            (1, 100)          100          100            0            0

relu_1              (1, 100)          100            0            0          100

linear_2            (1, 100)          100          100            0            0

relu_3              (1, 100)          100            0            0          100

linear_4            (1, 100)          100          100            0            0

relu_5              (1, 100)          100            0            0          100

linear_6            (1, 100)          100          100            0            0

relu_7              (1, 100)          100            0            0          100

linear_8            (1, 100)          100          100            0            0

relu_9              (1, 100)          100            0            0          100

linear_10           (1, 100)          100          100            0            0

relu_11             (1, 100)          100            0            0          100

linear_12            (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 1800
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 2179 rows, 2778 columns and 133930 nonzeros
Model fingerprint: 0x3d4a3d28
Model has 600 general constraints
Variable types: 2778 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e-07, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [5e-05, 2e+01]
Presolve added 181 rows and 202 columns
Presolve time: 0.61s
Presolved: 2360 rows, 2980 columns, 133852 nonzeros
Variable types: 2097 continuous, 883 integer (883 binary)

Root relaxation: objective 4.218493e+04, 12103 iterations, 2.19 seconds (4.18 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 42184.9278    0  567          - 42184.9278      -     -    2s
     0     0 42175.1859    0  574          - 42175.1859      -     -    4s
     0     0 41925.4648    0  570          - 41925.4648      -     -    5s
     0     0 40051.8632    0  616          - 40051.8632      -     -    6s
     0     0 40051.6874    0  618          - 40051.6874      -     -    6s
     0     0 40051.6574    0  617          - 40051.6574      -     -    6s
     0     0 40051.6574    0  617          - 40051.6574      -     -    6s
     0     0 39987.6935    0  637          - 39987.6935      -     -    8s
     0     0 39933.5759    0  633          - 39933.5759      -     -    9s
     0     0 39846.2726    0  648          - 39846.2726      -     -    9s
     0     0 39821.0033    0  654          - 39821.0033      -     -   10s
     0     0 39819.4152    0  650          - 39819.4152      -     -   10s
     0     0 39818.4085    0  653          - 39818.4085      -     -   10s
     0     0 39816.9403    0  650          - 39816.9403      -     -   11s
     0     0 39816.8462    0  650          - 39816.8462      -     -   11s
     0     0 39793.1147    0  657          - 39793.1147      -     -   12s
     0     0 39756.2882    0  674          - 39756.2882      -     -   12s
     0     0 39736.4283    0  676          - 39736.4283      -     -   13s
     0     0 39733.2707    0  676          - 39733.2707      -     -   13s
     0     0 39602.3378    0  677          - 39602.3378      -     -   14s
     0     0 39595.3556    0  677          - 39595.3556      -     -   14s
     0     0 39594.5288    0  679          - 39594.5288      -     -   14s
     0     0 39567.0546    0  684          - 39567.0546      -     -   15s
     0     0 39556.1418    0  683          - 39556.1418      -     -   17s
     0     0 39545.8540    0  688          - 39545.8540      -     -   18s
     0     0 39538.5283    0  697          - 39538.5283      -     -   18s
     0     0 39536.2532    0  695          - 39536.2532      -     -   18s
     0     0 39535.0973    0  698          - 39535.0973      -     -   18s
     0     0 39507.7032    0  696          - 39507.7032      -     -   20s
     0     0 39495.9174    0  696          - 39495.9174      -     -   20s
     0     0 39489.8934    0  694          - 39489.8934      -     -   20s
     0     0 39486.1590    0  700          - 39486.1590      -     -   21s
     0     0 39483.6074    0  704          - 39483.6074      -     -   21s
     0     0 39482.6403    0  706          - 39482.6403      -     -   21s
     0     0 39463.4107    0  705          - 39463.4107      -     -   22s
     0     0 39454.1129    0  710          - 39454.1129      -     -   23s
     0     0 39446.9016    0  713          - 39446.9016      -     -   23s
     0     0 39443.9412    0  711          - 39443.9412      -     -   23s
     0     0 39442.1750    0  709          - 39442.1750      -     -   23s
     0     0 39430.5994    0  711          - 39430.5994      -     -   25s
     0     0 39423.3473    0  707          - 39423.3473      -     -   25s
     0     0 39419.8790    0  714          - 39419.8790      -     -   25s
     0     0 39417.9372    0  713          - 39417.9372      -     -   26s
     0     0 39406.1708    0  710          - 39406.1708      -     -   27s
     0     0 39401.6126    0  708          - 39401.6126      -     -   27s
     0     0 39399.3159    0  714          - 39399.3159      -     -   27s
     0     0 39396.9622    0  712          - 39396.9622      -     -   28s
     0     0 39393.4998    0  717          - 39393.4998      -     -   28s
     0     0 39393.1696    0  717          - 39393.1696      -     -   28s
     0     0 39382.4717    0  720          - 39382.4717      -     -   29s
     0     0 39382.4717    0  719          - 39382.4717      -     -   31s
     0     2 39382.4717    0  719          - 39382.4717      -     -   43s
     3     8 31127.1921    2  651          - 36556.6195      -  2126   46s
    15    32 27263.2241    4  611          - 34576.1252      -  2075   53s
    31    64 25919.3943    5  607          - 32512.4188      -  1961   57s
    95   128 24528.6903    6  576          - 31262.2089      -  1727   60s
   159   192 23569.9283    7  571          - 30280.9704      -  1511   65s
   260   295 20941.7996    9  584          - 29610.6081      -  1628   70s
   370   410 20414.1043   10  573          - 29321.8207      -  1614   76s
   457   510 19219.6751   11  562          - 29321.8207      -  1610   83s
   509   565 18429.9967   12  533          - 29321.8207      -  1583   86s
   689   752 18089.1702   14  558          - 29321.8207      -  1467   91s
   833   896 17140.0409   15  553          - 29321.8207      -  1385   95s
  1027  1088 14830.1973   17  556          - 29321.8207      -  1344  101s
  1157  1232 13234.6737   18  551          - 29321.8207      -  1386  107s
  1231  1304 11621.2890   19  552          - 29321.8207      -  1400  110s
  1391  1496 8931.15996   21  526          - 29321.8207      -  1410  115s
  1640  1782 7896.82891   24  507          - 29321.8207      -  1340  120s
  1956  2099 6447.36791   29  506          - 29321.8207      -  1238  125s
  2250  2408 4826.94428   37  449          - 29321.8207      -  1182  130s
  2642  2893 4495.86107   42  461          - 29321.8207      -  1097  135s
  3133  3423 3451.93051   53  422          - 29321.8207      -  1001  140s
  3734  4030 2904.67449   60  406          - 29321.8207      -   905  145s
  4291  4551 2242.12677   67  384          - 29321.8207      -   852  150s
  4802  5099 1505.38015   70  359          - 29321.8207      -   824  156s
  5353  5636  980.77418   78  343          - 29321.8207      -   800  163s
  5635  5980  855.42294   82  334          - 29321.8207      -   791  166s
  5979  6108  736.19353   88  323          - 29321.8207      -   774  172s
  6107  6443  543.34983   91  326          - 29321.8207      -   771  175s
  6800  7178  427.91271   97  303          - 29321.8207      -   751  182s
  7177  7603  359.13659   99  308          - 29321.8207      -   741  186s
  7602  8077  206.97039  103  302          - 29321.8207      -   729  190s
  8605  9068   80.62925  117  263          - 29321.8207      -   700  198s
  9103  9632   30.11194  122  245          - 29321.8207      -   691  202s
  9675 10240    3.13998  127  176          - 29321.8207      -   679  206s
 10289 10813   -0.14893  129  125          - 29321.8207      -   666  210s
 10910 11482   -7.52875  148  126          - 29321.8207      -   652  215s
 12294 12876 19882.9858   12  608          - 29287.6511      -   630  223s
 13049 13633 16903.2680   15  602          - 29287.6511      -   619  227s
 13864 14089 13102.4501   23  575          - 29287.6511      -   607  231s
 14390 14740 10180.8751   30  536          - 29287.6511      -   603  237s
 15092 14741 2680.74079  128  719          - 29287.6511      -   598  241s
 15095 14743 9821.84237   40  309          - 29287.6511      -   598  263s
 15099 14747 3741.60209  104  308          - 22345.2311      -   598  266s
 15100 14748 1515.00381  115  308          - 22345.2311      -   598  304s
 15103 14752 5003.06472   57  719          - 22345.2311      -   598  305s
 15105 14753 11628.6297   28  308          - 11628.6297      -   598  320s
 15110 14758   33.61632  232  301          - 8823.66559      -   597  356s
 15114 14762   25.83292  178  298          - 3301.38395      -   598  361s
 15115 14763 2890.58884   65  298          - 3301.38395      -   598  387s
 15119 14767 3286.73074   18  300          - 3286.73074      -   598  392s
 15120 14768 1320.47191   99  300          - 3286.73074      -   597  411s
 15124 14772  245.38002  158  297          - 1916.84892      -   598  416s
 15125 14773 1333.40305   72  297          - 1916.84892      -   597  440s
 15130 14778   63.95165  168  303          - 1914.81849      -   598  482s
 15134 14782 1654.33950   61  306          - 1654.33950      -   598  485s
 15135 14783 1474.91762   88  306          - 1654.33950      -   598  531s
 15139 14787  188.20666  121  305          - 1620.38239      -   598  535s
 15140 14788 1620.38239   56  305          - 1620.38239      -   598  562s
 15144 14792  268.51269  142  298          - 1615.28278      -   598  565s
 15145 14793 1615.28278   13  298          - 1615.28278      -   598  584s
 15147 14796 1615.28278    8  719          - 1615.28278      -   598  585s
 15150 14798  316.45022  121  299          -  959.08650      -   598  646s
 15155 14803  874.54468   63  301          -  874.54468      -   598  679s
 15159 14807  861.22110   10  302          -  861.22110      -   598  681s
 15160 14808  861.22110   22  302          -  861.22110      -   598  733s
 15164 14812  629.90570  104  297          -  629.90570      -   598  736s
 15165 14813  629.90570   15  297          -  629.90570      -   598  795s
 15170 14818  602.73769  120  301          -  602.73769      -   598  876s
 15174 14822  540.44705  111  302          -  540.44705      -   598  880s
 15175 14823    0.42094  194  302          -  540.44705      -   598  885s
 15176 14824  431.11678  140  302          -  540.44705      -   598  890s
 15177 14827  522.01352  163  304          -  522.01352      -   4.2  900s
 15183 14837  468.28315  165  299          -  491.77429      -   5.2  905s
 15367 14984  414.85338  170  297          -  445.48869      -  15.1  910s
 15463 15049  396.41194  171  295          -  434.67513      -  30.1  915s
 15583 15129  365.12357  174  303          -  433.82169      -  33.6  926s
 15768 15271  345.24515  177  301          -  433.82169      -  37.8  930s
 16188 15583  278.85972  184  291          -  433.82169      -  47.9  935s
 16696 15949  290.47615  191  286          -  433.82169      -  57.4  940s
 17240 16313  262.34132  199  288          -  433.82169      -  66.7  945s
 17776 16702  238.10143  208  286          -  433.82169      -  75.3  950s
 18576 17353  215.26379  220  261          -  433.82169      -  88.4  956s
 19431 17970  189.95454  233  253          -  433.82169      -   100  960s
 20472 18761  154.79021  252  233          -  433.82169      -   111  965s
 22100 19909  108.68335  283  207          -  433.82169      -   126  971s
 23055 20601   83.47337  301  181          -  433.82169      -   133  975s
 24080 21269   68.97310  323  161          -  433.82169      -   139  981s
 24594 21582   58.48550  336  150          -  433.82169      -   142  986s
 25087 22053   52.69653  349  134          -  433.82169      -   145  990s
 25728 22486   47.57361  366  127          -  433.82169      -   148  995s
 26383 22952   41.80675  380  117          -  433.82169      -   151 1004s
 27075 23440   31.31108  396  113          -  433.82169      -   153 1010s
 27800 23917   28.51100  413   92          -  433.82169      -   156 1019s
 28532 24402   26.50789  429   85          -  433.82169      -   158 1023s
 29287 24924   19.45613  446   77          -  433.82169      -   161 1028s
 30075 25608   12.92916  463   62          -  433.82169      -   164 1037s
 31052 26061    9.69098  476   62          -  433.82169      -   166 1043s
 31864 26506    9.21180  480   58          -  433.82169      -   168 1051s
 32640 26982 infeasible  481               -  433.57418      -   169 1058s
 33407 27550  369.45941  179  293          -  433.57418      -   171 1063s
 34260 28134  308.44508  198  273          -  433.57418      -   173 1068s
 35161 28714  257.55733  217  245          -  433.57418      -   175 1075s
 36091 29427  229.31869  230  233          -  433.57418      -   177 1082s
 37146 30159  136.41564  239  210          -  433.57418      -   179 1086s
 38258 30806  193.40507  247  224          -  433.57418      -   181 1090s
 40440 32232  146.12128  277  189          -  433.57418      -   185 1098s
 41595 32753  109.04618  285  171          -  433.57418      -   187 1106s
 42669 33497  105.08944  302  169          -  433.57418      -   189 1110s
 43881 34232   94.18271  316  145          -  433.57418      -   190 1115s
 45102 34844   85.26793  327  136          -  433.57418      -   192 1120s
 46243 35658   75.88818  337  129          -  433.57418      -   195 1128s
 47503 35274   64.87889  343  124          -  433.57418      -   197 1141s
 47557 36696   65.67941  345  127          -  433.57418      -   197 1149s
 49023 37764   58.04385  352  115          -  433.57418      -   199 1156s
 50596 38843   51.90885  366   96          -  433.57418      -   201 1163s
 52229 39960   44.92989  376   91          -  433.57418      -   203 1169s
 53948 41018   40.68991  386   83          -  433.57418      -   204 1178s
 55635 41984   32.24119  402   75          -  433.57418      -   206 1187s
 57294 42843   18.14609  419   57          -  433.57418      -   208 1195s
 58838 43991    9.76702  440   56          -  424.54757      -   210 1203s
 60564 45856  214.43831  197  253          -  424.54757      -   212 1230s
 62795 47631  110.37327  234  207          -  424.54757      -   214 1250s
 64696 49407  126.44427  253  216          -  424.54757      -   216 1270s
 66560 51348   89.70861  267  191          -  424.54757      -   218 1297s
 68621 53213   56.25351  293  157          -  424.54757      -   220 1339s
 70554 55066   26.73025  312  131          -  424.54757      -   223 1353s
 72495 57218   11.45172  319  118          -  424.54757      -   226 1367s
 74721 58989    8.65712  326  108          -  424.54757      -   229 1382s
 76634 60534 infeasible  330               -  424.54757      -   231 1400s
 78385 62602 infeasible  332               -  411.92044      -   233 1416s
 80635 65738  260.64367  236  242          -  411.71355      -   235 1434s
 83843 65832  160.35282  293  188          -  411.71355      -   238 1458s
 83955 69629  158.84770  294  184          -  411.71355      -   238 1474s
 87829 73378  101.20038  346  123          -  411.71355      -   241 1493s
 91652 76679   58.37204  393   89          -  411.71355      -   244 1513s
 95063 79586   37.00703  428   64          -  407.30455      -   246 1534s
 98134 82383  175.29858  179  222          -  407.30455      -   247 1553s
 101183 85476   53.94703  225  176          -  407.30455      -   248 1574s
 104442 88387   19.72188  252  154          -  407.30455      -   249 1597s
 107497 91389    3.30131  258  125          -  407.30455      -   251 1617s
 110663 94438 infeasible  259               -  388.69481      -   252 1637s
 113916 98380  103.14178  201  212          -  388.69481      -   254 1657s
 117956 101946   27.46047  247  174          -  388.69481      -   256 1679s
 121658 104872 infeasible  277               -  388.69481      -   258 1703s
 124798 107395   -2.04891  274  127          -  386.33238      -   258 1729s
 127617 110460  192.38658  208  246          -  386.33238      -   259 1753s
 130948 114231   70.06933  252  198          -  386.33238      -   261 1779s
 134871 118136   15.30482  295  150          -  386.33238      -   262 1800s

Explored 138918 nodes (45592313 simplex iterations) in 1800.06 seconds (4065.05 work units)
Thread count was 32 (of 96 available processors)

Solution count 0

Time limit reached
Best objective -, best bound 3.863323835989e+02, gap -
No counter example exists in neighborhood.
Time elapsed for full adv. : 1800.1701 sec

{'Acc': 97.6, 'Loss': 6.005989052937366e-05, 'Elapsed': 1800.0655670166016, 'Nodes': 138918.0, 'Arch': '6x100'}
Saved to ./res/GRID/OBBT_-1-CUTS_-1-TIME_1800.0/RESUME_|ARCH_6x100-EPOCHS_50-ID_10000|checkpoint_0.th-ID_10000-TIME_1800.0-DELTA_20.0.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1-CUTS_-1-TIME_1800.0', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=1800.0, delta=20.0, obbt=-1, cuts=-1, pretrained_path='./saved_models/ARCH_6x100-EPOCHS_50-ID_10000/checkpoint_1.th', seed=0)

RESUME_|ARCH_6x100-EPOCHS_50-ID_10000|checkpoint_1.th-ID_10000-TIME_1800.0-DELTA_20.0
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_6x100-EPOCHS_50-ID_10000/checkpoint_1.th'
=> loaded pretrained arch 97.77, with accuracy '6x100'
Test: [49/79]	Loss 0.0001 (0.1956) ([0.000]+[0.000])	Prec@1 100.000 (97.391)
 * Prec@1 97.770
Correct label is  tensor(3)  || Wrong label is  tensor(2)
Model for sequential:
1200 variables
610 constraints
600 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0            (1, 100)          100          100            0            0

relu_1              (1, 100)          100            0            0          100

linear_2            (1, 100)          100          100            0            0

relu_3              (1, 100)          100            0            0          100

linear_4            (1, 100)          100          100            0            0

relu_5              (1, 100)          100            0            0          100

linear_6            (1, 100)          100          100            0            0

relu_7              (1, 100)          100            0            0          100

linear_8            (1, 100)          100          100            0            0

relu_9              (1, 100)          100            0            0          100

linear_10           (1, 100)          100          100            0            0

relu_11             (1, 100)          100            0            0          100

linear_12            (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 1800
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 2179 rows, 2778 columns and 133930 nonzeros
Model fingerprint: 0xab662c51
Model has 600 general constraints
Variable types: 2778 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [6e-07, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [5e-05, 2e+01]
Presolve added 176 rows and 197 columns
Presolve time: 0.56s
Presolved: 2355 rows, 2975 columns, 133840 nonzeros
Variable types: 2095 continuous, 880 integer (880 binary)

Root relaxation: objective 3.372488e+04, 12716 iterations, 2.30 seconds (4.65 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 33724.8777    0  550          - 33724.8777      -     -    3s
     0     0 33564.7153    0  556          - 33564.7153      -     -    5s
     0     0 33073.4483    0  560          - 33073.4483      -     -    5s
     0     0 31231.9290    0  596          - 31231.9290      -     -    7s
     0     0 31217.1186    0  588          - 31217.1186      -     -    7s
     0     0 31217.0114    0  590          - 31217.0114      -     -    7s
     0     0 31216.9972    0  590          - 31216.9972      -     -    7s
     0     0 31216.9967    0  590          - 31216.9967      -     -    7s
     0     0 31184.3511    0  590          - 31184.3511      -     -    8s
     0     0 31135.9966    0  601          - 31135.9966      -     -    9s
     0     0 31050.4877    0  622          - 31050.4877      -     -   10s
     0     0 31032.0881    0  638          - 31032.0881      -     -   10s
     0     0 31029.4169    0  631          - 31029.4169      -     -   10s
     0     0 31029.1300    0  630          - 31029.1300      -     -   10s
     0     0 31006.5972    0  644          - 31006.5972      -     -   12s
     0     0 30995.6671    0  653          - 30995.6671      -     -   12s
     0     0 30979.2557    0  658          - 30979.2557      -     -   12s
     0     0 30972.6896    0  653          - 30972.6896      -     -   13s
     0     0 30855.7810    0  658          - 30855.7810      -     -   13s
     0     0 30855.0254    0  659          - 30855.0254      -     -   14s
     0     0 30831.7596    0  657          - 30831.7596      -     -   15s
     0     0 30812.8256    0  666          - 30812.8256      -     -   16s
     0     0 30808.7285    0  669          - 30808.7285      -     -   16s
     0     0 30803.9629    0  666          - 30803.9629      -     -   16s
     0     0 30799.2093    0  670          - 30799.2093      -     -   16s
     0     0 30798.1725    0  667          - 30798.1725      -     -   17s
     0     0 30776.3270    0  675          - 30776.3270      -     -   18s
     0     0 30763.5344    0  673          - 30763.5344      -     -   20s
     0     0 30756.7966    0  681          - 30756.7966      -     -   21s
     0     0 30737.0514    0  684          - 30737.0514      -     -   21s
     0     0 30730.7301    0  689          - 30730.7301      -     -   22s
     0     0 30729.6753    0  686          - 30729.6753      -     -   22s
     0     0 30712.5356    0  680          - 30712.5356      -     -   23s
     0     0 30698.5210    0  685          - 30698.5210      -     -   23s
     0     0 30683.6752    0  683          - 30683.6752      -     -   24s
     0     0 30677.7778    0  679          - 30677.7778      -     -   24s
     0     0 30674.6193    0  687          - 30674.6193      -     -   25s
     0     0 30672.8833    0  685          - 30672.8833      -     -   25s
     0     0 30659.6040    0  677          - 30659.6040      -     -   26s
     0     0 30655.3474    0  676          - 30655.3474      -     -   27s
     0     0 30647.4251    0  680          - 30647.4251      -     -   27s
     0     0 30644.9752    0  689          - 30644.9752      -     -   27s
     0     0 30643.8218    0  685          - 30643.8218      -     -   27s
     0     0 30592.0080    0  690          - 30592.0080      -     -   29s
     0     0 30583.2608    0  681          - 30583.2608      -     -   29s
     0     0 30579.9709    0  682          - 30579.9709      -     -   29s
     0     0 30578.3460    0  687          - 30578.3460      -     -   29s
     0     0 30565.6458    0  692          - 30565.6458      -     -   30s
     0     0 30557.3703    0  688          - 30557.3703      -     -   31s
     0     0 30550.1925    0  692          - 30550.1925      -     -   31s
     0     0 30547.2408    0  689          - 30547.2408      -     -   31s
     0     0 30544.2532    0  689          - 30544.2532      -     -   32s
     0     0 30542.3562    0  691          - 30542.3562      -     -   32s
     0     0 30535.6231    0  690          - 30535.6231      -     -   33s
     0     0 30526.7980    0  687          - 30526.7980      -     -   33s
     0     0 30525.0158    0  690          - 30525.0158      -     -   34s
     0     0 30515.2580    0  691          - 30515.2580      -     -   34s
     0     0 30515.2580    0  691          - 30515.2580      -     -   36s
     0     2 30515.2580    0  691          - 30515.2580      -     -   48s
     3     8 28435.9861    2  689          - 28435.9861      -  1066   51s
    31    64 22365.7356    5  662          - 26413.0517      -  1204   55s
    95   128 19901.4033    6  628          - 26087.7401      -   855   61s
   224   263 19855.0836    8  645          - 24225.4767      -  1152   65s
   341   380 16903.6208   10  592          - 23603.6512      -  1075   70s
   425   480 17267.9727   12  611          - 23269.1196      -  1070   75s
   583   635 14744.2098   15  597          - 23231.0543      -  1083   81s
   634   667 14041.8960   17  584          - 23231.0543      -  1165   87s
   720   793 13656.5148   18  580          - 23231.0543      -  1250   91s
   870   947 11161.3028   21  581          - 23231.0543      -  1162   96s
  1149  1309 9012.30313   28  547          - 23231.0543      -  1037  100s
  1579  1693 6591.64936   38  504          - 23231.0543      -   854  106s
  1779  1929 5259.61103   46  470          - 23231.0543      -   856  110s
  2506  2691 3418.14639   57  415          - 23231.0543      -   727  116s
  3164  3384 3023.72739   68  368          - 23231.0543      -   653  121s
  3591  3814 2551.86849   77  370          - 23231.0543      -   624  125s
  4324  4583 1538.49360   88  342          - 23231.0543      -   586  130s
  4869  5173 1118.60601   95  326          - 23231.0543      -   564  135s
  5738  6038  686.91059  107  309          - 23231.0543      -   542  141s
  6353  6708  529.48692  114  293          - 23231.0543      -   532  146s
  7061  7428  391.72890  125  261          - 23231.0543      -   519  151s
  7875  8384  221.64678  141  226          - 23231.0543      -   506  157s
  8411  8817  155.32328  155  213          - 23231.0543      -   496  162s
  8866  9296  121.99918  168  186          - 23231.0543      -   492  165s
  9950 10382   40.39185  209  137          - 23231.0543      -   479  173s
 10477 10840   20.66043  226  111          - 23029.1729      -   474  178s
 10969 11592 18044.3171   12  608          - 23029.1729      -   467  182s
 11777 12416 15777.3277   13  547          - 23029.1729      -   456  187s
 12677 13161 14080.8142   21  584          - 23029.1729      -   444  191s
 13530 13934 13206.0336   23  574          - 23029.1729      -   435  196s
 14411 14611 10297.5442   32  540          - 23029.1729      -   428  200s
 15221 14613 15501.7789   23  308          - 23029.1729      -   424  206s
 15222 14614 4214.73013   77  308          - 23029.1729      -   424  224s
 15224 14617  944.46790  116  691          - 23029.1729      -   424  225s
 15227 14619 2710.55797   71  310          - 17648.4729      -   424  266s
 15231 14623  256.97271  187  302          - 9391.98581      -   424  270s
 15232 14624 9391.98581   22  302          - 9391.98581      -   424  295s
 15237 14629   11.05611  152  309          - 9097.07131      -   424  331s
 15242 14634 6772.29316   16  309          - 6772.29316      -   424  348s
 15246 14638 5526.18105   21  306          - 5526.18105      -   424  353s
 15247 14639 2173.51221   79  306          - 5526.18105      -   424  369s
 15249 14642 5526.18105   42  691          - 5526.18105      -   424  370s
 15252 14644 3109.24915   38  305          - 3109.24915      -   424  408s
 15256 14648  582.81954  169  303          - 2638.20914      -   424  413s
 15257 14649 1491.17857   84  303          - 2638.20914      -   424  438s
 15261 14653 2070.72654   75  305          - 2618.46267      -   424  442s
 15262 14654 2618.46267    7  305          - 2618.46267      -   424  464s
 15264 14657  736.70316  132  691          - 2618.46267      -   424  465s
 15267 14659  311.43467  150  300          - 2612.95050      -   424  506s
 15272 14664   30.33434  231  298          - 1443.19232      -   424  525s
 15277 14669  986.30805   72  299          -  986.30805      -   424  624s
 15279 14672  986.30805   39  691          -  986.30805      -   425  625s
 15282 14674  945.91823   65  300          -  945.91823      -   425  660s
 15287 14679  884.81040   10  302          -  884.81040      -   425  695s
 15292 14684   69.12356  190  300          -  703.68885      -   425  758s
 15296 14688  631.77398   26  301          -  631.77398      -   425  762s
 15297 14689  631.77398   90  301          -  631.77398      -   425  840s
 15302 14694  475.86786  126  302          -  475.86786      -   425  849s
 15303 14695  475.86786   47  302          -  475.86786      -   425  853s
 15306 14702  458.49393  184  296          -  458.49393      -   3.7  855s
 15310 14708  451.35546  185  294          -  457.32191      -   4.0  864s
 15318 14722  442.53965  186  296          -  451.32739      -   6.3  866s
 15334 14748  432.81526  187  291          -  442.46481      -   8.7  871s
 15592 14920  276.20579  191  292          -  415.36457      -  32.4  877s
 15797 15067  220.36944  194  239          -  400.02893      -  41.1  880s
 16341 15471  358.76949  203  283          -  391.47258      -  54.0  885s
 17014 15935  316.61009  213  261          -  391.47258      -  67.3  890s
 17870 16627  289.69584  226  260          -  391.47258      -  85.3  895s
 18556 16911  265.59520  235  258          -  391.47258      -  96.4  905s
 19703 17920  224.23194  252  231          -  391.47258      -   113  910s
 21327 19094  177.11066  280  202          -  391.47258      -   132  915s
 22988 20274  133.07307  313  169          -  391.47258      -   147  921s
 24438 21332   95.75970  346  147          -  391.47258      -   157  927s
 24986 21764   85.81456  358  147          -  391.47258      -   160  932s
 25603 22179   77.32112  373  125          -  391.47258      -   163  937s
 26226 22650   66.59203  385  124          -  391.47258      -   166  946s
 26914 23079   55.83900  399  104          -  391.47258      -   169  950s
 27585 23510   47.25609  413   90          -  391.47258      -   171  958s
 28253 23985   36.85333  428   84          -  391.47258      -   173  967s
 28969 24537   34.34112  445   64          -  391.47258      -   176  974s
 29776 25226   22.62630  465   49          -  391.47258      -   178  980s
 31481 25974 infeasible  488               -  390.83914      -   183  988s
 32148 26516  327.78121  209  268          -  390.83914      -   185  992s
 32938 27052  291.83322  222  259          -  390.83914      -   187  996s
 34638 28169  233.50458  245  238          -  390.83914      -   190 1003s
 35525 28794  205.74189  257  218          -  390.83914      -   192 1007s
 36486 29437  188.18592  267  220          -  390.83914      -   193 1010s
 37467 30107  169.56052  284  189          -  390.83914      -   195 1017s
 38486 30714  156.79120  295  183          -  390.83914      -   197 1021s
 40623 32258  118.34700  323  151          -  390.83914      -   200 1029s
 41795 33125  102.29671  335  140          -  390.83914      -   202 1034s
 43105 33875   88.58000  341  146          -  390.83914      -   203 1038s
 44396 34731   86.17759  352  147          -  390.83914      -   204 1042s
 45768 35600   64.96165  357  143          -  390.83914      -   205 1047s
 47152 36579   73.77531  362  128          -  390.83914      -   206 1055s
 48661 37485   69.86871  366  129          -  390.83914      -   207 1061s
 50154 38432   63.23554  370  126          -  390.83914      -   208 1071s
 51694 39378   57.00330  379  113          -  390.83914      -   209 1077s
 53260 40469   50.64148  383  105          -  390.83914      -   210 1085s
 54965 39967   46.47766  387  101          -  390.83914      -   211 1093s
 55045 41681   46.40133  387  102          -  390.83914      -   211 1099s
 56880 42830   42.43495  392   97          -  390.83914      -   211 1104s
 58740 44517   35.82317  401   87          -  390.83914      -   212 1111s
 61199 46123   29.28852  410   75          -  390.83914      -   213 1117s
 63129 48119   22.91408  423   57          -  390.83914      -   214 1123s
 65143 50240   18.24353  434   55          -  390.83914      -   215 1129s
 67296 52333   16.07861  449   52          -  390.83914      -   216 1135s
 69439 54386    9.22867  459   48          -  390.83914      -   217 1142s
 71604 56554 infeasible  483               -  387.31662      -   217 1151s
 73888 58837  140.43936  216  220          -  378.49971      -   218 1159s
 76241 61103   61.55837  261  183          -  378.49971      -   219 1167s
 78591 63483   47.84332  281  160          -  378.49971      -   219 1175s
 81085 65757   25.74381  296  143          -  378.49971      -   220 1184s
 83567 68290   16.72565  309  143          -  378.49971      -   221 1194s
 86202 70939    7.57719  332  125          -  378.49971      -   222 1204s
 88991 74372    4.97458  354  103          -  374.46545      -   223 1220s
 92628 77512  245.10133  203  246          -  374.46545      -   224 1230s
 95852 80715  144.52726  221  210          -  374.46545      -   225 1241s
 99155 80783  133.51565  240  203          -  374.46545      -   226 1259s
 99271 84010  132.89373  242  204          -  374.46545      -   226 1272s
 102670 87178   90.48269  267  182          -  374.46545      -   226 1280s
 106030 90150   67.83765  276  170          -  374.46545      -   227 1289s
 109174 93545   42.69642  294  157          -  374.46545      -   227 1296s
 112641 96813   31.57680  306  136          -  374.46545      -   228 1304s
 115997 100058   25.26064  320  119          -  374.46545      -   229 1313s
 119322 103940   17.03542  355   90          -  374.46545      -   229 1323s
 123258 106864   10.83433  367   76          -  374.46545      -   230 1331s
 126370 109550    4.72770  386   73          -  374.46545      -   230 1342s
 129296 112271    0.65217  396   72          -  343.35030      -   230 1351s
 132239 115587  259.75833  204  270          -  343.35030      -   230 1364s
 135633 118784  151.65648  255  222          -  343.35030      -   231 1374s
 138934 121972  105.74982  278  199          -  343.35030      -   232 1383s
 142251 125150   71.96256  290  191          -  343.35030      -   232 1391s
 145497 128312   65.08985  295  177          -  343.35030      -   233 1399s
 148785 131778   32.37789  306  165          -  343.35030      -   233 1407s
 152387 134889   30.16902  329  148          -  343.35030      -   234 1416s
 155676 138159   19.70864  364  102          -  343.35030      -   234 1424s
 159076 141154   13.20920  395   78          -  343.35030      -   234 1433s
 162253 143962   -3.28497  421   73          -  338.37245      -   234 1441s
 165253 146781  208.15509  247  215          -  338.37245      -   235 1449s
 168266 149983  126.00581  282  191          -  338.37245      -   235 1460s
 171566 153059   76.08589  321  152          -  338.37245      -   236 1471s
 174716 155807   51.80967  345  138          -  338.37245      -   236 1484s
 177556 155884   38.84783  375   97          -  338.37245      -   237 1498s
 177651 158479   37.79478  374   98          -  338.37245      -   237 1509s
 180413 161188   25.17022  394   80          -  338.37245      -   238 1521s
 183382 164087 infeasible  407               -  322.27928      -   238 1537s
 186581 168083   87.28607  314  190          -  322.27928      -   239 1560s
 190695 171877   49.68126  365  142          -  322.27928      -   239 1575s
 194635 175644   32.95984  390  119          -  322.27928      -   240 1590s
 198504 178661   16.94175  414   90          -  322.27928      -   240 1602s
 201759 181669    9.09691  432   70          -  322.27928      -   241 1618s
 204969 184493  231.07933  209  279          -  322.27928      -   241 1634s
 207989 187281   91.04416  283  201          -  322.27928      -   242 1649s
 210911 190131   47.49111  330  169          -  322.27928      -   242 1665s
 213889 193200   24.61476  365  118          -  322.27928      -   243 1682s
 217116 196054   12.74986  388  100          -  315.13104      -   243 1701s
 220154 199530  198.89492  223  243          -  315.13104      -   244 1718s
 223798 203482   73.78741  279  177          -  315.13104      -   245 1736s
 227848 206844   34.09068  311  155          -  315.13104      -   246 1756s
 231322 209721   16.67144  324  135          -  315.13104      -   246 1775s
 234363 212365    9.93047  329  124          -  312.77473      -   247 1793s
 237269 212388  100.37289  280  185          -  312.77473      -   247 1800s

Explored 237328 nodes (65208555 simplex iterations) in 1800.03 seconds (4561.26 work units)
Thread count was 32 (of 96 available processors)

Solution count 0

Time limit reached
Best objective -, best bound 3.127747317179e+02, gap -
No counter example exists in neighborhood.
Time elapsed for full adv. : 1800.3385 sec

{'Acc': 97.77, 'Loss': 9.031626541400328e-05, 'Elapsed': 1800.0359041690826, 'Nodes': 237328.0, 'Arch': '6x100'}
Saved to ./res/GRID/OBBT_-1-CUTS_-1-TIME_1800.0/RESUME_|ARCH_6x100-EPOCHS_50-ID_10000|checkpoint_1.th-ID_10000-TIME_1800.0-DELTA_20.0.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1-CUTS_-1-TIME_1800.0', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=1800.0, delta=20.0, obbt=-1, cuts=-1, pretrained_path='./saved_models/ARCH_6x100-EPOCHS_50-ID_10000/checkpoint_2.th', seed=0)

RESUME_|ARCH_6x100-EPOCHS_50-ID_10000|checkpoint_2.th-ID_10000-TIME_1800.0-DELTA_20.0
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_6x100-EPOCHS_50-ID_10000/checkpoint_2.th'
=> loaded pretrained arch 97.67, with accuracy '6x100'
Test: [49/79]	Loss 0.0407 (0.2446) ([0.041]+[0.000])	Prec@1 99.219 (97.156)
 * Prec@1 97.670
Correct label is  tensor(3)  || Wrong label is  tensor(8)
Model for sequential:
1200 variables
610 constraints
600 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0            (1, 100)          100          100            0            0

relu_1              (1, 100)          100            0            0          100

linear_2            (1, 100)          100          100            0            0

relu_3              (1, 100)          100            0            0          100

linear_4            (1, 100)          100          100            0            0

relu_5              (1, 100)          100            0            0          100

linear_6            (1, 100)          100          100            0            0

relu_7              (1, 100)          100            0            0          100

linear_8            (1, 100)          100          100            0            0

relu_9              (1, 100)          100            0            0          100

linear_10           (1, 100)          100          100            0            0

relu_11             (1, 100)          100            0            0          100

linear_12            (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 1800
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 2179 rows, 2778 columns and 133930 nonzeros
Model fingerprint: 0x9247466c
Model has 600 general constraints
Variable types: 2778 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [8e-07, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [2e-05, 2e+01]
Presolve added 132 rows and 153 columns
Presolve time: 0.56s
Presolved: 2311 rows, 2931 columns, 133744 nonzeros
Variable types: 2087 continuous, 844 integer (844 binary)

Root relaxation: objective 2.656730e+04, 6465 iterations, 0.97 seconds (2.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 26567.3041    0  499          - 26567.3041      -     -    1s
     0     0 26557.5704    0  511          - 26557.5704      -     -    3s
     0     0 26405.0909    0  516          - 26405.0909      -     -    3s
     0     0 25162.3528    0  578          - 25162.3528      -     -    4s
     0     0 25161.3303    0  576          - 25161.3303      -     -    4s
     0     0 25161.3070    0  574          - 25161.3070      -     -    4s
     0     0 25161.3015    0  575          - 25161.3015      -     -    4s
     0     0 25161.3010    0  575          - 25161.3010      -     -    4s
     0     0 25090.6681    0  581          - 25090.6681      -     -    5s
     0     0 25015.1144    0  572          - 25015.1144      -     -    7s
     0     0 24991.2001    0  599          - 24991.2001      -     -    8s
     0     0 24986.0507    0  602          - 24986.0507      -     -    8s
     0     0 24985.3866    0  599          - 24985.3866      -     -    8s
     0     0 24985.3334    0  599          - 24985.3334      -     -    8s
     0     0 24964.5405    0  601          - 24964.5405      -     -    9s
     0     0 24924.6226    0  616          - 24924.6226      -     -   10s
     0     0 24916.5541    0  612          - 24916.5541      -     -   10s
     0     0 24909.3245    0  612          - 24909.3245      -     -   10s
     0     0 24841.8338    0  615          - 24841.8338      -     -   10s
     0     0 24841.5780    0  616          - 24841.5780      -     -   11s
     0     0 24827.6665    0  615          - 24827.6665      -     -   12s
     0     0 24810.8676    0  623          - 24810.8676      -     -   12s
     0     0 24807.0389    0  626          - 24807.0389      -     -   12s
     0     0 24804.0476    0  624          - 24804.0476      -     -   13s
     0     0 24802.7945    0  626          - 24802.7945      -     -   13s
     0     0 24802.1640    0  627          - 24802.1640      -     -   13s
     0     0 24784.3272    0  634          - 24784.3272      -     -   14s
     0     0 24778.0219    0  632          - 24778.0219      -     -   14s
     0     0 24765.9193    0  638          - 24765.9193      -     -   15s
     0     0 24762.6826    0  636          - 24762.6826      -     -   15s
     0     0 24759.8468    0  639          - 24759.8468      -     -   15s
     0     0 24759.4497    0  634          - 24759.4497      -     -   15s
     0     0 24743.3208    0  634          - 24743.3208      -     -   16s
     0     0 24735.5392    0  637          - 24735.5392      -     -   17s
     0     0 24730.4942    0  636          - 24730.4942      -     -   17s
     0     0 24727.8756    0  643          - 24727.8756      -     -   17s
     0     0 24726.1439    0  643          - 24726.1439      -     -   17s
     0     0 24725.2316    0  642          - 24725.2316      -     -   17s
     0     0 24707.2415    0  635          - 24707.2415      -     -   19s
     0     0 24698.0951    0  638          - 24698.0951      -     -   19s
     0     0 24688.3614    0  642          - 24688.3614      -     -   19s
     0     0 24682.4728    0  649          - 24682.4728      -     -   19s
     0     0 24678.8230    0  655          - 24678.8230      -     -   20s
     0     0 24677.7440    0  653          - 24677.7440      -     -   20s
     0     0 24665.4517    0  649          - 24665.4517      -     -   21s
     0     0 24661.3472    0  655          - 24661.3472      -     -   21s
     0     0 24658.6780    0  656          - 24658.6780      -     -   21s
     0     0 24656.5182    0  656          - 24656.5182      -     -   21s
     0     0 24653.8417    0  655          - 24653.8417      -     -   22s
     0     0 24653.3139    0  655          - 24653.3139      -     -   22s
     0     0 24633.5456    0  662          - 24633.5456      -     -   23s
     0     0 24620.2564    0  658          - 24620.2564      -     -   23s
     0     0 24615.4497    0  656          - 24615.4497      -     -   24s
     0     0 24612.7488    0  656          - 24612.7488      -     -   24s
     0     0 24611.4492    0  656          - 24611.4492      -     -   24s
     0     0 24602.7885    0  657          - 24602.7885      -     -   25s
     0     0 24597.1556    0  664          - 24597.1556      -     -   25s
     0     0 24593.3991    0  662          - 24593.3991      -     -   25s
     0     0 24591.9831    0  666          - 24591.9831      -     -   26s
     0     0 24579.6066    0  663          - 24579.6066      -     -   27s
     0     0 24576.2103    0  666          - 24576.2103      -     -   29s
     0     0 24573.7239    0  667          - 24573.7239      -     -   29s
     0     0 24571.8542    0  668          - 24571.8542      -     -   29s
     0     0 24545.4236    0  664          - 24545.4236      -     -   30s
     0     0 24533.3149    0  668          - 24533.3149      -     -   31s
     0     0 24526.3599    0  665          - 24526.3599      -     -   31s
     0     0 24524.4648    0  668          - 24524.4648      -     -   31s
     0     0 24514.0747    0  666          - 24514.0747      -     -   32s
     0     0 24509.0470    0  669          - 24509.0470      -     -   32s
     0     0 24507.6748    0  670          - 24507.6748      -     -   32s
     0     0 24448.1744    0  668          - 24448.1744      -     -   33s
     0     0 24426.6614    0  671          - 24426.6614      -     -   34s
     0     0 24422.3052    0  670          - 24422.3052      -     -   34s
     0     0 24420.0513    0  670          - 24420.0513      -     -   34s
     0     0 24418.9385    0  671          - 24418.9385      -     -   34s
     0     0 24390.7364    0  664          - 24390.7364      -     -   35s
     0     0 24377.4882    0  669          - 24377.4882      -     -   35s
     0     0 24373.7887    0  667          - 24373.7887      -     -   36s
     0     0 24371.8057    0  668          - 24371.8057      -     -   36s
     0     0 24296.3051    0  671          - 24296.3051      -     -   37s
     0     0 24287.4489    0  674          - 24287.4489      -     -   37s
     0     0 24284.3617    0  678          - 24284.3617      -     -   37s
     0     0 24282.8419    0  671          - 24282.8419      -     -   37s
     0     0 24275.9327    0  674          - 24275.9327      -     -   38s
H    0     0                      -9.4228516 24275.9327      -     -   40s
     0     0 24275.9327    0  674   -9.42285 24275.9327      -     -   40s
     0     2 24275.9327    0  674   -9.42285 24275.9327      -     -   45s
     3     8 16752.9509    2  579   -9.42285 22534.2337      -  4565   51s
    15    32 15005.5660    4  531   -9.42285 20733.5517      -  2802   55s
H   31    64                      -9.4228516 19402.9962      -  2731   62s
H   35    64                      -9.4228495 19402.9962      -  2835   62s
    64    65 15101.2642    6  674   -9.42285 18469.7064      -  2747   80s
    71    75 18469.7064   15  301   -9.42285 18469.7064      -  58.8   86s
    83    95 18469.7064   17  297   -9.42285 18469.7064      -   732   92s
    99   121 18469.7064   18  298   -9.42285 18469.7064      -  1764   98s
   131   143 18469.7064   19  297   -9.42285 18469.7064      -  2853  103s
   259   247 17528.5127   21  291   -9.42285 18469.7064      -  2859  105s
   755   763 12776.7879   31  294   -9.42285 18469.7064      -  1470  110s
  1518  1545 8917.68885   43  250   -9.42285 18469.7064      -   998  115s
  2508  2593 6145.23237   58  255   -9.42285 18469.7064      -   784  120s
  3799  3927 4640.69530   77  237   -9.42285 18469.7064      -   679  125s
  4840  4991 3211.40390   93  218   -9.42285 18469.7064      -   650  130s
  6033  6254 2191.54681  117  208   -9.42285 18469.7064      -   634  136s
  6321  6512 2037.22130  122  195   -9.42285 18469.7064      -   629  142s
  6763  7002 1661.09949  130  197   -9.42285 18469.7064      -   624  150s
  7673  8010 1294.41061  146  186   -9.42285 18469.7064      -   613  156s
  8987  9224  686.56694  170  165   -9.42285 18469.7064      -   592  162s
  9399  9657  655.41956  179  156   -9.42285 18469.7064      -   588  168s
  9838 10108  580.81864  189  154   -9.42285 18469.7064      -   585  170s
 11370 11710  180.69352  221  131   -9.42285 18469.7064      -   591  176s
 12436 12858   86.39426  247  120   -9.42285 18469.7064      -   585  180s
 13103 12888   37.01617  260  103   -9.42285 18469.7064      -   579  213s
 13135 13184   36.89802  261  103   -9.42285 18469.7064      -   580  220s
 13449 13761   29.73055  266   94   -9.42285 18469.7064      -   583  227s
 14058 14151    3.93837  280   83   -9.42285 18469.7064      -   587  234s
 14491 14684 infeasible  281        -9.42285 18469.7064      -   588  237s
 15086 15374    4.00865  279   89   -9.42285 18469.7064      -   588  243s
 15808 15898 infeasible  279        -9.42285 18469.7064      -   584  246s
 17224 17637 10403.5145   37  263   -9.42285 18469.7064      -   575  253s
 18145 18515 9598.64146   50  269   -9.42285 18469.7064      -   569  258s
H18535 18515                      -9.4228421 18469.7064      -   566  258s
 19080 19290 7473.92382   64  259   -9.42284 18469.7064      -   561  262s
 19939 19600 3805.73832   98  223   -9.42284 18469.7064      -   553  270s
 20275 20403 2401.27029  112  185   -9.42284 18469.7064      -   553  279s
 21152 21214 1043.83305  151  168   -9.42284 18469.7064      -   548  287s
 22123 22059  291.11460  194  133   -9.42284 18469.7064      -   543  295s
 23054 22824 infeasible  208        -9.42284 18469.7064      -   539  307s
 23911 23557  108.33209  204  116   -9.42284 18469.7064      -   537  315s
 24726 24571 infeasible  205        -9.42284 18297.8248      -   533  322s
 25861 25576 9960.25290   26  226   -9.42284 18297.8248      -   529  331s
 26996 26728 5442.41545   44  214   -9.42284 18297.8248      -   526  342s
 28214 27757 2817.15913   63  203   -9.42284 18297.8248      -   523  350s
 29350 29414 1501.07155   82  176   -9.42284 18297.8248      -   521  360s
 31217 30569  146.27215  106  152   -9.42284 18297.8248      -   512  368s
 32466 31906   -4.67493  127  110   -9.42284 18297.8248      -   510  379s
 33935 33021   -4.70731  126  109   -9.42284 17716.4502      -   505  388s
 35204 34555 5432.63785   40  202   -9.42284 17716.4502      -   501  397s
 36903 35631   35.98479   95  152   -9.42284 17716.4502      -   495  410s
 38191 36872 infeasible  121        -9.42284 16467.6902      -   491  421s
 39667 38291 1874.59641   58  192   -9.42284 16467.6902      -   487  435s
 41347 39728     cutoff  121        -9.42284 15832.8601      -   483  448s
 43059 40939  578.36655   78  180   -9.42284 14723.8006      -   480  460s
 44529 42365   -8.21158  127  113   -9.42284 14723.8006      -   479  475s
 46221 43582   -5.46032  126  112   -9.42284 14439.0291      -   477  488s
 47674 45188  912.18950   62  179   -9.42284 14439.0291      -   477  503s
 49472 46903     cutoff  104        -9.42284 14439.0291      -   478  518s
 51495 48651   -5.13575  103  121   -9.42284 13730.1844      -   476  534s
 53636 50844 7466.78432   33  229   -9.42284 13730.1844      -   473  551s
 56186 52491 infeasible   86        -9.42284 13398.2263      -   469  569s
 58211 54126   -7.80460   93  108   -9.42284 13047.4060      -   469  587s
 60214 56069  225.81956   90  152   -9.42284 12995.1153      -   467  611s
 62535 57593 infeasible  124        -9.42284 12995.1153      -   465  637s
 64695 61049 infeasible  124        -9.42284 12938.1566      -   465  665s
 68686 63182   -3.80340  116  116   -9.42284 12843.1608      -   464  691s
 71337 65358 8927.30883   24  216   -9.42284 12843.1608      -   462  724s
 74040 68901     cutoff  104        -9.42284 12775.7419      -   463  755s
 78353 72298 4920.67569   34  178   -9.42284 12503.3967      -   461  781s
 82391 75094 9108.72455   38  219   -9.42284 12448.9096      -   461  807s
 85895 76905 5244.06623   36  200   -9.42284 12332.6242      -   459  833s
 88237 79583  373.51231   93  148   -9.42284 12319.7013      -   459  857s
 91562 82474 infeasible   92        -9.42284 12262.4828      -   459  883s
 95169 84937   21.86688   91  141   -9.42284 12161.0451      -   458  906s
 98267 87473 infeasible  118        -9.42284 12100.3097      -   457  935s
 101383 89438 infeasible  120        -9.42284 12100.3097      -   457  972s
 103950 91780 infeasible  121        -9.42284 12064.5623      -   456 1009s
 106838 94951 3720.01491   62  211   -9.42284 11998.3380      -   457 1049s
 110178 98204  464.90995   97  153   -9.42284 11998.3380      -   461 1089s
 113846 100792 infeasible  113        -9.42284 11993.3772      -   461 1130s
 116890 104251 infeasible   89        -9.42284 11948.3721      -   460 1170s
 120969 107150     cutoff  125        -9.42284 11884.2856      -   458 1207s
 124508 109052   -2.63585  111  118   -9.42284 11858.9998      -   456 1243s
 126982 112013   -4.78766   88  130   -9.42284 11813.0120      -   456 1280s
 130619 115320 infeasible   98        -9.42284 11802.1730      -   456 1318s
 134438 118387 7736.03374   46  232   -9.42284 11791.3773      -   456 1354s
 137954 121222  524.50673   98  158   -9.42284 11705.1339      -   454 1391s
 141476 123025  267.97450   96  156   -9.42284 11702.8357      -   453 1430s
 143773 126595 infeasible   98        -9.42284 11698.5690      -   453 1470s
 147803 129195 3718.21486   77  236   -9.42284 11695.7332      -   454 1500s
 151151 131189 1358.14165   88  174   -9.42284 11671.9489      -   455 1528s
 153718 134401   36.80511  112  134   -9.42284 11658.2057      -   454 1569s
 157934 138161 9668.97772   34  238   -9.42284 11584.1981      -   454 1607s
 162217 142531 7778.57614   51  253   -9.42284 11584.1981      -   455 1641s
 166816 145378 2101.16451   94  198   -9.42284 11584.1981      -   457 1668s
 170165 147457  642.48273  114  151   -9.42284 11584.1981      -   457 1693s
 172794 150517 infeasible  122        -9.42284 11584.1981      -   457 1718s
 176253 153628  112.85314  121  139   -9.42284 11584.1981      -   459 1743s
 179724 155673 infeasible  124        -9.42284 11584.1981      -   460 1773s
 182279 157784 infeasible  124        -9.42284 11584.1981      -   459 1800s

Explored 184954 nodes (85095132 simplex iterations) in 1800.08 seconds (5433.92 work units)
Thread count was 32 (of 96 available processors)

Solution count 3: -9.42284 -9.42285 -9.42285 

Time limit reached
Warning: max constraint violation (2.4583e-05) exceeds tolerance
Warning: max general constraint violation (2.4583e-05) exceeds tolerance
Best objective -9.422842095898e+00, best bound 1.158419813483e+04, gap 123037.4112%
No counter example exists in neighborhood.
Time elapsed for full adv. : 1800.1977 sec

{'Acc': 97.67, 'Loss': 8.251458893937524e-06, 'Elapsed': 1800.10001206398, 'Nodes': 184954.0, 'Arch': '6x100'}
Saved to ./res/GRID/OBBT_-1-CUTS_-1-TIME_1800.0/RESUME_|ARCH_6x100-EPOCHS_50-ID_10000|checkpoint_2.th-ID_10000-TIME_1800.0-DELTA_20.0.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1-CUTS_-1-TIME_1800.0', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=1800.0, delta=20.0, obbt=-1, cuts=-1, pretrained_path='./saved_models/ARCH_6x100-EPOCHS_50-REG_spr-LAMB_1.0-ALPHA_0.1-FT_10-ID_10000/checkpointRED_1RP_0.th', seed=0)

RESUME_|ARCH_6x100-EPOCHS_50-REG_spr-LAMB_1.0-ALPHA_0.1-FT_10-ID_10000|checkpointRED_1RP_0.th-ID_10000-TIME_1800.0-DELTA_20.0
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_6x100-EPOCHS_50-REG_spr-LAMB_1.0-ALPHA_0.1-FT_10-ID_10000/checkpointRED_1RP_0.th'
=> loaded pretrained arch 97.52, with accuracy '1x39-1x82-2x61-1x60-1x54'
Test: [49/79]	Loss 0.0023 (0.1212) ([0.002]+[0.000])	Prec@1 100.000 (96.984)
 * Prec@1 97.520
Correct label is  tensor(3)  || Wrong label is  tensor(8)
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Model for sequential:
714 variables
367 constraints
357 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0             (1, 39)           39           39            0            0

relu_1               (1, 39)           39            0            0           39

linear_2             (1, 82)           82           82            0            0

relu_3               (1, 82)           82            0            0           82

linear_4             (1, 61)           61           61            0            0

relu_5               (1, 61)           61            0            0           61

linear_6             (1, 61)           61           61            0            0

relu_7               (1, 61)           61            0            0           61

linear_8             (1, 60)           60           60            0            0

relu_9               (1, 60)           60            0            0           60

linear_10            (1, 54)           54           54            0            0

relu_11              (1, 54)           54            0            0           54

linear_12            (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 1800
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1936 rows, 2292 columns and 54054 nonzeros
Model fingerprint: 0xd3e3292b
Model has 357 general constraints
Variable types: 2292 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e-12, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-03, 2e+01]
Presolve removed 370 rows and 106 columns
Presolve time: 0.26s
Presolved: 1566 rows, 2186 columns, 52573 nonzeros
Variable types: 1639 continuous, 547 integer (547 binary)

Root relaxation: objective 3.139763e+03, 4534 iterations, 0.42 seconds (0.79 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 3139.76342    0  360          - 3139.76342      -     -    0s
     0     0 3113.80085    0  386          - 3113.80085      -     -    1s
     0     0 3074.06091    0  389          - 3074.06091      -     -    1s
     0     0 3074.02644    0  391          - 3074.02644      -     -    1s
     0     0 3074.02312    0  390          - 3074.02312      -     -    2s
     0     0 3054.26828    0  398          - 3054.26828      -     -    2s
     0     0 3019.19896    0  405          - 3019.19896      -     -    2s
     0     0 3018.33422    0  406          - 3018.33422      -     -    2s
     0     0 3018.30206    0  410          - 3018.30206      -     -    2s
     0     0 3018.29666    0  409          - 3018.29666      -     -    2s
     0     0 3008.48688    0  411          - 3008.48688      -     -    3s
     0     0 2957.94313    0  414          - 2957.94313      -     -    3s
     0     0 2929.39524    0  429          - 2929.39524      -     -    3s
     0     0 2928.31999    0  428          - 2928.31999      -     -    3s
     0     0 2928.25485    0  432          - 2928.25485      -     -    3s
     0     0 2928.24171    0  430          - 2928.24171      -     -    3s
     0     0 2915.62443    0  427          - 2915.62443      -     -    4s
     0     0 2898.45970    0  425          - 2898.45970      -     -    4s
     0     0 2893.06081    0  434          - 2893.06081      -     -    4s
     0     0 2892.47657    0  429          - 2892.47657      -     -    4s
     0     0 2892.02358    0  425          - 2892.02358      -     -    4s
     0     0 2891.99599    0  429          - 2891.99599      -     -    4s
     0     0 2885.28326    0  431          - 2885.28326      -     -    5s
     0     0 2877.84219    0  430          - 2877.84219      -     -    5s
     0     0 2876.63223    0  427          - 2876.63223      -     -    5s
     0     0 2876.30055    0  426          - 2876.30055      -     -    5s
     0     0 2876.20037    0  428          - 2876.20037      -     -    5s
     0     0 2868.25097    0  437          - 2868.25097      -     -    5s
     0     0 2862.86250    0  431          - 2862.86250      -     -    6s
     0     0 2860.94575    0  432          - 2860.94575      -     -    6s
     0     0 2860.79031    0  432          - 2860.79031      -     -    6s
     0     0 2851.74077    0  432          - 2851.74077      -     -    6s
     0     0 2841.51776    0  439          - 2841.51776      -     -    6s
     0     0 2839.41040    0  433          - 2839.41040      -     -    6s
     0     0 2838.89167    0  435          - 2838.89167      -     -    7s
     0     0 2838.70567    0  438          - 2838.70567      -     -    7s
     0     0 2806.60189    0  441          - 2806.60189      -     -    7s
     0     0 2804.14236    0  439          - 2804.14236      -     -    8s
     0     0 2801.22039    0  438          - 2801.22039      -     -    8s
     0     0 2800.70494    0  440          - 2800.70494      -     -    8s
     0     0 2800.56437    0  444          - 2800.56437      -     -    8s
     0     0 2798.14293    0  445          - 2798.14293      -     -    8s
     0     0 2795.63392    0  445          - 2795.63392      -     -    8s
     0     0 2794.58813    0  449          - 2794.58813      -     -    9s
     0     0 2794.40462    0  446          - 2794.40462      -     -    9s
     0     0 2790.22961    0  445          - 2790.22961      -     -    9s
     0     0 2789.18755    0  446          - 2789.18755      -     -    9s
     0     0 2788.75897    0  449          - 2788.75897      -     -    9s
     0     0 2788.63660    0  449          - 2788.63660      -     -    9s
     0     0 2776.58229    0  442          - 2776.58229      -     -    9s
     0     0 2772.58921    0  450          - 2772.58921      -     -   10s
     0     0 2771.96841    0  456          - 2771.96841      -     -   10s
     0     0 2771.80717    0  457          - 2771.80717      -     -   10s
     0     0 2766.10769    0  464          - 2766.10769      -     -   10s
     0     0 2763.20615    0  463          - 2763.20615      -     -   10s
     0     0 2762.43935    0  463          - 2762.43935      -     -   10s
     0     0 2762.09565    0  467          - 2762.09565      -     -   10s
     0     0 2761.97100    0  466          - 2761.97100      -     -   10s
     0     0 2755.14823    0  464          - 2755.14823      -     -   11s
     0     0 2752.13818    0  462          - 2752.13818      -     -   11s
     0     0 2751.55811    0  461          - 2751.55811      -     -   11s
     0     0 2751.12714    0  460          - 2751.12714      -     -   11s
     0     0 2751.05864    0  459          - 2751.05864      -     -   11s
     0     0 2729.95114    0  467          - 2729.95114      -     -   11s
     0     0 2726.92834    0  474          - 2726.92834      -     -   11s
     0     0 2726.09308    0  470          - 2726.09308      -     -   12s
     0     0 2725.97822    0  471          - 2725.97822      -     -   12s
     0     0 2722.79102    0  473          - 2722.79102      -     -   12s
     0     0 2720.23039    0  471          - 2720.23039      -     -   12s
     0     0 2719.87147    0  467          - 2719.87147      -     -   12s
     0     0 2703.79939    0  455          - 2703.79939      -     -   12s
     0     0 2698.17673    0  454          - 2698.17673      -     -   12s
     0     0 2697.79552    0  458          - 2697.79552      -     -   12s
     0     0 2696.03481    0  458          - 2696.03481      -     -   13s
     0     0 2692.37693    0  460          - 2692.37693      -     -   13s
     0     0 2691.98697    0  464          - 2691.98697      -     -   13s
     0     0 2688.63751    0  454          - 2688.63751      -     -   13s
     0     0 2687.83925    0  457          - 2687.83925      -     -   13s
     0     0 2687.77768    0  457          - 2687.77768      -     -   13s
     0     0 2686.17243    0  458          - 2686.17243      -     -   14s
H    0     0                       1.9140782 2686.17243      -     -   15s

Cutting planes:
  Implied bound: 82
  MIR: 287
  Flow cover: 146

Explored 1 nodes (32384 simplex iterations) in 15.88 seconds (20.29 work units)
Thread count was 32 (of 96 available processors)

Solution count 1: 1.91408 

Optimization achieved user objective limit
Best objective 1.914078199639e+00, best bound 2.686172432442e+03, gap 140237.6535%
Solution is classified as 8
Time elapsed for full adv. : 16.5840 sec

{'Acc': 97.52, 'Loss': 0.020988034084439278, 'Elapsed': 15.880940914154053, 'Nodes': 1.0, 'Arch': '1x39-1x82-2x61-1x60-1x54'}
Saved to ./res/GRID/OBBT_-1-CUTS_-1-TIME_1800.0/RESUME_|ARCH_6x100-EPOCHS_50-REG_spr-LAMB_1.0-ALPHA_0.1-FT_10-ID_10000|checkpointRED_1RP_0.th-ID_10000-TIME_1800.0-DELTA_20.0.csv.



===================================================================
===================================================================


