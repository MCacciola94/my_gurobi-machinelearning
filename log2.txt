===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, obbt=-1, pretrained_path='./saved_models/ARCH_2x50-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000/checkpointRED_1RP_0.th')

RESUME_|ARCH_2x50-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000|checkpointRED_1RP_0.th
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x50-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000/checkpointRED_1RP_0.th'
=> loaded pretrained arch 97.77, with accuracy '1x39-1x43'
Traceback (most recent call last):
  File "/local1/caccmatt/Pruning_for_MIP/my_gurobi-machinelearning/main2.py", line 164, in <module>
    run(setting)
  File "/local1/caccmatt/Pruning_for_MIP/my_gurobi-machinelearning/experiment.py", line 66, in run
    trainer.validate(dataset,model,config,reg_on=False)
  File "/local1/caccmatt/Pruning_for_MIP/my_gurobi-machinelearning/modeltraining/trainer.py", line 108, in validate
    for i, (input, target) in enumerate(dataset["valid_loader"]):
  File "/home/caccmatt/.local/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 634, in __next__
    data = self._next_data()
  File "/home/caccmatt/.local/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1346, in _next_data
    return self._process_data(data)
  File "/home/caccmatt/.local/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1372, in _process_data
    data.reraise()
  File "/home/caccmatt/.local/lib/python3.9/site-packages/torch/_utils.py", line 644, in reraise
    raise exception
RuntimeError: Caught RuntimeError in pin memory thread for device 0.
Original Traceback (most recent call last):
  File "/home/caccmatt/.local/lib/python3.9/site-packages/torch/utils/data/_utils/pin_memory.py", line 34, in do_one_step
    data = pin_memory(data, device)
  File "/home/caccmatt/.local/lib/python3.9/site-packages/torch/utils/data/_utils/pin_memory.py", line 70, in pin_memory
    return type(data)([pin_memory(sample, device) for sample in data])  # type: ignore[call-arg]
  File "/home/caccmatt/.local/lib/python3.9/site-packages/torch/utils/data/_utils/pin_memory.py", line 70, in <listcomp>
    return type(data)([pin_memory(sample, device) for sample in data])  # type: ignore[call-arg]
  File "/home/caccmatt/.local/lib/python3.9/site-packages/torch/utils/data/_utils/pin_memory.py", line 55, in pin_memory
    return data.pin_memory(device)
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


Exception in thread Thread-1:
Traceback (most recent call last):
  File "/home/x86_64-unknown-linux_ol8-gnu/anaconda-2022.10/lib/python3.9/threading.py", line 980, in _bootstrap_inner
===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, obbt=-1, pretrained_path='./saved_models/ARCH_2x50-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000/checkpointRED_1RP_0.th')

RESUME_|ARCH_2x50-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000|checkpointRED_1RP_0.th
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x50-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000/checkpointRED_1RP_0.th'
=> loaded pretrained arch 97.77, with accuracy '1x39-1x43'
Test: [49/79]	Loss 0.0041 (0.0922) ([0.004]+[0.000])	Prec@1 100.000 (97.281)
 * Prec@1 97.770
Set parameter TokenServer to value "licences.gerad.lan"
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Model for sequential:
164 variables
92 constraints
82 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0             (1, 39)           39           39            0            0

relu_1               (1, 39)           39            0            0           39

linear_2             (1, 43)           43           43            0            0

relu_3               (1, 43)           43            0            0           43

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1661 rows, 1742 columns and 33689 nonzeros
Model fingerprint: 0xf8c27919
Model has 82 general constraints
Variable types: 1742 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e-13, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [2e-03, 5e+00]
Presolve removed 1128 rows and 656 columns
Presolve time: 0.08s
Presolved: 533 rows, 1086 columns, 30845 nonzeros
Variable types: 1024 continuous, 62 integer (62 binary)

Root relaxation: objective 2.483975e+02, 573 iterations, 0.02 seconds (0.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  248.39751    0   44          -  248.39751      -     -    0s
     0     0  203.98770    0   43          -  203.98770      -     -    0s
     0     0  203.64496    0   43          -  203.64496      -     -    0s
     0     0  112.98730    0   43          -  112.98730      -     -    0s
     0     0  112.98730    0   41          -  112.98730      -     -    0s
     0     0  112.98730    0   41          -  112.98730      -     -    0s
     0     0  112.98730    0   41          -  112.98730      -     -    0s
     0     0  112.98730    0   41          -  112.98730      -     -    0s
     0     0  112.98730    0   41          -  112.98730      -     -    0s
     0     0   96.67613    0   40          -   96.67613      -     -    0s
     0     0   91.77681    0   41          -   91.77681      -     -    0s
     0     0   91.49399    0   41          -   91.49399      -     -    0s
     0     0   91.38516    0   41          -   91.38516      -     -    0s
     0     0   91.29272    0   41          -   91.29272      -     -    0s
     0     0   91.28072    0   41          -   91.28072      -     -    0s
     0     0   65.85723    0   42          -   65.85723      -     -    0s
     0     0   63.44379    0   43          -   63.44379      -     -    0s
     0     0   62.93711    0   42          -   62.93711      -     -    0s
     0     0   62.87987    0   43          -   62.87987      -     -    0s
     0     0   55.84697    0   38          -   55.84697      -     -    0s
     0     0   55.16596    0   39          -   55.16596      -     -    0s
     0     0   55.14246    0   38          -   55.14246      -     -    0s
     0     0   53.78728    0   40          -   53.78728      -     -    0s
     0     0   53.51413    0   40          -   53.51413      -     -    0s
     0     0   53.33477    0   41          -   53.33477      -     -    0s
     0     0   53.30934    0   41          -   53.30934      -     -    0s
     0     0   47.02609    0   41          -   47.02609      -     -    0s
     0     0   45.72148    0   41          -   45.72148      -     -    0s
     0     0   45.65687    0   41          -   45.65687      -     -    0s
     0     0   43.38694    0   41          -   43.38694      -     -    0s
     0     0   43.01852    0   41          -   43.01852      -     -    0s
     0     0   42.92580    0   41          -   42.92580      -     -    0s
     0     0   38.40725    0   41          -   38.40725      -     -    0s
     0     0   38.15475    0   42          -   38.15475      -     -    0s
     0     0   38.11100    0   42          -   38.11100      -     -    0s
     0     0   36.58705    0   41          -   36.58705      -     -    0s
     0     0   36.55037    0   41          -   36.55037      -     -    0s
     0     0   36.07819    0   41          -   36.07819      -     -    0s
H    0     0                     -13.4714786   36.07819   368%     -    0s
     0     2   36.07819    0   41  -13.47148   36.07819   368%     -    1s
H   42    62                     -13.4714786   16.98832   226%   103    1s
* 1187   704              44     -12.9487531   13.41410   204%  34.5    1s
* 2182  1128              38     -11.1152591   11.67401   205%  31.5    1s
* 3567  1526              36     -10.7145875    8.00525   175%  29.9    2s
* 5456  1785              37     -10.6250132    0.23172   102%  29.5    2s

Cutting planes:
  Implied bound: 12
  MIR: 115
  Flow cover: 88
  Relax-and-lift: 5

Explored 6024 nodes (180136 simplex iterations) in 2.82 seconds (5.41 work units)
Thread count was 32 (of 96 available processors)

Solution count 5: -10.625 -10.7146 -11.1153 ... -13.4715

Optimization achieved user objective limit
Best objective -1.062501317677e+01, best bound -9.254270508485e-02, gap 99.1290%
No counter example exists in neighborhood.
Time elapsed for full adv. : 2.9657 sec

Saved to ./res/GRID/OBBT_-1/RESUME_|ARCH_2x50-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000|checkpointRED_1RP_0.th.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, obbt=-1, pretrained_path='./saved_models/ARCH_2x50-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000/checkpointRED_1RP_1.th', seed=0)

RESUME_|ARCH_2x50-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000|checkpointRED_1RP_1.th
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x50-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000/checkpointRED_1RP_1.th'
=> loaded pretrained arch 97.49, with accuracy '1x30-1x42'
Test: [49/79]	Loss 0.0353 (0.1101) ([0.035]+[0.000])	Prec@1 98.438 (96.812)
 * Prec@1 97.490
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Model for sequential:
144 variables
82 constraints
72 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0             (1, 30)           30           30            0            0

relu_1               (1, 30)           30            0            0           30

linear_2             (1, 42)           42           42            0            0

relu_3               (1, 42)           42            0            0           42

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1651 rows, 1722 columns and 26910 nonzeros
Model fingerprint: 0xe28385d6
Model has 72 general constraints
Variable types: 1722 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e-13, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [2e-03, 5e+00]
Presolve removed 1150 rows and 668 columns
Presolve time: 0.06s
Presolved: 501 rows, 1054 columns, 24058 nonzeros
Variable types: 1003 continuous, 51 integer (51 binary)

Root relaxation: objective 2.317690e+02, 498 iterations, 0.01 seconds (0.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  231.76904    0   38          -  231.76904      -     -    0s
     0     0  190.21459    0   34          -  190.21459      -     -    0s
     0     0  189.58008    0   34          -  189.58008      -     -    0s
     0     0  117.70109    0   39          -  117.70109      -     -    0s
     0     0  115.52115    0   41          -  115.52115      -     -    0s
     0     0  115.38288    0   40          -  115.38288      -     -    0s
     0     0  115.37063    0   41          -  115.37063      -     -    0s
     0     0  102.60908    0   39          -  102.60908      -     -    0s
     0     0  101.86778    0   39          -  101.86778      -     -    0s
     0     0  101.80137    0   39          -  101.80137      -     -    0s
     0     0   84.74588    0   40          -   84.74588      -     -    0s
     0     0   83.95414    0   40          -   83.95414      -     -    0s
     0     0   83.87470    0   40          -   83.87470      -     -    0s
     0     0   76.77375    0   41          -   76.77375      -     -    0s
     0     0   76.12346    0   41          -   76.12346      -     -    0s
     0     0   76.06869    0   42          -   76.06869      -     -    0s
     0     0   68.19052    0   43          -   68.19052      -     -    0s
     0     0   66.46044    0   43          -   66.46044      -     -    0s
     0     0   66.14658    0   43          -   66.14658      -     -    0s
     0     0   66.13497    0   43          -   66.13497      -     -    0s
     0     0   64.57722    0   43          -   64.57722      -     -    0s
     0     0   64.44550    0   43          -   64.44550      -     -    0s
     0     0   64.17640    0   43          -   64.17640      -     -    0s
H    0     0                     -13.0610140   64.17640   591%     -    0s
     0     0   64.17640    0   43  -13.06101   64.17640   591%     -    0s
     0     2   64.17640    0   43  -13.06101   64.17640   591%     -    0s
H   88    98                     -13.0610140   16.57023   227%   102    1s
H   90    98                     -12.3136139   16.57023   235%   102    1s
H  110    98                     -10.8120267   16.57023   253%  94.8    1s
H  632   401                     -10.3506659   16.57023   260%  47.3    1s
*  921   613              34     -10.0650241   16.01630   259%  44.1    1s
* 1776   970              34      -9.6871451   13.62009   241%  38.6    2s
H 1903   964                      -9.5751978   13.62009   242%  38.1    2s
* 1909   964              34      -9.4967357   13.62009   243%  38.0    2s
* 2002   966              34      -9.2284592   13.62009   248%  37.8    2s

Cutting planes:
  Implied bound: 10
  MIR: 122
  Flow cover: 61
  Inf proof: 1
  Relax-and-lift: 2

Explored 6277 nodes (231191 simplex iterations) in 3.92 seconds (6.22 work units)
Thread count was 32 (of 96 available processors)

Solution count 9: -9.22846 -9.49674 -9.5752 ... -13.061

Optimization achieved user objective limit
Best objective -9.228459221533e+00, best bound -2.185103029991e-03, gap 99.9763%
No counter example exists in neighborhood.
Time elapsed for full adv. : 4.0843 sec

Saved to ./res/GRID/OBBT_-1/RESUME_|ARCH_2x50-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000|checkpointRED_1RP_1.th.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, obbt=-1, pretrained_path='./saved_models/ARCH_2x50-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000/checkpointRED_1RP_2.th', seed=0)

RESUME_|ARCH_2x50-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000|checkpointRED_1RP_2.th
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x50-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000/checkpointRED_1RP_2.th'
=> loaded pretrained arch 97.73, with accuracy '1x39-1x42'
Test: [49/79]	Loss 0.0118 (0.0965) ([0.012]+[0.000])	Prec@1 99.219 (97.250)
 * Prec@1 97.730
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Model for sequential:
162 variables
91 constraints
81 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0             (1, 39)           39           39            0            0

relu_1               (1, 39)           39            0            0           39

linear_2             (1, 42)           42           42            0            0

relu_3               (1, 42)           42            0            0           42

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1660 rows, 1740 columns and 33594 nonzeros
Model fingerprint: 0x6b023a8d
Model has 81 general constraints
Variable types: 1740 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [2e-13, 2e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [5e-04, 5e+00]
Presolve removed 1140 rows and 667 columns
Presolve time: 0.09s
Presolved: 520 rows, 1073 columns, 30712 nonzeros
Variable types: 1017 continuous, 56 integer (56 binary)

Root relaxation: objective 2.062492e+02, 675 iterations, 0.02 seconds (0.04 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  206.24921    0   39          -  206.24921      -     -    0s
     0     0  169.12483    0   39          -  169.12483      -     -    0s
     0     0  165.69757    0   41          -  165.69757      -     -    0s
     0     0  165.69757    0   39          -  165.69757      -     -    0s
     0     0   98.28353    0   45          -   98.28353      -     -    0s
     0     0   98.28353    0   45          -   98.28353      -     -    0s
     0     0   98.28353    0   45          -   98.28353      -     -    0s
     0     0   98.28353    0   45          -   98.28353      -     -    0s
     0     0   98.28353    0   45          -   98.28353      -     -    0s
     0     0   91.57698    0   43          -   91.57698      -     -    0s
     0     0   90.00982    0   43          -   90.00982      -     -    0s
     0     0   90.00526    0   43          -   90.00526      -     -    0s
     0     0   74.94614    0   44          -   74.94614      -     -    0s
     0     0   71.42976    0   42          -   71.42976      -     -    0s
     0     0   70.49243    0   44          -   70.49243      -     -    0s
     0     0   70.27382    0   44          -   70.27382      -     -    0s
     0     0   70.20630    0   44          -   70.20630      -     -    0s
     0     0   59.24101    0   43          -   59.24101      -     -    0s
     0     0   56.74524    0   42          -   56.74524      -     -    0s
     0     0   56.01620    0   42          -   56.01620      -     -    0s
     0     0   56.01098    0   42          -   56.01098      -     -    0s
     0     0   48.04373    0   41          -   48.04373      -     -    0s
     0     0   47.56708    0   42          -   47.56708      -     -    0s
     0     0   47.34239    0   42          -   47.34239      -     -    0s
     0     0   47.22211    0   42          -   47.22211      -     -    0s
     0     0   47.13955    0   42          -   47.13955      -     -    0s
     0     0   45.18729    0   43          -   45.18729      -     -    0s
     0     0   45.00095    0   43          -   45.00095      -     -    0s
     0     0   44.93444    0   43          -   44.93444      -     -    0s
     0     0   41.29966    0   42          -   41.29966      -     -    0s
H    0     0                      -9.3092529   40.99166   540%     -    0s
     0     0   40.99166    0   43   -9.30925   40.99166   540%     -    0s
     0     0   40.93069    0   43   -9.30925   40.93069   540%     -    0s
     0     0   35.75573    0   43   -9.30925   35.75573   484%     -    0s
     0     0   35.32088    0   43   -9.30925   35.32088   479%     -    0s
     0     0   35.07386    0   43   -9.30925   35.07386   477%     -    0s
     0     0   35.00116    0   43   -9.30925   35.00116   476%     -    0s
     0     0   31.34089    0   41   -9.30925   31.34089   437%     -    1s
     0     0   30.73567    0   42   -9.30925   30.73567   430%     -    1s
     0     0   30.71538    0   42   -9.30925   30.71538   430%     -    1s
     0     0   28.12752    0   43   -9.30925   28.12752   402%     -    1s
     0     0   27.54285    0   43   -9.30925   27.54285   396%     -    1s
     0     0   27.44624    0   43   -9.30925   27.44624   395%     -    1s
     0     0   26.83483    0   41   -9.30925   26.83483   388%     -    1s
     0     2   26.83483    0   41   -9.30925   26.83483   388%     -    1s

Cutting planes:
  Gomory: 5
  Implied bound: 11
  MIR: 116
  Flow cover: 83
  Relax-and-lift: 3

Explored 882 nodes (35854 simplex iterations) in 1.81 seconds (3.05 work units)
Thread count was 32 (of 96 available processors)

Solution count 1: -9.30925 

Optimization achieved user objective limit
Best objective -9.309252899028e+00, best bound -7.170418146041e-02, gap 99.2298%
No counter example exists in neighborhood.
Time elapsed for full adv. : 1.8801 sec

Saved to ./res/GRID/OBBT_-1/RESUME_|ARCH_2x50-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000|checkpointRED_1RP_2.th.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, obbt=-1, pretrained_path='./saved_models/ARCH_2x100-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000/checkpointRED_1RP_0.th', seed=0)

RESUME_|ARCH_2x100-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000|checkpointRED_1RP_0.th
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x100-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000/checkpointRED_1RP_0.th'
=> loaded pretrained arch 98.08, with accuracy '1x61-1x80'
Test: [49/79]	Loss 0.0008 (0.0779) ([0.001]+[0.000])	Prec@1 100.000 (97.734)
 * Prec@1 98.080
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Model for sequential:
282 variables
151 constraints
141 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0             (1, 61)           61           61            0            0

relu_1               (1, 61)           61            0            0           61

linear_2             (1, 80)           80           80            0            0

relu_3               (1, 80)           80            0            0           80

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1720 rows, 1860 columns and 57566 nonzeros
Model fingerprint: 0xb536ce79
Model has 141 general constraints
Variable types: 1860 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e-13, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [5e-04, 5e+00]
Presolve removed 1052 rows and 572 columns
Presolve time: 0.23s
Presolved: 668 rows, 1288 columns, 49976 nonzeros
Variable types: 1149 continuous, 139 integer (100 binary)

Root relaxation: objective 2.377403e+02, 730 iterations, 0.03 seconds (0.07 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  237.74034    0   69          -  237.74034      -     -    0s
     0     0  203.82106    0   72          -  203.82106      -     -    0s
     0     0  202.38310    0   75          -  202.38310      -     -    0s
     0     0  168.77968    0   74          -  168.77968      -     -    0s
     0     0  160.05667    0   74          -  160.05667      -     -    0s
     0     0  158.02627    0   75          -  158.02627      -     -    0s
     0     0  157.93667    0   74          -  157.93667      -     -    0s
     0     0  157.91519    0   74          -  157.91519      -     -    0s
     0     0  119.21711    0   71          -  119.21711      -     -    0s
     0     0  114.61452    0   72          -  114.61452      -     -    0s
     0     0  113.77338    0   72          -  113.77338      -     -    0s
     0     0  113.66603    0   72          -  113.66603      -     -    0s
     0     0  113.63927    0   72          -  113.63927      -     -    1s
     0     0   93.57598    0   74          -   93.57598      -     -    1s
     0     0   91.28710    0   73          -   91.28710      -     -    1s
     0     0   90.52062    0   74          -   90.52062      -     -    1s
     0     0   90.42659    0   74          -   90.42659      -     -    1s
     0     0   90.42215    0   74          -   90.42215      -     -    1s
     0     0   82.12477    0   73          -   82.12477      -     -    1s
     0     0   79.35083    0   72          -   79.35083      -     -    1s
     0     0   78.96019    0   73          -   78.96019      -     -    1s
     0     0   78.82906    0   72          -   78.82906      -     -    1s
     0     0   78.78739    0   72          -   78.78739      -     -    1s
     0     0   73.33938    0   73          -   73.33938      -     -    1s
     0     0   72.73318    0   73          -   72.73318      -     -    1s
     0     0   72.56085    0   73          -   72.56085      -     -    1s
     0     0   71.52514    0   72          -   71.52514      -     -    1s
     0     0   71.39761    0   72          -   71.39761      -     -    1s
     0     0   64.73545    0   73          -   64.73545      -     -    1s
     0     0   64.03756    0   74          -   64.03756      -     -    1s
     0     0   63.92185    0   73          -   63.92185      -     -    1s
     0     0   55.92691    0   76          -   55.92691      -     -    1s
     0     0   55.18405    0   75          -   55.18405      -     -    1s
     0     0   55.08173    0   75          -   55.08173      -     -    1s
     0     0   52.12330    0   75          -   52.12330      -     -    1s
     0     0   51.81623    0   74          -   51.81623      -     -    1s
     0     0   51.77035    0   75          -   51.77035      -     -    1s
     0     0   44.90686    0   74          -   44.90686      -     -    1s
     0     0   44.45477    0   74          -   44.45477      -     -    1s
     0     0   44.39162    0   74          -   44.39162      -     -    1s
     0     0   43.41932    0   73          -   43.41932      -     -    2s
H    0     0                     -13.5805788   43.41932   420%     -    2s
     0     2   43.41932    0   73  -13.58058   43.41932   420%     -    2s
* 1487  1016              67     -10.4978915   25.12375   339%  41.3    3s
  2458  1497     cutoff   37       -10.49789   20.08257   291%  36.0    6s
H 2465  1497                     -10.2393174   20.08257   296%  35.9    6s
H 2493  1497                      -9.5972725   20.08257   309%  36.0    6s
H 2800  1694                      -8.6010971   18.72416   318%  35.0    7s
  3063  1692   -1.08735   19   73   -8.60110   18.72416   318%  34.4   11s
  3092  1711    5.34855   15   72   -8.60110   15.13635   276%  34.1   16s

Explored 3111 nodes (118180 simplex iterations) in 19.23 seconds (27.94 work units)
Thread count was 32 (of 96 available processors)

Solution count 5: -8.6011 -9.59727 -10.2393 ... -13.5806

Optimization achieved user objective limit
Best objective -8.601097098855e+00, best bound -4.120581182627e+00, gap 52.0924%
No counter example exists in neighborhood.
Time elapsed for full adv. : 19.3219 sec

Saved to ./res/GRID/OBBT_-1/RESUME_|ARCH_2x100-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000|checkpointRED_1RP_0.th.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, obbt=-1, pretrained_path='./saved_models/ARCH_2x100-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000/checkpointRED_1RP_1.th', seed=0)

RESUME_|ARCH_2x100-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000|checkpointRED_1RP_1.th
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x100-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000/checkpointRED_1RP_1.th'
=> loaded pretrained arch 98.01, with accuracy '1x61-1x87'
Test: [49/79]	Loss 0.0017 (0.0822) ([0.002]+[0.000])	Prec@1 100.000 (97.484)
 * Prec@1 98.010
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Model for sequential:
296 variables
158 constraints
148 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0             (1, 61)           61           61            0            0

relu_1               (1, 61)           61            0            0           61

linear_2             (1, 87)           87           87            0            0

relu_3               (1, 87)           87            0            0           87

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1727 rows, 1874 columns and 58078 nonzeros
Model fingerprint: 0x61052eca
Model has 148 general constraints
Variable types: 1874 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [2e-13, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [2e-03, 5e+00]
Presolve removed 1040 rows and 567 columns
Presolve time: 0.19s
Presolved: 687 rows, 1307 columns, 50388 nonzeros
Variable types: 1160 continuous, 147 integer (106 binary)

Root relaxation: objective 2.587878e+02, 776 iterations, 0.04 seconds (0.08 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  258.78775    0   83          -  258.78775      -     -    0s
     0     0  218.22786    0   78          -  218.22786      -     -    0s
     0     0  215.20928    0   78          -  215.20928      -     -    0s
     0     0  152.21733    0   83          -  152.21733      -     -    0s
     0     0  146.59190    0   84          -  146.59190      -     -    0s
     0     0  145.78094    0   83          -  145.78094      -     -    0s
     0     0  145.54142    0   84          -  145.54142      -     -    0s
     0     0  145.50970    0   84          -  145.50970      -     -    0s
     0     0  122.57252    0   81          -  122.57252      -     -    0s
     0     0  114.03871    0   80          -  114.03871      -     -    0s
     0     0  113.41640    0   80          -  113.41640      -     -    0s
     0     0  113.20849    0   79          -  113.20849      -     -    1s
     0     0  113.20766    0   79          -  113.20766      -     -    1s
     0     0   94.81723    0   80          -   94.81723      -     -    1s
     0     0   92.23226    0   81          -   92.23226      -     -    1s
     0     0   91.69380    0   80          -   91.69380      -     -    1s
     0     0   90.98693    0   79          -   90.98693      -     -    1s
     0     0   90.97085    0   80          -   90.97085      -     -    1s
     0     0   79.42689    0   81          -   79.42689      -     -    1s
     0     0   77.36566    0   81          -   77.36566      -     -    1s
     0     0   76.86283    0   81          -   76.86283      -     -    1s
     0     0   76.75249    0   81          -   76.75249      -     -    1s
     0     0   71.78067    0   82          -   71.78067      -     -    1s
     0     0   70.49664    0   82          -   70.49664      -     -    1s
     0     0   70.47956    0   82          -   70.47956      -     -    1s
     0     0   65.03622    0   82          -   65.03622      -     -    1s
     0     0   63.52326    0   81          -   63.52326      -     -    1s
     0     0   63.39467    0   82          -   63.39467      -     -    1s
     0     0   57.20585    0   81          -   57.20585      -     -    1s
     0     0   56.11389    0   81          -   56.11389      -     -    1s
     0     0   55.86369    0   81          -   55.86369      -     -    1s
     0     0   55.83874    0   81          -   55.83874      -     -    1s
     0     0   47.67197    0   81          -   47.67197      -     -    1s
     0     0   46.42339    0   81          -   46.42339      -     -    1s
     0     0   46.22182    0   81          -   46.22182      -     -    1s
     0     0   46.19433    0   81          -   46.19433      -     -    1s
     0     0   43.80562    0   80          -   43.80562      -     -    1s
     0     0   43.35985    0   80          -   43.35985      -     -    1s
     0     0   43.28028    0   80          -   43.28028      -     -    1s
     0     0   40.88354    0   82          -   40.88354      -     -    1s
     0     0   40.38578    0   81          -   40.38578      -     -    2s
     0     0   40.31977    0   81          -   40.31977      -     -    2s
     0     0   39.93586    0   81          -   39.93586      -     -    2s
H    0     0                     -16.6662869   39.93586   340%     -    2s
     0     0   39.93586    0   81  -16.66629   39.93586   340%     -    2s
     0     2   39.93586    0   81  -16.66629   39.93586   340%     -    2s
* 1911  1249              79     -15.6887168   26.60871   270%  51.4    4s
* 1912  1249              79     -15.6726659   26.60871   270%  51.3    4s
H 2941  1779                     -15.6726659   26.60871   270%  47.7    7s
H 2961  1703                     -13.1325999   17.70440   235%  47.4    9s
  2967  1707    6.12351   17   77  -13.13260   15.92134   221%  47.3   10s
  2993  1726  -13.13260   26   67  -13.13260    2.99588   123%  48.1   15s

Explored 2996 nodes (152646 simplex iterations) in 15.67 seconds (23.99 work units)
Thread count was 32 (of 96 available processors)

Solution count 4: -13.1326 -15.6727 -15.6887 -16.6663 

Optimization achieved user objective limit
Best objective -1.313259990349e+01, best bound -5.330230038812e+00, gap 59.4122%
No counter example exists in neighborhood.
Time elapsed for full adv. : 15.7730 sec

Saved to ./res/GRID/OBBT_-1/RESUME_|ARCH_2x100-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000|checkpointRED_1RP_1.th.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, obbt=-1, pretrained_path='./saved_models/ARCH_2x100-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000/checkpointRED_1RP_2.th', seed=0)

RESUME_|ARCH_2x100-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000|checkpointRED_1RP_2.th
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x100-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000/checkpointRED_1RP_2.th'
=> loaded pretrained arch 98.04, with accuracy '1x63-1x86'
Test: [49/79]	Loss 0.0008 (0.0867) ([0.001]+[0.000])	Prec@1 100.000 (97.562)
 * Prec@1 98.040
Model for sequential:
298 variables
159 constraints
149 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0             (1, 63)           63           63            0            0

relu_1               (1, 63)           63            0            0           63

linear_2             (1, 86)           86           86            0            0

relu_3               (1, 86)           86            0            0           86

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1728 rows, 1876 columns and 59749 nonzeros
Model fingerprint: 0x790cf6c7
Model has 149 general constraints
Variable types: 1876 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e-13, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [2e-03, 5e+00]
Presolve removed 1032 rows and 560 columns
Presolve time: 0.26s
Presolved: 696 rows, 1316 columns, 51934 nonzeros
Variable types: 1162 continuous, 154 integer (110 binary)

Root relaxation: objective 2.588280e+02, 734 iterations, 0.03 seconds (0.07 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  258.82805    0   88          -  258.82805      -     -    0s
     0     0  221.91994    0   81          -  221.91994      -     -    0s
     0     0  220.13105    0   81          -  220.13105      -     -    0s
     0     0  220.12653    0   81          -  220.12653      -     -    0s
     0     0  161.96936    0   82          -  161.96936      -     -    0s
     0     0  157.38913    0   84          -  157.38913      -     -    0s
     0     0  156.45981    0   83          -  156.45981      -     -    0s
     0     0  156.35887    0   83          -  156.35887      -     -    0s
     0     0  156.34832    0   83          -  156.34832      -     -    0s
     0     0  116.84254    0   84          -  116.84254      -     -    1s
     0     0  106.80025    0   80          -  106.80025      -     -    1s
     0     0  105.91795    0   79          -  105.91795      -     -    1s
     0     0  105.79388    0   79          -  105.79388      -     -    1s
     0     0  105.77262    0   79          -  105.77262      -     -    1s
     0     0   89.08227    0   85          -   89.08227      -     -    1s
     0     0   86.84306    0   84          -   86.84306      -     -    1s
     0     0   86.51232    0   86          -   86.51232      -     -    1s
     0     0   86.04496    0   84          -   86.04496      -     -    1s
     0     0   86.00046    0   85          -   86.00046      -     -    1s
     0     0   70.35647    0   83          -   70.35647      -     -    1s
     0     0   68.37238    0   83          -   68.37238      -     -    1s
     0     0   67.96749    0   83          -   67.96749      -     -    1s
     0     0   67.91780    0   83          -   67.91780      -     -    1s
     0     0   61.58488    0   84          -   61.58488      -     -    1s
     0     0   61.07907    0   85          -   61.07907      -     -    1s
     0     0   61.00694    0   85          -   61.00694      -     -    1s
     0     0   56.05813    0   85          -   56.05813      -     -    1s
     0     0   55.36323    0   85          -   55.36323      -     -    1s
     0     0   55.28952    0   85          -   55.28952      -     -    1s
     0     0   52.16586    0   84          -   52.16586      -     -    1s
     0     0   51.49078    0   84          -   51.49078      -     -    1s
     0     0   51.26977    0   83          -   51.26977      -     -    1s
     0     0   51.26290    0   83          -   51.26290      -     -    1s
     0     0   47.39010    0   84          -   47.39010      -     -    1s
     0     0   46.42670    0   85          -   46.42670      -     -    1s
     0     0   46.17654    0   84          -   46.17654      -     -    1s
     0     0   46.14637    0   84          -   46.14637      -     -    1s
     0     0   44.18426    0   83          -   44.18426      -     -    1s
     0     0   43.62713    0   83          -   43.62713      -     -    2s
     0     0   43.58538    0   83          -   43.58538      -     -    2s
     0     0   42.11522    0   83          -   42.11522      -     -    2s
     0     0   41.88398    0   83          -   41.88398      -     -    2s
     0     0   41.71253    0   83          -   41.71253      -     -    2s
     0     0   41.29001    0   83          -   41.29001      -     -    2s
H    0     0                     -15.0951078   41.29001   374%     -    2s
     0     0   41.29001    0   83  -15.09511   41.29001   374%     -    2s
     0     2   41.29001    0   83  -15.09511   41.29001   374%     -    2s
* 1753  1166              83     -11.9589508   25.42044   313%  33.9    4s
* 1937  1272              77      -5.9281325   25.42044   529%  32.7    4s
  3749  1698    3.73160   25   58   -5.92813   14.70037   348%  31.6    5s
H 4800  1794                      -5.9281325   14.69906   348%  31.5    7s
  5787  2140   -1.74485   35   83   -5.92813   10.67561   280%  30.7   11s
  5816  2159   -2.70967   24   79   -5.92813   10.67561   280%  30.6   15s

Explored 5834 nodes (189729 simplex iterations) in 18.93 seconds (28.04 work units)
Thread count was 32 (of 96 available processors)

Solution count 3: -5.92813 -11.959 -15.0951 

Optimization achieved user objective limit
Best objective -5.928132466674e+00, best bound -1.540877240703e+00, gap 74.0074%
No counter example exists in neighborhood.
Time elapsed for full adv. : 19.0368 sec

Saved to ./res/GRID/OBBT_-1/RESUME_|ARCH_2x100-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.9-FT_10-ID_10000|checkpointRED_1RP_2.th.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, obbt=-1, pretrained_path='./saved_models/ARCH_2x200-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.5-FT_10-ID_10000/checkpointRED_1RP_0.th', seed=0)

RESUME_|ARCH_2x200-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.5-FT_10-ID_10000|checkpointRED_1RP_0.th
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x200-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.5-FT_10-ID_10000/checkpointRED_1RP_0.th'
=> loaded pretrained arch 97.96, with accuracy '1x56-1x144'
Test: [49/79]	Loss 0.0022 (0.0821) ([0.002]+[0.000])	Prec@1 100.000 (97.531)
 * Prec@1 97.960
Model for sequential:
400 variables
210 constraints
200 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0             (1, 56)           56           56            0            0

relu_1               (1, 56)           56            0            0           56

linear_2            (1, 144)          144          144            0            0

relu_3              (1, 144)          144            0            0          144

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1779 rows, 1978 columns and 57538 nonzeros
Model fingerprint: 0xc2ce9bbb
Model has 200 general constraints
Variable types: 1978 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [2e-10, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [4e-03, 5e+00]
Presolve removed 990 rows and 569 columns
Presolve time: 0.19s
Presolved: 789 rows, 1409 columns, 54174 nonzeros
Variable types: 1278 continuous, 131 integer (131 binary)

Root relaxation: objective 2.901413e+02, 857 iterations, 0.04 seconds (0.09 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  290.14132    0  104          -  290.14132      -     -    0s
     0     0  233.64006    0  117          -  233.64006      -     -    0s
     0     0  220.42101    0  119          -  220.42101      -     -    0s
     0     0  220.40692    0  119          -  220.40692      -     -    0s
     0     0  188.72615    0  113          -  188.72615      -     -    0s
     0     0  183.63577    0  114          -  183.63577      -     -    0s
     0     0  182.64037    0  114          -  182.64037      -     -    0s
     0     0  182.58399    0  114          -  182.58399      -     -    0s
     0     0  182.56919    0  114          -  182.56919      -     -    0s
     0     0  111.43412    0  108          -  111.43412      -     -    1s
     0     0  107.72029    0  107          -  107.72029      -     -    1s
     0     0  105.85681    0  106          -  105.85681      -     -    1s
     0     0  105.80614    0  106          -  105.80614      -     -    1s
     0     0   79.11623    0  103          -   79.11623      -     -    1s
     0     0   77.22670    0  103          -   77.22670      -     -    1s
     0     0   77.15123    0  103          -   77.15123      -     -    1s
     0     0   63.80075    0  105          -   63.80075      -     -    1s
     0     0   62.86356    0  104          -   62.86356      -     -    1s
     0     0   62.74322    0  104          -   62.74322      -     -    1s
     0     0   42.66836    0  102          -   42.66836      -     -    1s
     0     0   41.54418    0  102          -   41.54418      -     -    1s
     0     0   41.40343    0  103          -   41.40343      -     -    1s
     0     0   40.08413    0  102          -   40.08413      -     -    1s
     0     0   39.83474    0  102          -   39.83474      -     -    1s
     0     0   39.72950    0  102          -   39.72950      -     -    1s
     0     0   34.74065    0  104          -   34.74065      -     -    1s
     0     0   33.29572    0  103          -   33.29572      -     -    1s
     0     0   33.23240    0  103          -   33.23240      -     -    1s
     0     0   31.95827    0  103          -   31.95827      -     -    1s
     0     0   31.40761    0  103          -   31.40761      -     -    1s
     0     0   31.35788    0  103          -   31.35788      -     -    1s
     0     0   31.11661    0  103          -   31.11661      -     -    2s
H    0     0                     -17.2398312   31.11661   280%     -    2s
     0     0   31.11661    0  103  -17.23983   31.11661   280%     -    2s
     0     2   31.11661    0  103  -17.23983   31.11661   280%     -    2s
H   99   128                     -16.9640996   22.70708   234%   115    3s
H  100   128                     -16.6346496   22.70708   237%   114    3s
H 1187  1041                     -16.4026007   22.70708   238%  47.3    4s
  2525  2325  -13.34287   64   42  -16.40260   22.70708   238%  37.1    5s
* 2574  2323             107     -15.8325192   22.70708   243%  36.7    5s
* 2634  2318             110     -15.5461664   22.70708   246%  36.3    5s
* 2637  2315             110     -15.2849279   22.70708   249%  36.2    5s
  3022  2492  -10.85027   63  102  -15.28493   20.36656   233%  34.7   10s
H 3035  2375                     -12.1560814   18.28991   250%  34.5   12s
  3162  2416    8.73415   23   92  -12.15608    8.92072   173%  42.0   15s
  4607  2587    0.89433   37   80  -12.15608    8.92072   173%  48.7   23s
H 4611  2465                     -11.9009084    8.92072   175%  48.8   23s
H 4647  2366                      -9.0517621    8.92072   199%  48.9   29s
H 4667  2252                      -8.3971982    8.92072   206%  48.9   29s
  6355  2720   -5.47211   44   73   -8.39720    8.92072   206%  44.9   30s
* 8766  2921             114      -8.3144217    4.26137   151%  41.0   30s

Cutting planes:
  Gomory: 11
  Cover: 1
  Implied bound: 74
  MIR: 464
  Flow cover: 388
  Inf proof: 2
  Relax-and-lift: 5

Explored 18327 nodes (658411 simplex iterations) in 34.05 seconds (59.88 work units)
Thread count was 32 (of 96 available processors)

Solution count 10: -8.31442 -8.3972 -9.05176 ... -16.6346

Optimization achieved user objective limit
Best objective -8.314421684751e+00, best bound -1.365875899428e-01, gap 98.3572%
No counter example exists in neighborhood.
Time elapsed for full adv. : 34.1493 sec

Saved to ./res/GRID/OBBT_-1/RESUME_|ARCH_2x200-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.5-FT_10-ID_10000|checkpointRED_1RP_0.th.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, obbt=-1, pretrained_path='./saved_models/ARCH_2x200-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.5-FT_10-ID_10000/checkpointRED_1RP_1.th', seed=0)

RESUME_|ARCH_2x200-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.5-FT_10-ID_10000|checkpointRED_1RP_1.th
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x200-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.5-FT_10-ID_10000/checkpointRED_1RP_1.th'
=> loaded pretrained arch 98.13, with accuracy '1x57-1x144'
Test: [49/79]	Loss 0.0044 (0.0807) ([0.004]+[0.000])	Prec@1 100.000 (97.688)
 * Prec@1 98.130
Model for sequential:
402 variables
211 constraints
201 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0             (1, 57)           57           57            0            0

relu_1               (1, 57)           57            0            0           57

linear_2            (1, 144)          144          144            0            0

relu_3              (1, 144)          144            0            0          144

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1780 rows, 1980 columns and 58467 nonzeros
Model fingerprint: 0x2b8ee1d8
Model has 201 general constraints
Variable types: 1980 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [3e-12, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [4e-03, 5e+00]
Presolve removed 984 rows and 564 columns
Presolve time: 0.18s
Presolved: 796 rows, 1416 columns, 55074 nonzeros
Variable types: 1282 continuous, 134 integer (134 binary)

Root relaxation: objective 1.955280e+02, 843 iterations, 0.04 seconds (0.10 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  195.52801    0  107          -  195.52801      -     -    0s
     0     0  158.07775    0  107          -  158.07775      -     -    0s
     0     0  153.51110    0  106          -  153.51110      -     -    0s
     0     0  153.48909    0  106          -  153.48909      -     -    0s
     0     0   96.70975    0  112          -   96.70975      -     -    0s
     0     0   91.05653    0  112          -   91.05653      -     -    0s
     0     0   90.26053    0  113          -   90.26053      -     -    0s
     0     0   90.20744    0  113          -   90.20744      -     -    0s
     0     0   90.19329    0  113          -   90.19329      -     -    0s
     0     0   66.00175    0  107          -   66.00175      -     -    1s
     0     0   63.64120    0  109          -   63.64120      -     -    1s
     0     0   63.50833    0  109          -   63.50833      -     -    1s
     0     0   63.47643    0  109          -   63.47643      -     -    1s
     0     0   47.46799    0  108          -   47.46799      -     -    1s
     0     0   45.59031    0  107          -   45.59031      -     -    1s
     0     0   45.44934    0  107          -   45.44934      -     -    1s
     0     0   45.43232    0  107          -   45.43232      -     -    1s
     0     0   40.85846    0  111          -   40.85846      -     -    1s
     0     0   39.88018    0  109          -   39.88018      -     -    1s
     0     0   39.63037    0  109          -   39.63037      -     -    1s
     0     0   39.58830    0  109          -   39.58830      -     -    1s
     0     0   33.17981    0  109          -   33.17981      -     -    1s
     0     0   31.85343    0  110          -   31.85343      -     -    1s
     0     0   31.42490    0  109          -   31.42490      -     -    1s
     0     0   31.36093    0  109          -   31.36093      -     -    1s
     0     0   27.92750    0  111          -   27.92750      -     -    1s
     0     0   27.23665    0  111          -   27.23665      -     -    1s
     0     0   27.04480    0  111          -   27.04480      -     -    1s
     0     0   27.02948    0  111          -   27.02948      -     -    1s
     0     0   25.35995    0  111          -   25.35995      -     -    1s
     0     0   25.09120    0  111          -   25.09120      -     -    2s
     0     0   25.07854    0  111          -   25.07854      -     -    2s
     0     0   24.26933    0  110          -   24.26933      -     -    2s
H    0     0                     -11.2868870   24.26933   315%     -    2s
     0     2   24.26933    0  110  -11.28689   24.26933   315%     -    2s
H 2953  2111                     -11.2868870   16.78475   249%  37.7    6s
  2979  2129   -8.24073   32  109  -11.28689   13.79773   222%  37.3   10s
  3005  2147    0.10302   15  102  -11.28689    0.10302   101%  38.4   15s

Explored 3010 nodes (123691 simplex iterations) in 18.86 seconds (26.95 work units)
Thread count was 32 (of 96 available processors)

Solution count 1: -11.2869 

Optimization achieved user objective limit
Best objective -1.128688698478e+01, best bound -2.273662765449e+00, gap 79.8557%
No counter example exists in neighborhood.
Time elapsed for full adv. : 18.9581 sec

Saved to ./res/GRID/OBBT_-1/RESUME_|ARCH_2x200-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.5-FT_10-ID_10000|checkpointRED_1RP_1.th.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, obbt=-1, pretrained_path='./saved_models/ARCH_2x200-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.5-FT_10-ID_10000/checkpointRED_1RP_2.th', seed=0)

RESUME_|ARCH_2x200-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.5-FT_10-ID_10000|checkpointRED_1RP_2.th
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x200-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.5-FT_10-ID_10000/checkpointRED_1RP_2.th'
=> loaded pretrained arch 98.04, with accuracy '1x59-1x140'
Test: [49/79]	Loss 0.0002 (0.0872) ([0.000]+[0.000])	Prec@1 100.000 (97.609)
 * Prec@1 98.040
Model for sequential:
398 variables
209 constraints
199 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0             (1, 59)           59           59            0            0

relu_1               (1, 59)           59            0            0           59

linear_2            (1, 140)          140          140            0            0

relu_3              (1, 140)          140            0            0          140

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1778 rows, 1976 columns and 60045 nonzeros
Model fingerprint: 0xeb0b40fe
Model has 199 general constraints
Variable types: 1976 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [6e-13, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [6e-04, 5e+00]
Presolve removed 986 rows and 564 columns
Presolve time: 0.21s
Presolved: 792 rows, 1412 columns, 56634 nonzeros
Variable types: 1279 continuous, 133 integer (133 binary)

Root relaxation: objective 3.072524e+02, 772 iterations, 0.04 seconds (0.08 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  307.25241    0  109          -  307.25241      -     -    0s
     0     0  272.79200    0  117          -  272.79200      -     -    0s
     0     0  255.90386    0  108          -  255.90386      -     -    0s
     0     0  252.90550    0  115          -  252.90550      -     -    0s
     0     0  252.61714    0  113          -  252.61714      -     -    0s
     0     0  252.61330    0  113          -  252.61330      -     -    0s
     0     0  213.45067    0  112          -  213.45067      -     -    1s
     0     0  209.69157    0  112          -  209.69157      -     -    1s
     0     0  209.01084    0  111          -  209.01084      -     -    1s
     0     0  208.93378    0  112          -  208.93378      -     -    1s
     0     0  208.92804    0  112          -  208.92804      -     -    1s
     0     0  178.73315    0  115          -  178.73315      -     -    1s
     0     0  172.80603    0  116          -  172.80603      -     -    1s
     0     0  169.40596    0  116          -  169.40596      -     -    1s
     0     0  169.20258    0  116          -  169.20258      -     -    1s
     0     0  169.14162    0  115          -  169.14162      -     -    1s
     0     0  114.75445    0  111          -  114.75445      -     -    1s
     0     0  111.37457    0  111          -  111.37457      -     -    1s
     0     0  111.19915    0  111          -  111.19915      -     -    1s
     0     0  111.17192    0  111          -  111.17192      -     -    1s
     0     0   94.70465    0  113          -   94.70465      -     -    1s
     0     0   92.51639    0  112          -   92.51639      -     -    1s
     0     0   92.26071    0  112          -   92.26071      -     -    1s
     0     0   92.25737    0  112          -   92.25737      -     -    1s
     0     0   82.27878    0  112          -   82.27878      -     -    1s
     0     0   80.56794    0  111          -   80.56794      -     -    1s
     0     0   80.39194    0  111          -   80.39194      -     -    1s
     0     0   71.82201    0  108          -   71.82201      -     -    2s
     0     0   70.82630    0  111          -   70.82630      -     -    2s
     0     0   70.67694    0  110          -   70.67694      -     -    2s
     0     0   64.68818    0  110          -   64.68818      -     -    2s
     0     0   63.24588    0  109          -   63.24588      -     -    2s
     0     0   63.05937    0  110          -   63.05937      -     -    2s
     0     0   53.26362    0  110          -   53.26362      -     -    2s
     0     0   52.12626    0  110          -   52.12626      -     -    2s
     0     0   52.03478    0  110          -   52.03478      -     -    2s
     0     0   51.19813    0  110          -   51.19813      -     -    2s
H    0     0                     -19.2432602   51.19813   366%     -    2s
     0     2   51.19813    0  109  -19.24326   51.19813   366%     -    2s
H   96   126                     -19.1988855   37.55166   296%   161    4s
H   97   126                     -18.8047715   37.55166   300%   162    4s
H   98   126                     -18.3681853   37.55166   304%   163    4s
   353   374   25.09145   11   96  -18.36819   37.55166   304%   100    5s
H 1137   911                     -15.5149068   37.55166   342%  58.8    6s
H 1138   911                     -13.8431939   37.55166   371%  58.7    6s
  2930  2164    3.13380   23  109  -13.84319   32.93230   338%  43.6   10s
  2964  2187   -1.63731   19  106  -13.84319   23.00867   266%  43.1   15s
  2989  2205    0.54545   14   96  -13.84319    0.54545   104%  44.8   20s

Explored 2997 nodes (142921 simplex iterations) in 23.94 seconds (33.51 work units)
Thread count was 32 (of 96 available processors)

Solution count 4: -13.8432 -18.8048 -19.1989 -19.2433 

Optimization achieved user objective limit
Best objective -1.384319390893e+01, best bound -6.346106934867e+00, gap 54.1572%
No counter example exists in neighborhood.
Time elapsed for full adv. : 24.0304 sec

Saved to ./res/GRID/OBBT_-1/RESUME_|ARCH_2x200-EPOCHS_50-REG_spr-LAMB_0.5-ALPHA_0.5-FT_10-ID_10000|checkpointRED_1RP_2.th.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, obbt=-1, pretrained_path='./saved_models/ARCH_6x100-EPOCHS_50-REG_spr-LAMB_1.0-ALPHA_0.1-FT_10-ID_10000/checkpointRED_1RP_0.th', seed=0)

RESUME_|ARCH_6x100-EPOCHS_50-REG_spr-LAMB_1.0-ALPHA_0.1-FT_10-ID_10000|checkpointRED_1RP_0.th
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_6x100-EPOCHS_50-REG_spr-LAMB_1.0-ALPHA_0.1-FT_10-ID_10000/checkpointRED_1RP_0.th'
=> loaded pretrained arch 97.52, with accuracy '1x39-1x82-2x61-1x60-1x54'
Test: [49/79]	Loss 0.0023 (0.1212) ([0.002]+[0.000])	Prec@1 100.000 (96.984)
 * Prec@1 97.520
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Model for sequential:
714 variables
367 constraints
357 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0             (1, 39)           39           39            0            0

relu_1               (1, 39)           39            0            0           39

linear_2             (1, 82)           82           82            0            0

relu_3               (1, 82)           82            0            0           82

linear_4             (1, 61)           61           61            0            0

relu_5               (1, 61)           61            0            0           61

linear_6             (1, 61)           61           61            0            0

relu_7               (1, 61)           61            0            0           61

linear_8             (1, 60)           60           60            0            0

relu_9               (1, 60)           60            0            0           60

linear_10            (1, 54)           54           54            0            0

relu_11              (1, 54)           54            0            0           54

linear_12            (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1936 rows, 2292 columns and 54054 nonzeros
Model fingerprint: 0x75b1d0f9
Model has 357 general constraints
Variable types: 2292 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e-12, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-03, 5e+00]
Presolve removed 370 rows and 106 columns
Presolve time: 0.26s
Presolved: 1566 rows, 2186 columns, 52573 nonzeros
Variable types: 1639 continuous, 547 integer (547 binary)

Root relaxation: objective 3.139461e+03, 4236 iterations, 0.34 seconds (0.62 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 3139.46134    0  360          - 3139.46134      -     -    0s
     0     0 3113.94817    0  387          - 3113.94817      -     -    1s
     0     0 3074.12907    0  389          - 3074.12907      -     -    1s
     0     0 3074.03170    0  389          - 3074.03170      -     -    1s
     0     0 3074.02897    0  388          - 3074.02897      -     -    1s
     0     0 3060.00645    0  401          - 3060.00645      -     -    1s
     0     0 3032.37938    0  409          - 3032.37938      -     -    2s
     0     0 3031.62458    0  414          - 3031.62458      -     -    2s
     0     0 3031.34836    0  416          - 3031.34836      -     -    2s
     0     0 3031.17932    0  414          - 3031.17932      -     -    2s
     0     0 3031.08111    0  414          - 3031.08111      -     -    2s
     0     0 3031.06754    0  414          - 3031.06754      -     -    2s
     0     0 3016.72069    0  420          - 3016.72069      -     -    3s
     0     0 2975.78428    0  422          - 2975.78428      -     -    3s
     0     0 2939.45735    0  423          - 2939.45735      -     -    3s
     0     0 2938.57937    0  428          - 2938.57937      -     -    3s
     0     0 2938.44329    0  434          - 2938.44329      -     -    3s
     0     0 2938.40468    0  433          - 2938.40468      -     -    3s
     0     0 2897.54944    0  422          - 2897.54944      -     -    4s
     0     0 2881.37370    0  422          - 2881.37370      -     -    4s
     0     0 2877.28695    0  430          - 2877.28695      -     -    4s
     0     0 2876.63002    0  432          - 2876.63002      -     -    4s
     0     0 2876.50920    0  433          - 2876.50920      -     -    4s
     0     0 2859.41263    0  429          - 2859.41263      -     -    4s
     0     0 2852.68939    0  429          - 2852.68939      -     -    4s
     0     0 2851.52733    0  428          - 2851.52733      -     -    4s
     0     0 2851.10907    0  429          - 2851.10907      -     -    4s
     0     0 2851.01869    0  430          - 2851.01869      -     -    5s
     0     0 2834.16980    0  430          - 2834.16980      -     -    5s
     0     0 2829.51942    0  430          - 2829.51942      -     -    5s
     0     0 2828.41889    0  430          - 2828.41889      -     -    5s
     0     0 2828.07513    0  429          - 2828.07513      -     -    5s
     0     0 2827.96669    0  431          - 2827.96669      -     -    5s
     0     0 2807.49994    0  434          - 2807.49994      -     -    5s
     0     0 2802.15539    0  437          - 2802.15539      -     -    6s
     0     0 2801.56013    0  440          - 2801.56013      -     -    6s
     0     0 2801.35571    0  439          - 2801.35571      -     -    6s
     0     0 2780.72733    0  442          - 2780.72733      -     -    6s
     0     0 2773.45975    0  443          - 2773.45975      -     -    6s
     0     0 2772.68380    0  438          - 2772.68380      -     -    6s
     0     0 2772.46716    0  441          - 2772.46716      -     -    6s
     0     0 2755.80046    0  444          - 2755.80046      -     -    6s
     0     0 2750.40918    0  450          - 2750.40918      -     -    6s
     0     0 2749.36121    0  448          - 2749.36121      -     -    6s
     0     0 2749.20798    0  449          - 2749.20798      -     -    6s
     0     0 2677.27642    0  442          - 2677.27642      -     -    7s
     0     0 2670.76624    0  448          - 2670.76624      -     -    7s
     0     0 2668.75165    0  448          - 2668.75165      -     -    7s
     0     0 2668.34839    0  445          - 2668.34839      -     -    7s
     0     0 2624.33480    0  443          - 2624.33480      -     -    7s
     0     0 2617.39568    0  449          - 2617.39568      -     -    7s
     0     0 2616.13008    0  450          - 2616.13008      -     -    7s
     0     0 2615.94040    0  450          - 2615.94040      -     -    7s
     0     0 2539.34509    0  437          - 2539.34509      -     -    8s
     0     0 2534.79770    0  438          - 2534.79770      -     -    8s
     0     0 2533.78286    0  437          - 2533.78286      -     -    8s
     0     0 2533.49496    0  438          - 2533.49496      -     -    8s
     0     0 2517.66488    0  437          - 2517.66488      -     -    8s
     0     0 2513.02415    0  444          - 2513.02415      -     -    8s
     0     0 2511.90541    0  447          - 2511.90541      -     -    8s
     0     0 2511.59043    0  445          - 2511.59043      -     -    8s
     0     0 2500.48069    0  442          - 2500.48069      -     -    8s
     0     0 2498.56065    0  444          - 2498.56065      -     -    9s
     0     0 2498.11611    0  442          - 2498.11611      -     -    9s
     0     0 2484.85861    0  436          - 2484.85861      -     -    9s
     0     0 2481.78291    0  439          - 2481.78291      -     -    9s
     0     0 2481.25195    0  439          - 2481.25195      -     -    9s
     0     0 2473.09627    0  442          - 2473.09627      -     -    9s
     0     0 2471.21180    0  443          - 2471.21180      -     -    9s
     0     0 2470.77147    0  446          - 2470.77147      -     -    9s
     0     0 2466.26670    0  443          - 2466.26670      -     -    9s
H    0     0                     -11.0904222 2466.26670      -     -   11s
     0     0 2466.26670    0  443  -11.09042 2466.26670      -     -   12s
     0     2 2466.26670    0  443  -11.09042 2466.26670      -     -   13s
     7    16 1320.43040    3  214  -11.09042 2154.61948      -  4190   18s
    31    64 1168.64516    5  213  -11.09042 1935.71038      -  1845   20s
H   39    64                     -11.0904222 1935.71038      -  1796   20s
H   51    64                     -11.0904221 1862.23476      -  1736   20s
   159   188 1009.51028    8  195  -11.09042 1862.23476      -  1654   25s
   270   296  792.83297   11  182  -11.09042 1862.23476      -  1637   30s
H  313   325                     -11.0904213 1862.23476      -  1570   37s
H  319   325                     -11.0904207 1862.23476      -  1575   37s
H  338   325                     -11.0904205 1862.23476      -  1512   37s
   406   428  587.08832   12  185  -11.09042 1862.23476      -  1385   40s
   739   704   98.70475   20  123  -11.09042 1862.23476      -   986   45s
  1130   931 infeasible   33       -11.09042 1862.23476      -   824   50s
  1495  1289 infeasible   27       -11.09042 1862.23476      -   790   55s
  1987  1623   48.69684   41  203  -11.09042 1862.23476      -   711   60s
  2475  2024   35.35804   47  182  -11.09042 1862.23476      -   687   66s
  2962  2287 1254.84251    9  443  -11.09042 1862.23476      -   661   92s
  2966  2290   64.61731   20  249  -11.09042 1862.23476      -   660   95s
  2984  2302  166.72498   37  299  -11.09042  993.87902  9062%   656  100s
  3002  2314  262.34626   23  306  -11.09042  527.61387  4857%   652  105s
  3005  2316  454.17865   13  305  -11.09042  499.72333  4606%   652  114s
  3009  2319  311.75904   11  192  -11.09042  311.75904  2911%   655  116s
  3012  2321  203.81962   30  265  -11.09042  203.81962  1938%   654  121s
H 3015  2206                     -11.0904205  181.30468  1735%   654  123s
  3017  2208  109.70737   19  278  -11.09042  177.35811  1699%   653  125s
  3023  2213  177.35811   26  270  -11.09042  177.35811  1699%   654  130s
  3028  2216  169.49871    8  282  -11.09042  169.49871  1628%   653  141s
  3033  2221  118.89725   15  228  -11.09042  118.89725  1172%   653  145s
  3039  2225  103.46443   28  245  -11.09042  103.46443  1033%   652  153s
  3043  2229  103.46443   13  200  -11.09042  103.46443  1033%   653  155s
H 3043  2117                     -11.0904203  103.46443  1033%   653  155s
  3049  2121   98.59068   19  246  -11.09042   98.59068   989%   652  166s
  3057  2128   79.52149   11  230  -11.09042   79.52149   817%   652  170s
H 3057  2021                     -11.0904203   79.52149   817%   652  171s
  3059  2022   77.72554   23  226  -11.09042   77.72554   801%   652  176s

Cutting planes:
  Gomory: 1
  MIR: 259
  Flow cover: 41
  Relax-and-lift: 12

Explored 3066 nodes (2029085 simplex iterations) in 180.04 seconds (307.76 work units)
Thread count was 32 (of 96 available processors)

Solution count 1: -11.0904 

Time limit reached
Best objective -1.109042033084e+01, best bound 7.453544836829e+01, gap 772.0705%
No counter example exists in neighborhood.
Time elapsed for full adv. : 180.1483 sec

Saved to ./res/GRID/OBBT_-1/RESUME_|ARCH_6x100-EPOCHS_50-REG_spr-LAMB_1.0-ALPHA_0.1-FT_10-ID_10000|checkpointRED_1RP_0.th.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, obbt=-1, pretrained_path='./saved_models/ARCH_6x100-EPOCHS_50-REG_spr-LAMB_1.0-ALPHA_0.1-FT_10-ID_10000/checkpointRED_1RP_1.th', seed=0)

RESUME_|ARCH_6x100-EPOCHS_50-REG_spr-LAMB_1.0-ALPHA_0.1-FT_10-ID_10000|checkpointRED_1RP_1.th
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_6x100-EPOCHS_50-REG_spr-LAMB_1.0-ALPHA_0.1-FT_10-ID_10000/checkpointRED_1RP_1.th'
=> loaded pretrained arch 97.47, with accuracy '1x44-1x71-1x49-1x53-1x49-1x45'
Test: [49/79]	Loss 0.1055 (0.1278) ([0.106]+[0.000])	Prec@1 98.438 (96.891)
 * Prec@1 97.470
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Model for sequential:
622 variables
321 constraints
311 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0             (1, 44)           44           44            0            0

relu_1               (1, 44)           44            0            0           44

linear_2             (1, 71)           71           71            0            0

relu_3               (1, 71)           71            0            0           71

linear_4             (1, 49)           49           49            0            0

relu_5               (1, 49)           49            0            0           49

linear_6             (1, 53)           53           53            0            0

relu_7               (1, 53)           53            0            0           53

linear_8             (1, 49)           49           49            0            0

relu_9               (1, 49)           49            0            0           49

linear_10            (1, 45)           45           45            0            0

relu_11              (1, 45)           45            0            0           45

linear_12            (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1890 rows, 2200 columns and 53105 nonzeros
Model fingerprint: 0x513698dc
Model has 311 general constraints
Variable types: 2200 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [2e-13, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [2e-03, 5e+00]
Presolve removed 537 rows and 227 columns
Presolve time: 0.25s
Presolved: 1353 rows, 1973 columns, 51240 nonzeros
Variable types: 1543 continuous, 430 integer (430 binary)

Root relaxation: objective 2.738981e+03, 3174 iterations, 0.21 seconds (0.39 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 2738.98124    0  247          - 2738.98124      -     -    0s
     0     0 2667.96506    0  259          - 2667.96506      -     -    0s
     0     0 2531.85600    0  262          - 2531.85600      -     -    1s
     0     0 2530.63956    0  261          - 2530.63956      -     -    1s
     0     0 2530.55914    0  263          - 2530.55914      -     -    1s
     0     0 2486.11220    0  265          - 2486.11220      -     -    1s
     0     0 2456.29743    0  271          - 2456.29743      -     -    1s
     0     0 2453.43491    0  271          - 2453.43491      -     -    1s
     0     0 2453.29706    0  270          - 2453.29706      -     -    1s
     0     0 2453.28974    0  271          - 2453.28974      -     -    1s
     0     0 2419.77947    0  275          - 2419.77947      -     -    2s
     0     0 2405.61204    0  281          - 2405.61204      -     -    2s
     0     0 2395.57975    0  287          - 2395.57975      -     -    2s
     0     0 2394.91540    0  285          - 2394.91540      -     -    2s
     0     0 2394.64142    0  282          - 2394.64142      -     -    2s
     0     0 2394.61643    0  285          - 2394.61643      -     -    2s
     0     0 2190.11201    0  330          - 2190.11201      -     -    2s
     0     0 2170.55459    0  319          - 2170.55459      -     -    2s
     0     0 2166.66130    0  317          - 2166.66130      -     -    3s
     0     0 2166.58339    0  316          - 2166.58339      -     -    3s
     0     0 2156.58382    0  329          - 2156.58382      -     -    3s
     0     0 2153.78161    0  326          - 2153.78161      -     -    3s
     0     0 2152.93384    0  325          - 2152.93384      -     -    3s
     0     0 2152.50407    0  327          - 2152.50407      -     -    3s
     0     0 2136.73628    0  323          - 2136.73628      -     -    3s
     0     0 2133.51862    0  324          - 2133.51862      -     -    3s
     0     0 2132.87012    0  324          - 2132.87012      -     -    3s
     0     0 2132.73552    0  327          - 2132.73552      -     -    3s
     0     0 2120.95798    0  322          - 2120.95798      -     -    4s
     0     0 2116.00638    0  320          - 2116.00638      -     -    4s
     0     0 2115.66259    0  325          - 2115.66259      -     -    4s
     0     0 2109.52460    0  322          - 2109.52460      -     -    4s
     0     0 2107.14048    0  325          - 2107.14048      -     -    4s
     0     0 2106.62786    0  327          - 2106.62786      -     -    4s
     0     0 2101.11702    0  320          - 2101.11702      -     -    4s
     0     0 2099.03995    0  326          - 2099.03995      -     -    5s
     0     0 2098.07250    0  326          - 2098.07250      -     -    5s
     0     0 2097.92946    0  326          - 2097.92946      -     -    5s
     0     0 2085.99998    0  327          - 2085.99998      -     -    5s
     0     0 2084.40203    0  327          - 2084.40203      -     -    5s
     0     0 2084.16477    0  327          - 2084.16477      -     -    5s
     0     0 2079.16027    0  325          - 2079.16027      -     -    5s
     0     0 2079.16027    0  325          - 2079.16027      -     -    9s
     0     2 2079.16027    0  325          - 2079.16027      -     -   12s
    95   128  458.06533    6  186          -  988.06675      -   634   15s
   587   658  120.82557   17  139          -  800.77881      -   414   20s
  1238  1177   50.74483   25  102          -  800.77881      -   358   25s
  2682  2425  254.04651   33  156          -  766.10542      -   312   30s
  5243  4982   96.06270   58  110          -  766.10542      -   249   35s
  5534  4993   25.24082   78  211          -  766.10542      -   243   40s
  5549  5003   54.12668   85  246          -  587.58071      -   242   45s
  5555  5008  243.51109   15  208          -  243.51109      -   244   50s
  5558  5010  215.81829   22  221          -  215.81829      -   244   55s
  5561  5012  100.53338   45  230          -  200.27109      -   244   61s
  5568  5018  -12.30723   38  150          -   59.70670      -   245   65s
H 5569  4767                      -9.8827675   57.30058   680%   245   66s
  5578  4774   55.25307   38  162   -9.88277   55.25307   659%   245   70s
  5587  4782   45.73190    9  141   -9.88277   45.73190   563%   246   75s
  5600  4792   16.77207   46  132   -9.88277   16.77207   270%   246   80s
  5611  4800   16.77207   35  108   -9.88277   16.77207   270%   246   86s
  5625  4812   11.42679   22   85   -9.88277   11.42679   216%   246   90s
  5645  4828    2.87830   46   77   -9.88277    2.87830   129%   246   95s
  5667  4846    0.51412   25   70   -9.88277    0.51412   105%   246  100s
  5685  4860    0.20457   18   67   -9.88277    0.20457   102%   246  105s

Cutting planes:
  Gomory: 3
  MIR: 19
  Flow cover: 3

Explored 5685 nodes (1417247 simplex iterations) in 105.60 seconds (148.59 work units)
Thread count was 32 (of 96 available processors)

Solution count 1: -9.88277 

Optimization achieved user objective limit
Best objective -9.882767545577e+00, best bound -5.483808955874e-01, gap 94.4511%
No counter example exists in neighborhood.
Time elapsed for full adv. : 105.7205 sec

Saved to ./res/GRID/OBBT_-1/RESUME_|ARCH_6x100-EPOCHS_50-REG_spr-LAMB_1.0-ALPHA_0.1-FT_10-ID_10000|checkpointRED_1RP_1.th.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, obbt=-1, pretrained_path='./saved_models/ARCH_6x100-EPOCHS_50-REG_spr-LAMB_1.0-ALPHA_0.1-FT_10-ID_10000/checkpointRED_1RP_2.th', seed=0)

RESUME_|ARCH_6x100-EPOCHS_50-REG_spr-LAMB_1.0-ALPHA_0.1-FT_10-ID_10000|checkpointRED_1RP_2.th
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_6x100-EPOCHS_50-REG_spr-LAMB_1.0-ALPHA_0.1-FT_10-ID_10000/checkpointRED_1RP_2.th'
=> loaded pretrained arch 97.21, with accuracy '1x37-1x72-1x48-1x51-1x48-1x46'
Test: [49/79]	Loss 0.0259 (0.1238) ([0.026]+[0.000])	Prec@1 99.219 (96.641)
 * Prec@1 97.210
Warning for adding constraints: zero or small (< 1e-13) coefficients, ignored
Model for sequential:
604 variables
312 constraints
302 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0             (1, 37)           37           37            0            0

relu_1               (1, 37)           37            0            0           37

linear_2             (1, 72)           72           72            0            0

relu_3               (1, 72)           72            0            0           72

linear_4             (1, 48)           48           48            0            0

relu_5               (1, 48)           48            0            0           48

linear_6             (1, 51)           51           51            0            0

relu_7               (1, 51)           51            0            0           51

linear_8             (1, 48)           48           48            0            0

relu_9               (1, 48)           48            0            0           48

linear_10            (1, 46)           46           46            0            0

relu_11              (1, 46)           46            0            0           46

linear_12            (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1881 rows, 2182 columns and 46779 nonzeros
Model fingerprint: 0x1cb3a7a2
Model has 302 general constraints
Variable types: 2182 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [2e-12, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-03, 5e+00]
Presolve removed 533 rows and 214 columns
Presolve time: 0.21s
Presolved: 1348 rows, 1968 columns, 44920 nonzeros
Variable types: 1528 continuous, 440 integer (440 binary)
Warning: Markowitz tolerance tightened to 0.03125

Root relaxation: objective 1.934461e+03, 3987 iterations, 0.25 seconds (0.45 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 1934.46067    0  241          - 1934.46067      -     -    0s
     0     0 1851.16199    0  266          - 1851.16199      -     -    0s
     0     0 1786.92411    0  270          - 1786.92411      -     -    1s
     0     0 1786.92411    0  276          - 1786.92411      -     -    1s
     0     0 1786.92411    0  274          - 1786.92411      -     -    1s
     0     0 1786.92411    0  285          - 1786.92411      -     -    1s
     0     0 1770.43276    0  292          - 1770.43276      -     -    1s
     0     0 1770.43276    0  292          - 1770.43276      -     -    1s
     0     0 1770.43276    0  289          - 1770.43276      -     -    1s
     0     0 1770.43276    0  289          - 1770.43276      -     -    1s
     0     0 1699.71448    0  290          - 1699.71448      -     -    2s
     0     0 1664.87859    0  299          - 1664.87859      -     -    2s
     0     0 1646.04208    0  304          - 1646.04208      -     -    2s
     0     0 1645.41558    0  309          - 1645.41558      -     -    2s
     0     0 1645.36435    0  310          - 1645.36435      -     -    2s
     0     0 1627.67541    0  323          - 1627.67541      -     -    2s
     0     0 1619.15302    0  314          - 1619.15302      -     -    2s
     0     0 1618.36778    0  321          - 1618.36778      -     -    2s
     0     0 1618.13299    0  323          - 1618.13299      -     -    2s
     0     0 1576.33219    0  325          - 1576.33219      -     -    3s
     0     0 1569.21107    0  319          - 1569.21107      -     -    3s
     0     0 1568.83102    0  323          - 1568.83102      -     -    3s
     0     0 1568.69500    0  323          - 1568.69500      -     -    3s
     0     0 1556.54661    0  325          - 1556.54661      -     -    3s
     0     0 1555.06824    0  322          - 1555.06824      -     -    3s
     0     0 1554.63724    0  324          - 1554.63724      -     -    3s
     0     0 1554.58394    0  324          - 1554.58394      -     -    3s
     0     0 1549.63161    0  328          - 1549.63161      -     -    3s
     0     0 1546.80120    0  328          - 1546.80120      -     -    3s
     0     0 1546.03728    0  334          - 1546.03728      -     -    3s
     0     0 1545.85510    0  331          - 1545.85510      -     -    3s
     0     0 1539.59774    0  330          - 1539.59774      -     -    4s
     0     0 1538.80422    0  333          - 1538.80422      -     -    4s
     0     0 1538.66114    0  330          - 1538.66114      -     -    4s
     0     0 1534.51583    0  335          - 1534.51583      -     -    4s
     0     0 1533.32717    0  332          - 1533.32717      -     -    4s
     0     0 1533.11361    0  333          - 1533.11361      -     -    4s
     0     0 1528.64047    0  330          - 1528.64047      -     -    4s
     0     0 1527.29198    0  331          - 1527.29198      -     -    4s
     0     0 1527.00840    0  332          - 1527.00840      -     -    4s
     0     0 1512.28848    0  329          - 1512.28848      -     -    4s
     0     0 1511.51499    0  331          - 1511.51499      -     -    5s
     0     0 1511.33287    0  331          - 1511.33287      -     -    5s
     0     0 1503.87010    0  334          - 1503.87010      -     -    5s
     0     0 1501.39239    0  331          - 1501.39239      -     -    5s
     0     0 1501.26044    0  331          - 1501.26044      -     -    5s
     0     0 1488.80674    0  327          - 1488.80674      -     -    5s
     0     0 1487.70259    0  330          - 1487.70259      -     -    5s
     0     0 1487.49391    0  328          - 1487.49391      -     -    5s
     0     0 1469.50464    0  328          - 1469.50464      -     -    6s
     0     0 1468.52198    0  333          - 1468.52198      -     -    6s
     0     0 1468.27122    0  332          - 1468.27122      -     -    6s
     0     0 1461.26404    0  332          - 1461.26404      -     -    6s
     0     0 1459.84436    0  330          - 1459.84436      -     -    6s
     0     0 1459.46073    0  332          - 1459.46073      -     -    6s
     0     0 1447.65151    0  331          - 1447.65151      -     -    6s
     0     0 1446.25208    0  329          - 1446.25208      -     -    6s
     0     0 1445.62389    0  330          - 1445.62389      -     -    6s
     0     0 1445.51237    0  331          - 1445.51237      -     -    6s
     0     0 1436.43391    0  334          - 1436.43391      -     -    6s
     0     0 1435.10533    0  328          - 1435.10533      -     -    6s
     0     0 1434.98786    0  331          - 1434.98786      -     -    6s
     0     0 1424.09627    0  322          - 1424.09627      -     -    7s
     0     0 1423.98034    0  322          - 1423.98034      -     -    7s
     0     0 1404.68714    0  327          - 1404.68714      -     -    7s
     0     0 1402.54881    0  330          - 1402.54881      -     -    7s
     0     0 1402.36907    0  331          - 1402.36907      -     -    7s
     0     0 1388.09251    0  335          - 1388.09251      -     -    7s
     0     0 1386.74800    0  342          - 1386.74800      -     -    7s
     0     0 1386.67893    0  342          - 1386.67893      -     -    7s
     0     0 1377.02313    0  341          - 1377.02313      -     -    7s
     0     0 1376.20045    0  343          - 1376.20045      -     -    7s
     0     0 1375.85614    0  343          - 1375.85614      -     -    7s
     0     0 1368.91451    0  345          - 1368.91451      -     -    7s
     0     0 1368.50521    0  345          - 1368.50521      -     -    7s
     0     0 1363.60917    0  345          - 1363.60917      -     -    8s
     0     0 1363.06989    0  342          - 1363.06989      -     -   10s
     0     2 1363.06989    0  342          - 1363.06989      -     -   12s
    63    96  251.08013    6  178          -  558.39212      -  1220   15s
   419   408   96.65337   13  192          -  443.33611      -   796   20s
  1172   943   27.47557   23  161          -  443.33611      -   543   25s
  2867  2349  183.65088   21  217          -  436.64714      -   400   30s
  3198  2359   -4.37868   53  246          -  428.77561      -   374   35s
H 3204  2244                      -8.7633072  325.06231  3809%   374   36s
  3206  2246   63.98124   15  251   -8.76331  325.06231  3809%   373   42s
  3214  2252   17.27254   36  171   -8.76331  155.54934  1875%   375   45s
  3220  2257   13.06329   17  342   -8.76331  143.16063  1734%   379   50s
  3225  2260   22.36554   35  163   -8.76331   80.56962  1019%   378   55s
  3233  2267   33.49291   42  176   -8.76331   72.45083   927%   379   60s
  3236  2269   70.14084    8  198   -8.76331   70.14084   900%   379   65s
  3242  2274   20.14593   44  111   -8.76331   64.26938   833%   379   70s
  3247  2278   42.25734   33  168   -8.76331   42.25734   582%   379   75s
  3255  2284    0.06396   19  173   -8.76331   42.25734   582%   379   80s
  3265  2292   41.54834    9  186   -8.76331   41.54834   574%   380   85s
  3277  2302   -3.42220   57  120   -8.76331   30.23751   445%   380   90s
  3288  2310   28.08981   23   90   -8.76331   28.08981   421%   380   95s
  3308  2326   22.68269   10   88   -8.76331   22.68269   359%   379  101s
  3325  2340   15.95794   35   78   -8.76331   15.95794   282%   379  105s
  3347  2358   11.65682   33   75   -8.76331   11.65682   233%   377  110s
  3372  2378    4.84913   26   68   -8.76331    4.84913   155%   376  115s
  3571  2459   -0.22814  252   44   -8.76331    1.21834   114%   358  120s
H 3679  2350                      -7.8050401    1.11534   114%   349  121s
H 3680  2236                      -7.7325397    1.11534   114%   349  121s
H 3687  2126                      -5.2356389    1.11534   121%   348  121s
H 3851  2039                      -5.2356389    1.11534   121%   334  122s
H 3853  1941                      -5.2356381    1.11534   121%   334  122s
H 4975  1886                      -5.1973718    1.11534   121%   263  123s
H 4977  1798                      -5.1749077    1.11534   122%   263  123s
H 4993  1709                      -5.1716609    1.11534   122%   262  123s
H 4997  1628                      -5.0170460    1.11534   122%   262  123s
* 5344  1495             308      -4.9341618   -1.07586  78.2%   247  123s

Cutting planes:
  MIR: 16
  Flow cover: 6
  Inf proof: 1

Explored 5392 nodes (1339572 simplex iterations) in 123.90 seconds (177.09 work units)
Thread count was 32 (of 96 available processors)

Solution count 8: -4.93416 -5.01705 -5.17166 ... -8.76331

Optimization achieved user objective limit
Best objective -4.934161800066e+00, best bound -1.075857169791e+00, gap 78.1957%
No counter example exists in neighborhood.
Time elapsed for full adv. : 123.9754 sec

Saved to ./res/GRID/OBBT_-1/RESUME_|ARCH_6x100-EPOCHS_50-REG_spr-LAMB_1.0-ALPHA_0.1-FT_10-ID_10000|checkpointRED_1RP_2.th.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, obbt=-1, pretrained_path='./saved_models/ARCH_2x50-EPOCHS_50-ID_10000/checkpoint_0.th')

RESUME_|ARCH_2x50-EPOCHS_50-ID_10000|checkpoint_0.th
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x50-EPOCHS_50-ID_10000/checkpoint_0.th'
=> loaded pretrained arch 97.55, with accuracy '2x50'
Test: [49/79]	Loss 0.0005 (0.1286) ([0.001]+[0.000])	Prec@1 100.000 (97.031)
 * Prec@1 97.550
Set parameter TokenServer to value "licences.gerad.lan"
Model for sequential:
200 variables
110 constraints
100 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0             (1, 50)           50           50            0            0

relu_1               (1, 50)           50            0            0           50

linear_2             (1, 50)           50           50            0            0

relu_3               (1, 50)           50            0            0           50

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1679 rows, 1778 columns and 46230 nonzeros
Model fingerprint: 0xa2f1d384
Model has 100 general constraints
Variable types: 1778 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [4e-07, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [2e-03, 5e+00]
Presolve removed 1094 rows and 573 columns
Presolve time: 0.18s
Presolved: 585 rows, 1205 columns, 43631 nonzeros
Variable types: 1126 continuous, 79 integer (79 binary)

Root relaxation: objective 7.821592e+02, 449 iterations, 0.01 seconds (0.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  782.15922    0   56          -  782.15922      -     -    0s
     0     0  730.68710    0   67          -  730.68710      -     -    0s
     0     0  710.45007    0   66          -  710.45007      -     -    0s
     0     0  710.44959    0   66          -  710.44959      -     -    0s
     0     0  547.18482    0   59          -  547.18482      -     -    0s
     0     0  547.18482    0   62          -  547.18482      -     -    0s
     0     0  547.18482    0   61          -  547.18482      -     -    0s
     0     0  547.18482    0   62          -  547.18482      -     -    1s
     0     0  547.18482    0   62          -  547.18482      -     -    1s
     0     0  368.17857    0   63          -  368.17857      -     -    1s
     0     0  337.61736    0   64          -  337.61736      -     -    1s
     0     0  336.48840    0   63          -  336.48840      -     -    1s
     0     0  336.48263    0   63          -  336.48263      -     -    1s
     0     0  263.14366    0   65          -  263.14366      -     -    1s
     0     0  256.52182    0   66          -  256.52182      -     -    1s
     0     0  256.23594    0   66          -  256.23594      -     -    1s
     0     0  224.28128    0   69          -  224.28128      -     -    1s
     0     0  219.47160    0   70          -  219.47160      -     -    1s
     0     0  218.38104    0   70          -  218.38104      -     -    1s
     0     0  218.02091    0   70          -  218.02091      -     -    1s
     0     0  191.24158    0   70          -  191.24158      -     -    1s
     0     0  189.58722    0   70          -  189.58722      -     -    1s
     0     0  189.52023    0   70          -  189.52023      -     -    1s
     0     0  170.92436    0   71          -  170.92436      -     -    1s
     0     0  168.14268    0   70          -  168.14268      -     -    1s
     0     0  167.44050    0   70          -  167.44050      -     -    1s
     0     0  167.39516    0   70          -  167.39516      -     -    1s
     0     0  160.44424    0   72          -  160.44424      -     -    1s
     0     0  158.67251    0   72          -  158.67251      -     -    1s
     0     0  158.58870    0   72          -  158.58870      -     -    1s
     0     0  139.83482    0   71          -  139.83482      -     -    1s
     0     0  138.22109    0   71          -  138.22109      -     -    1s
     0     0  138.10172    0   71          -  138.10172      -     -    1s
     0     0  135.29864    0   70          -  135.29864      -     -    1s
H    0     0                     -23.7479896  135.29864   670%     -    1s
     0     0  135.29864    0   70  -23.74799  135.29864   670%     -    1s
     0     2  135.29864    0   70  -23.74799  135.29864   670%     -    2s
H  105    66                     -21.6074285   81.22997   476%   134    2s
* 1240   816              49     -10.4463488   74.34664   812%  46.7    3s
* 2302  1346              58      -9.8986052   65.94158   766%  42.9    3s
* 3407  1826              55      -5.6125116   65.94158  1275%  39.4    4s
  4462  1834   -0.80794   16   38   -5.61251   56.11362  1100%  39.0    5s
H 5783  2136                      -5.6125116   46.79242   934%  39.2    8s
  5797  2145   29.05527   14   61   -5.61251   46.79242   934%  39.1   10s
H 5804  2043                      -5.6125079   46.79242   934%  39.6   11s

Cutting planes:
  Gomory: 16

Explored 5820 nodes (236376 simplex iterations) in 15.11 seconds (21.02 work units)
Thread count was 32 (of 96 available processors)

Solution count 6: -5.61251 -5.61251 -9.89861 ... -23.748

Optimization achieved user objective limit
Best objective -5.612507922691e+00, best bound -7.534995959854e-01, gap 86.5746%
No counter example exists in neighborhood.
Time elapsed for full adv. : 15.3152 sec

Saved to ./res/GRID/OBBT_-1/RESUME_|ARCH_2x50-EPOCHS_50-ID_10000|checkpoint_0.th.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, obbt=-1, pretrained_path='./saved_models/ARCH_2x50-EPOCHS_50-ID_10000/checkpoint_1.th', seed=0)

RESUME_|ARCH_2x50-EPOCHS_50-ID_10000|checkpoint_1.th
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x50-EPOCHS_50-ID_10000/checkpoint_1.th'
=> loaded pretrained arch 97.47, with accuracy '2x50'
Test: [49/79]	Loss 0.0012 (0.1283) ([0.001]+[0.000])	Prec@1 100.000 (97.062)
 * Prec@1 97.470
Model for sequential:
200 variables
110 constraints
100 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0             (1, 50)           50           50            0            0

relu_1               (1, 50)           50            0            0           50

linear_2             (1, 50)           50           50            0            0

relu_3               (1, 50)           50            0            0           50

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1679 rows, 1778 columns and 46230 nonzeros
Model fingerprint: 0x3c4bd53d
Model has 100 general constraints
Variable types: 1778 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [5e-07, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [4e-03, 5e+00]
Presolve removed 1092 rows and 571 columns
Presolve time: 0.17s
Presolved: 587 rows, 1207 columns, 43636 nonzeros
Variable types: 1127 continuous, 80 integer (80 binary)

Root relaxation: objective 7.444916e+02, 447 iterations, 0.01 seconds (0.02 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  744.49155    0   59          -  744.49155      -     -    0s
     0     0  712.16089    0   65          -  712.16089      -     -    0s
     0     0  705.05788    0   67          -  705.05788      -     -    0s
     0     0  578.09820    0   62          -  578.09820      -     -    1s
     0     0  578.09820    0   67          -  578.09820      -     -    1s
     0     0  578.09820    0   64          -  578.09820      -     -    1s
     0     0  578.09820    0   65          -  578.09820      -     -    1s
     0     0  578.09820    0   65          -  578.09820      -     -    1s
     0     0  578.09820    0   65          -  578.09820      -     -    1s
     0     0  458.22408    0   66          -  458.22408      -     -    1s
     0     0  433.31546    0   68          -  433.31546      -     -    1s
     0     0  428.45073    0   67          -  428.45073      -     -    1s
     0     0  428.37701    0   67          -  428.37701      -     -    1s
     0     0  356.61015    0   62          -  356.61015      -     -    1s
     0     0  336.70789    0   64          -  336.70789      -     -    1s
     0     0  331.47504    0   64          -  331.47504      -     -    1s
     0     0  330.84938    0   64          -  330.84938      -     -    1s
     0     0  330.38370    0   63          -  330.38370      -     -    1s
     0     0  330.36799    0   63          -  330.36799      -     -    1s
     0     0  278.02467    0   62          -  278.02467      -     -    1s
     0     0  272.13524    0   62          -  272.13524      -     -    1s
     0     0  271.70091    0   62          -  271.70091      -     -    1s
     0     0  271.66431    0   62          -  271.66431      -     -    1s
     0     0  218.14167    0   60          -  218.14167      -     -    1s
     0     0  215.91046    0   58          -  215.91046      -     -    1s
     0     0  214.81498    0   60          -  214.81498      -     -    1s
     0     0  214.63185    0   60          -  214.63185      -     -    1s
     0     0  188.11850    0   60          -  188.11850      -     -    1s
     0     0  187.34238    0   60          -  187.34238      -     -    1s
     0     0  187.32799    0   60          -  187.32799      -     -    1s
     0     0  171.44130    0   60          -  171.44130      -     -    1s
     0     0  155.78215    0   58          -  155.78215      -     -    1s
     0     0  154.54797    0   58          -  154.54797      -     -    1s
     0     0  154.37297    0   58          -  154.37297      -     -    1s
     0     0  127.18461    0   59          -  127.18461      -     -    1s
     0     0  125.10450    0   60          -  125.10450      -     -    1s
     0     0  124.41756    0   60          -  124.41756      -     -    1s
     0     0  124.35523    0   60          -  124.35523      -     -    2s
     0     0  121.16598    0   59          -  121.16598      -     -    2s
     0     0  119.62523    0   59          -  119.62523      -     -    2s
     0     0  118.96558    0   59          -  118.96558      -     -    2s
     0     0  118.70480    0   59          -  118.70480      -     -    2s
     0     0  115.23294    0   59          -  115.23294      -     -    2s
     0     0  114.91834    0   59          -  114.91834      -     -    2s
     0     0  107.96464    0   57          -  107.96464      -     -    2s
     0     0  106.88683    0   58          -  106.88683      -     -    2s
     0     0  106.79706    0   58          -  106.79706      -     -    2s
     0     0  106.28413    0   57          -  106.28413      -     -    2s
H    0     0                     -32.0168361  106.28413   432%     -    2s
     0     0  106.28413    0   57  -32.01684  106.28413   432%     -    2s
     0     2  106.28413    0   57  -32.01684  106.28413   432%     -    2s
* 1309   972              52     -19.4027437   50.06081   358%  34.5    3s
* 2770  1505              46     -18.8649190   42.14198   323%  33.4    3s
  3198  1575     cutoff   19       -18.86492   42.14198   323%  33.7    5s
H 3201  1575                     -18.5829811   42.14198   327%  33.6    5s
H 3212  1575                     -18.3899273   42.14198   329%  33.8    5s
H 3983  1697                     -17.9569656   31.15675   274%  34.3    6s
  7857  2478  -17.81861   17   35  -17.95697   12.03158   167%  32.4   10s
H12001  2784                     -17.9569656    4.33953   124%  31.7   15s
 12036  2809   -9.14260   20   48  -17.95697    1.14897   106%  31.8   20s

Explored 12040 nodes (390424 simplex iterations) in 21.19 seconds (33.91 work units)
Thread count was 32 (of 96 available processors)

Solution count 5: -17.957 -17.957 -18.8649 ... -32.0168

Optimization achieved user objective limit
Best objective -1.795696556921e+01, best bound -7.999636703701e+00, gap 55.4511%
No counter example exists in neighborhood.
Time elapsed for full adv. : 21.4201 sec

Saved to ./res/GRID/OBBT_-1/RESUME_|ARCH_2x50-EPOCHS_50-ID_10000|checkpoint_1.th.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, obbt=-1, pretrained_path='./saved_models/ARCH_2x50-EPOCHS_50-ID_10000/checkpoint_2.th', seed=0)

RESUME_|ARCH_2x50-EPOCHS_50-ID_10000|checkpoint_2.th
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x50-EPOCHS_50-ID_10000/checkpoint_2.th'
=> loaded pretrained arch 97.25, with accuracy '2x50'
Test: [49/79]	Loss 0.0004 (0.1333) ([0.000]+[0.000])	Prec@1 100.000 (96.672)
 * Prec@1 97.250
Model for sequential:
200 variables
110 constraints
100 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0             (1, 50)           50           50            0            0

relu_1               (1, 50)           50            0            0           50

linear_2             (1, 50)           50           50            0            0

relu_3               (1, 50)           50            0            0           50

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1679 rows, 1778 columns and 46230 nonzeros
Model fingerprint: 0xe6d0156a
Model has 100 general constraints
Variable types: 1778 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [2e-06, 2e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-04, 5e+00]
Presolve removed 1108 rows and 587 columns
Presolve time: 0.19s
Presolved: 571 rows, 1191 columns, 43596 nonzeros
Variable types: 1119 continuous, 72 integer (72 binary)

Root relaxation: objective 6.734397e+02, 438 iterations, 0.01 seconds (0.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  673.43974    0   51          -  673.43974      -     -    0s
     0     0  603.91260    0   53          -  603.91260      -     -    0s
     0     0  599.01723    0   53          -  599.01723      -     -    0s
     0     0  598.98291    0   53          -  598.98291      -     -    0s
     0     0  598.81469    0   53          -  598.81469      -     -    0s
     0     0  598.80446    0   53          -  598.80446      -     -    0s
     0     0  469.09821    0   53          -  469.09821      -     -    0s
     0     0  451.26534    0   57          -  451.26534      -     -    0s
     0     0  451.26534    0   58          -  451.26534      -     -    0s
     0     0  451.26534    0   60          -  451.26534      -     -    0s
     0     0  451.26534    0   60          -  451.26534      -     -    0s
     0     0  451.26534    0   55          -  451.26534      -     -    0s
     0     0  451.26534    0   56          -  451.26534      -     -    1s
     0     0  451.26534    0   57          -  451.26534      -     -    1s
     0     0  365.55090    0   52          -  365.55090      -     -    1s
     0     0  330.89241    0   53          -  330.89241      -     -    1s
     0     0  316.70969    0   52          -  316.70969      -     -    1s
     0     0  316.60538    0   52          -  316.60538      -     -    1s
     0     0  250.52582    0   52          -  250.52582      -     -    1s
     0     0  232.61347    0   54          -  232.61347      -     -    1s
     0     0  231.53393    0   54          -  231.53393      -     -    1s
     0     0  231.41674    0   54          -  231.41674      -     -    1s
     0     0  210.56282    0   52          -  210.56282      -     -    1s
     0     0  205.85443    0   51          -  205.85443      -     -    1s
     0     0  201.41556    0   52          -  201.41556      -     -    1s
     0     0  200.73499    0   52          -  200.73499      -     -    1s
     0     0  200.69149    0   52          -  200.69149      -     -    1s
     0     0  179.21538    0   50          -  179.21538      -     -    1s
     0     0  177.89520    0   50          -  177.89520      -     -    1s
     0     0  177.77619    0   50          -  177.77619      -     -    1s
     0     0  169.94140    0   49          -  169.94140      -     -    1s
     0     0  168.46102    0   50          -  168.46102      -     -    1s
     0     0  168.26392    0   49          -  168.26392      -     -    1s
     0     0  141.52038    0   51          -  141.52038      -     -    1s
     0     0  138.69108    0   51          -  138.69108      -     -    1s
     0     0  138.57594    0   51          -  138.57594      -     -    1s
     0     0  122.61897    0   51          -  122.61897      -     -    1s
     0     0  119.04574    0   51          -  119.04574      -     -    1s
     0     0  118.38705    0   51          -  118.38705      -     -    1s
     0     0  118.32714    0   51          -  118.32714      -     -    1s
     0     0  116.13428    0   51          -  116.13428      -     -    1s
     0     0  115.82141    0   51          -  115.82141      -     -    1s
     0     0  113.03828    0   51          -  113.03828      -     -    1s
H    0     0                     -27.3230923  113.03828   514%     -    1s
     0     0  113.03828    0   51  -27.32309  113.03828   514%     -    2s
     0     2  113.03828    0   51  -27.32309  113.03828   514%     -    2s
H   62    64                     -27.3230923   43.47589   259%   102    2s
H 1493   722                     -22.5434873   43.10464   291%  43.0    3s
* 1706   790              46     -22.5127081   42.22658   288%  42.7    3s
* 2211  1059              48     -21.9716207   37.69947   272%  40.7    3s
* 2237  1059              48     -15.0079407   37.69947   351%  40.6    3s
* 3182  1344              48     -14.4261479   15.35129   206%  38.6    3s
  4253  1737     cutoff   24       -14.42615   14.31523   199%  36.8    5s
H 4255  1737                     -14.1114433   14.31523   201%  36.8    5s
H 5106  1769                     -14.1114429   12.49544   189%  35.5    7s
* 5374  1844              42     -13.3258506    8.03811   160%  35.1    7s
* 5377  1844              42     -12.2233794    8.03811   166%  35.1    7s
* 5786  1685              46     -12.2055821    5.70189   147%  34.8    7s
* 8478  2160              42     -12.0535373    0.83805   107%  33.5    8s

Cutting planes:
  Gomory: 6
  Implied bound: 10
  MIR: 135
  Flow cover: 79
  Relax-and-lift: 5

Explored 9497 nodes (319409 simplex iterations) in 8.45 seconds (17.96 work units)
Thread count was 32 (of 96 available processors)

Solution count 10: -12.0535 -12.2056 -12.2234 ... -22.5127

Optimization achieved user objective limit
Best objective -1.205353729901e+01, best bound -2.606285970423e-01, gap 97.8377%
No counter example exists in neighborhood.
Time elapsed for full adv. : 8.5294 sec

Saved to ./res/GRID/OBBT_-1/RESUME_|ARCH_2x50-EPOCHS_50-ID_10000|checkpoint_2.th.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, obbt=-1, pretrained_path='./saved_models/ARCH_2x100-EPOCHS_50-ID_10000/checkpoint_0.th', seed=0)

RESUME_|ARCH_2x100-EPOCHS_50-ID_10000|checkpoint_0.th
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x100-EPOCHS_50-ID_10000/checkpoint_0.th'
=> loaded pretrained arch 97.96, with accuracy '2x100'
Test: [49/79]	Loss 0.0002 (0.1080) ([0.000]+[0.000])	Prec@1 100.000 (97.516)
 * Prec@1 97.960
Model for sequential:
400 variables
210 constraints
200 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0            (1, 100)          100          100            0            0

relu_1              (1, 100)          100            0            0          100

linear_2            (1, 100)          100          100            0            0

relu_3              (1, 100)          100            0            0          100

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1779 rows, 1978 columns and 93530 nonzeros
Model fingerprint: 0xcc57633d
Model has 200 general constraints
Variable types: 1978 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [8e-07, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-04, 5e+00]
Presolve removed 962 rows and 541 columns
Presolve time: 0.41s
Presolved: 817 rows, 1437 columns, 90761 nonzeros
Variable types: 1292 continuous, 145 integer (145 binary)

Root relaxation: objective 7.415100e+02, 733 iterations, 0.04 seconds (0.10 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  741.51002    0  100          -  741.51002      -     -    0s
     0     0  648.11542    0   89          -  648.11542      -     -    1s
     0     0  600.76186    0  103          -  600.76186      -     -    1s
     0     0  600.76186    0  103          -  600.76186      -     -    1s
     0     0  599.45947    0  100          -  599.45947      -     -    1s
     0     0  599.45947    0  102          -  599.45947      -     -    1s
     0     0  444.67182    0  108          -  444.67182      -     -    2s
     0     0  418.11878    0  110          -  418.11878      -     -    2s
     0     0  409.11202    0  111          -  409.11202      -     -    2s
     0     0  407.76780    0  111          -  407.76780      -     -    2s
     0     0  407.52953    0  111          -  407.52953      -     -    2s
     0     0  407.44547    0  111          -  407.44547      -     -    2s
     0     0  317.76531    0  109          -  317.76531      -     -    2s
     0     0  305.28429    0  109          -  305.28429      -     -    2s
     0     0  302.97320    0  109          -  302.97320      -     -    2s
     0     0  302.15055    0  110          -  302.15055      -     -    2s
     0     0  302.04027    0  109          -  302.04027      -     -    2s
     0     0  207.51263    0  103          -  207.51263      -     -    2s
     0     0  201.73370    0  103          -  201.73370      -     -    3s
     0     0  200.25103    0  105          -  200.25103      -     -    3s
     0     0  200.01470    0  105          -  200.01470      -     -    3s
     0     0  158.16743    0  106          -  158.16743      -     -    3s
     0     0  153.69918    0  106          -  153.69918      -     -    3s
     0     0  152.84380    0  106          -  152.84380      -     -    3s
     0     0  152.53982    0  108          -  152.53982      -     -    3s
     0     0  139.72012    0  107          -  139.72012      -     -    3s
     0     0  137.23614    0  107          -  137.23614      -     -    3s
     0     0  136.88101    0  107          -  136.88101      -     -    3s
     0     0   99.23508    0  108          -   99.23508      -     -    3s
     0     0   97.26734    0  110          -   97.26734      -     -    3s
     0     0   96.70013    0  110          -   96.70013      -     -    3s
     0     0   96.50510    0  110          -   96.50510      -     -    3s
     0     0   95.08052    0  110          -   95.08052      -     -    3s
H    0     0                     -28.5305193   95.08052   433%     -    4s
     0     2   95.08052    0  110  -28.53052   95.08052   433%     -    4s
    15    32   54.84311    4  102  -28.53052   74.43490   361%   237    5s
H  131   160                     -28.2508815   64.07368   327%   213    8s
H  132   160                     -27.9383820   64.07368   329%   212    8s
H  137   160                     -26.8122465   64.07368   339%   210    8s
H  156   160                     -26.1470143   64.07368   345%   203    8s
H 1189  1014                     -21.7574999   64.07368   394%   101   10s
H 1200  1014                     -21.2300014   64.07368   402%   101   10s
H 1219  1014                     -20.7499900   64.07368   409%   100   10s
H 1256  1014                     -20.1955980   64.07368   417%  99.1   10s
  2904  2003   48.81015    9  110  -20.19560   62.67163   410%  73.1   17s
  2915  2010   44.22361    8  110  -20.19560   62.67163   410%  72.8   20s
H 2930  1918                     -19.1199801   56.41551   395%  72.5   23s
  2935  1922  -16.11008   46  109  -19.11998   53.92412   382%  72.3   25s
  2943  1927   36.01920   12  108  -19.11998   52.25631   373%  72.1   30s
  2964  1943   10.26894   12   86  -19.11998   10.26894   154%  74.2   35s
H 2966  1846                     -18.4116696    9.73715   153%  74.1   36s
  2970  1850   -7.54486   24  110  -18.41167    9.73715   153%  75.2   40s

Explored 2971 nodes (230428 simplex iterations) in 40.38 seconds (54.32 work units)
Thread count was 32 (of 96 available processors)

Solution count 8: -18.4117 -19.12 -20.1956 ... -28.5305

Optimization achieved user objective limit
Best objective -1.841166964769e+01, best bound -6.707824418266e+00, gap 63.5675%
No counter example exists in neighborhood.
Time elapsed for full adv. : 40.4967 sec

Saved to ./res/GRID/OBBT_-1/RESUME_|ARCH_2x100-EPOCHS_50-ID_10000|checkpoint_0.th.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, obbt=-1, pretrained_path='./saved_models/ARCH_2x100-EPOCHS_50-ID_10000/checkpoint_1.th', seed=0)

RESUME_|ARCH_2x100-EPOCHS_50-ID_10000|checkpoint_1.th
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x100-EPOCHS_50-ID_10000/checkpoint_1.th'
=> loaded pretrained arch 97.76, with accuracy '2x100'
Test: [49/79]	Loss 0.0026 (0.1133) ([0.003]+[0.000])	Prec@1 100.000 (97.297)
 * Prec@1 97.760
Model for sequential:
400 variables
210 constraints
200 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0            (1, 100)          100          100            0            0

relu_1              (1, 100)          100            0            0          100

linear_2            (1, 100)          100          100            0            0

relu_3              (1, 100)          100            0            0          100

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1779 rows, 1978 columns and 93530 nonzeros
Model fingerprint: 0xe7a2198a
Model has 200 general constraints
Variable types: 1978 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [4e-07, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-03, 5e+00]
Presolve removed 950 rows and 529 columns
Presolve time: 0.44s
Presolved: 829 rows, 1449 columns, 90791 nonzeros
Variable types: 1298 continuous, 151 integer (151 binary)

Root relaxation: objective 8.297311e+02, 793 iterations, 0.05 seconds (0.11 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  829.73112    0  110          -  829.73112      -     -    0s
     0     0  775.86309    0  108          -  775.86309      -     -    1s
     0     0  759.59862    0  125          -  759.59862      -     -    1s
     0     0  748.24133    0  122          -  748.24133      -     -    1s
     0     0  748.14877    0  122          -  748.14877      -     -    1s
     0     0  670.03589    0  113          -  670.03589      -     -    3s
     0     0  670.03589    0  113          -  670.03589      -     -    3s
     0     0  670.03589    0  110          -  670.03589      -     -    3s
     0     0  654.34801    0  112          -  654.34801      -     -    3s
     0     0  651.42691    0  112          -  651.42691      -     -    3s
     0     0  650.21012    0  110          -  650.21012      -     -    3s
     0     0  650.09325    0  111          -  650.09325      -     -    3s
     0     0  650.06381    0  111          -  650.06381      -     -    3s
     0     0  426.79469    0  124          -  426.79469      -     -    3s
     0     0  384.82937    0  125          -  384.82937      -     -    3s
     0     0  367.55531    0  118          -  367.55531      -     -    3s
     0     0  364.46994    0  119          -  364.46994      -     -    3s
     0     0  364.11220    0  118          -  364.11220      -     -    3s
     0     0  364.11085    0  119          -  364.11085      -     -    3s
     0     0  308.60170    0  119          -  308.60170      -     -    4s
     0     0  298.90867    0  119          -  298.90867      -     -    4s
     0     0  297.75885    0  119          -  297.75885      -     -    4s
     0     0  297.50995    0  119          -  297.50995      -     -    4s
     0     0  264.43909    0  116          -  264.43909      -     -    4s
     0     0  256.12451    0  116          -  256.12451      -     -    4s
     0     0  254.10859    0  116          -  254.10859      -     -    4s
     0     0  254.08353    0  116          -  254.08353      -     -    4s
     0     0  229.92750    0  114          -  229.92750      -     -    4s
     0     0  226.64468    0  113          -  226.64468      -     -    4s
     0     0  226.48133    0  113          -  226.48133      -     -    4s
     0     0  201.79091    0  115          -  201.79091      -     -    4s
     0     0  199.64443    0  116          -  199.64443      -     -    4s
     0     0  199.14811    0  117          -  199.14811      -     -    5s
     0     0  178.47436    0  119          -  178.47436      -     -    5s
     0     0  176.08198    0  118          -  176.08198      -     -    5s
     0     0  175.68771    0  119          -  175.68771      -     -    5s
     0     0  163.52445    0  118          -  163.52445      -     -    5s
     0     0  161.59737    0  117          -  161.59737      -     -    5s
     0     0  161.38345    0  117          -  161.38345      -     -    5s
     0     0  137.92311    0  116          -  137.92311      -     -    5s
     0     0  135.83243    0  116          -  135.83243      -     -    5s
     0     0  135.52318    0  116          -  135.52318      -     -    5s
     0     0  106.96800    0  118          -  106.96800      -     -    5s
     0     0  105.91923    0  118          -  105.91923      -     -    5s
     0     0  105.80815    0  118          -  105.80815      -     -    5s
     0     0  103.43483    0  118          -  103.43483      -     -    6s
H    0     0                     -24.4591926  103.43483   523%     -    6s
     0     2  103.43483    0  118  -24.45919  103.43483   523%     -    6s
  3052  2299    9.63204   31  118  -24.45919   66.28075   371%  51.9   13s
  3055  2301  -17.36547   53  115  -24.45919   66.28075   371%  51.8   15s
  3082  2319   18.62988   17  116  -24.45919   62.77294   357%  51.4   20s
  3087  2322    8.70210   20  116  -24.45919   61.51604   352%  51.3   25s
  3102  2334   18.95321   13   92  -24.45919   18.95321   177%  52.8   30s
  3111  2341   17.47595   10  118  -24.45919   17.47595   171%  53.7   35s

Explored 3112 nodes (175074 simplex iterations) in 35.62 seconds (43.82 work units)
Thread count was 32 (of 96 available processors)

Solution count 1: -24.4592 

Optimization achieved user objective limit
Best objective -2.445919259090e+01, best bound -2.388296429525e+00, gap 90.2356%
No counter example exists in neighborhood.
Time elapsed for full adv. : 35.7246 sec

Saved to ./res/GRID/OBBT_-1/RESUME_|ARCH_2x100-EPOCHS_50-ID_10000|checkpoint_1.th.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, obbt=-1, pretrained_path='./saved_models/ARCH_2x100-EPOCHS_50-ID_10000/checkpoint_2.th', seed=0)

RESUME_|ARCH_2x100-EPOCHS_50-ID_10000|checkpoint_2.th
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x100-EPOCHS_50-ID_10000/checkpoint_2.th'
=> loaded pretrained arch 97.97, with accuracy '2x100'
Test: [49/79]	Loss 0.0083 (0.0981) ([0.008]+[0.000])	Prec@1 99.219 (97.531)
 * Prec@1 97.970
Model for sequential:
400 variables
210 constraints
200 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0            (1, 100)          100          100            0            0

relu_1              (1, 100)          100            0            0          100

linear_2            (1, 100)          100          100            0            0

relu_3              (1, 100)          100            0            0          100

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1779 rows, 1978 columns and 93530 nonzeros
Model fingerprint: 0x1cc19909
Model has 200 general constraints
Variable types: 1978 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e-06, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-03, 5e+00]
Presolve removed 952 rows and 531 columns
Presolve time: 0.37s
Presolved: 827 rows, 1447 columns, 90786 nonzeros
Variable types: 1297 continuous, 150 integer (150 binary)

Root relaxation: objective 8.279995e+02, 799 iterations, 0.05 seconds (0.12 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  827.99946    0  112          -  827.99946      -     -    0s
     0     0  752.24440    0  118          -  752.24440      -     -    1s
     0     0  731.14804    0  118          -  731.14804      -     -    1s
     0     0  721.40520    0  117          -  721.40520      -     -    1s
     0     0  721.28847    0  120          -  721.28847      -     -    1s
     0     0  721.28666    0  120          -  721.28666      -     -    1s
     0     0  607.57257    0  115          -  607.57257      -     -    2s
     0     0  596.16204    0  119          -  596.16204      -     -    2s
     0     0  591.75566    0  119          -  591.75566      -     -    2s
     0     0  591.10949    0  120          -  591.10949      -     -    2s
     0     0  591.09072    0  119          -  591.09072      -     -    2s
     0     0  411.15697    0  109          -  411.15697      -     -    3s
     0     0  383.35356    0  106          -  383.35356      -     -    3s
     0     0  377.48056    0  106          -  377.48056      -     -    3s
     0     0  376.53503    0  108          -  376.53503      -     -    3s
     0     0  376.49869    0  108          -  376.49869      -     -    3s
     0     0  310.36672    0  108          -  310.36672      -     -    3s
     0     0  302.42189    0  103          -  302.42189      -     -    3s
     0     0  295.36344    0  104          -  295.36344      -     -    3s
     0     0  294.70591    0  105          -  294.70591      -     -    3s
     0     0  294.67999    0  105          -  294.67999      -     -    3s
     0     0  240.33868    0  105          -  240.33868      -     -    3s
     0     0  237.32855    0  104          -  237.32855      -     -    3s
     0     0  236.38619    0  102          -  236.38619      -     -    3s
     0     0  236.13864    0  103          -  236.13864      -     -    3s
     0     0  226.63012    0  102          -  226.63012      -     -    4s
     0     0  224.69702    0  104          -  224.69702      -     -    4s
     0     0  224.54039    0  103          -  224.54039      -     -    4s
     0     0  209.06409    0  104          -  209.06409      -     -    4s
     0     0  206.66226    0  105          -  206.66226      -     -    4s
     0     0  206.49529    0  104          -  206.49529      -     -    4s
     0     0  196.83705    0  106          -  196.83705      -     -    4s
     0     0  194.82127    0  107          -  194.82127      -     -    4s
     0     0  194.29919    0  107          -  194.29919      -     -    4s
     0     0  194.26985    0  107          -  194.26985      -     -    4s
     0     0  169.20273    0  107          -  169.20273      -     -    4s
     0     0  166.41612    0  105          -  166.41612      -     -    4s
     0     0  165.60022    0  107          -  165.60022      -     -    4s
     0     0  165.43407    0  107          -  165.43407      -     -    4s
     0     0  157.14628    0  107          -  157.14628      -     -    5s
     0     0  155.26456    0  107          -  155.26456      -     -    5s
     0     0  155.00508    0  108          -  155.00508      -     -    5s
     0     0  148.17593    0  105          -  148.17593      -     -    5s
     0     0  145.53820    0  108          -  145.53820      -     -    5s
     0     0  143.79936    0  107          -  143.79936      -     -    5s
     0     0  142.73112    0  107          -  142.73112      -     -    5s
     0     0  142.57954    0  107          -  142.57954      -     -    5s
     0     0  133.81423    0  110          -  133.81423      -     -    5s
     0     0  132.46442    0  110          -  132.46442      -     -    5s
     0     0  131.84303    0  109          -  131.84303      -     -    5s
     0     0  131.63462    0  109          -  131.63462      -     -    5s
     0     0  114.79946    0  110          -  114.79946      -     -    6s
     0     0  112.34394    0  109          -  112.34394      -     -    6s
     0     0  111.78916    0  110          -  111.78916      -     -    6s
     0     0  105.01272    0  108          -  105.01272      -     -    6s
     0     0  104.76965    0  109          -  104.76965      -     -    6s
     0     0  103.11905    0  109          -  103.11905      -     -    6s
H    0     0                     -26.8021909  103.11905   485%     -    6s
     0     0  102.08168    0  106  -26.80219  102.08168   481%     -    6s
     0     2  102.08168    0  106  -26.80219  102.08168   481%     -    7s
H   36    64                     -26.8021909   75.89636   383%   166    7s
  1598  1380  -15.96822   36   59  -26.80219   72.54795   371%  64.9   10s
  2959  2236   -9.20650   28   95  -26.80219   71.55742   367%  52.5   15s
  2977  2248   41.41481    6  108  -26.80219   65.23718   343%  52.2   20s
  2990  2257    6.64055   11  108  -26.80219   60.22799   325%  52.0   26s
  3000  2265   -2.26386   29   84  -26.80219   15.30411   157%  53.8   30s
  3016  2276   -5.09649   27   89  -26.80219    3.02512   111%  53.6   38s

Explored 3019 nodes (175301 simplex iterations) in 39.37 seconds (49.66 work units)
Thread count was 32 (of 96 available processors)

Solution count 1: -26.8022 

Optimization achieved user objective limit
Best objective -2.680219085625e+01, best bound -2.514479793369e+00, gap 90.6184%
No counter example exists in neighborhood.
Time elapsed for full adv. : 39.4759 sec

Saved to ./res/GRID/OBBT_-1/RESUME_|ARCH_2x100-EPOCHS_50-ID_10000|checkpoint_2.th.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, obbt=-1, pretrained_path='./saved_models/ARCH_2x200-EPOCHS_50-ID_10000/checkpoint_0.th', seed=0)

RESUME_|ARCH_2x200-EPOCHS_50-ID_10000|checkpoint_0.th
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x200-EPOCHS_50-ID_10000/checkpoint_0.th'
=> loaded pretrained arch 98.14, with accuracy '2x200'
Test: [49/79]	Loss 0.0004 (0.0901) ([0.000]+[0.000])	Prec@1 100.000 (97.750)
 * Prec@1 98.140
Model for sequential:
800 variables
410 constraints
400 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0            (1, 200)          200          200            0            0

relu_1              (1, 200)          200            0            0          200

linear_2            (1, 200)          200          200            0            0

relu_3              (1, 200)          200            0            0          200

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1979 rows, 2378 columns and 203130 nonzeros
Model fingerprint: 0x8a79249e
Model has 400 general constraints
Variable types: 2378 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e-08, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [4e-05, 5e+00]
Presolve removed 646 rows and 425 columns
Presolve time: 0.35s
Presolved: 1333 rows, 1953 columns, 200150 nonzeros
Variable types: 1650 continuous, 303 integer (303 binary)

Root relaxation: objective 9.625930e+02, 1583 iterations, 0.20 seconds (0.52 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  962.59303    0  211          -  962.59303      -     -    0s
     0     0  933.08039    0  238          -  933.08039      -     -    2s
     0     0  904.43073    0  231          -  904.43073      -     -    2s
     0     0  869.74116    0  198          -  869.74116      -     -    2s
     0     0  850.88863    0  220          -  850.88863      -     -    2s
     0     0  847.09504    0  220          -  847.09504      -     -    3s
     0     0  845.45885    0  223          -  845.45885      -     -    3s
     0     0  845.45803    0  223          -  845.45803      -     -    3s
     0     0  771.65277    0  213          -  771.65277      -     -    4s
     0     0  735.46145    0  213          -  735.46145      -     -    4s
     0     0  706.22635    0  208          -  706.22635      -     -    4s
     0     0  676.59208    0  216          -  676.59208      -     -    4s
     0     0  661.82429    0  217          -  661.82429      -     -    4s
     0     0  649.44071    0  217          -  649.44071      -     -    4s
     0     0  644.15622    0  221          -  644.15622      -     -    4s
     0     0  639.19919    0  222          -  639.19919      -     -    4s
     0     0  632.57370    0  221          -  632.57370      -     -    4s
     0     0  631.67587    0  220          -  631.67587      -     -    4s
     0     0  631.61331    0  222          -  631.61331      -     -    5s
     0     0  534.50416    0  217          -  534.50416      -     -    5s
     0     0  506.23700    0  221          -  506.23700      -     -    5s
     0     0  499.30351    0  222          -  499.30351      -     -    5s
     0     0  496.67579    0  222          -  496.67579      -     -    5s
     0     0  495.82466    0  222          -  495.82466      -     -    5s
     0     0  495.55521    0  222          -  495.55521      -     -    5s
     0     0  405.07765    0  223          -  405.07765      -     -    6s
     0     0  394.77163    0  227          -  394.77163      -     -    6s
     0     0  387.93570    0  225          -  387.93570      -     -    6s
     0     0  386.43312    0  223          -  386.43312      -     -    6s
     0     0  385.33795    0  226          -  385.33795      -     -    6s
     0     0  384.90169    0  226          -  384.90169      -     -    6s
     0     0  358.13876    0  229          -  358.13876      -     -    6s
     0     0  356.71979    0  226          -  356.71979      -     -    6s
     0     0  356.20623    0  228          -  356.20623      -     -    6s
     0     0  349.00828    0  227          -  349.00828      -     -    7s
     0     0  346.21679    0  226          -  346.21679      -     -    7s
     0     0  345.16216    0  226          -  345.16216      -     -    7s
     0     0  344.54923    0  225          -  344.54923      -     -    7s
     0     0  344.31769    0  226          -  344.31769      -     -    7s
     0     0  341.00410    0  225          -  341.00410      -     -    7s
     0     0  339.30616    0  227          -  339.30616      -     -    7s
     0     0  338.84652    0  227          -  338.84652      -     -    8s
     0     0  334.82947    0  228          -  334.82947      -     -    8s
     0     0  333.83955    0  231          -  333.83955      -     -    8s
     0     0  333.50043    0  230          -  333.50043      -     -    8s
     0     0  332.43724    0  228          -  332.43724      -     -    8s
H    0     0                     -30.3012264  332.43724  1197%     -    9s
     0     0  332.43724    0  228  -30.30123  332.43724  1197%     -    9s
     0     2  332.43724    0  228  -30.30123  332.43724  1197%     -   10s
H   32    64                     -30.3012264  291.75625  1063%   303   12s
    63    96  265.35177    6  221  -30.30123  281.46644  1029%   326   15s
  1114  1220  186.75544   16  207  -30.30123  280.26884  1025%   168   20s
  3956  3812   85.48730   39  180  -30.30123  280.26884  1025%   102   25s
  4443  3978   18.81647   63  228  -30.30123  280.26884  1025%  99.3   42s
  4446  3980  236.75523   11  222  -30.30123  280.26884  1025%  99.2   45s
  4462  3991   50.29299   55  251  -30.30123  271.90316   997%  98.9   50s
  4479  4002  165.61528   20  255  -30.30123  236.23193   880%  98.5   55s
  4489  4009  112.56645   29  259  -30.30123  229.15098   856%  98.3   63s
  4491  4013  223.40430   12  246  -30.30123  227.87924   852%   101   66s
  4617  4127  174.33757   18  241  -30.30123  200.45519   762%   111   71s
H 4622  3923                     -30.2630649  200.45519   762%   111   71s
H 4624  3732                     -30.0298879  200.45519   768%   111   71s
H 4636  3546                     -29.9320193  200.45519   770%   112   71s
H 4640  3372                     -29.6751888  200.45519   775%   112   71s
  5001  3651  147.01376   23  233  -29.67519  200.45519   775%   120   75s
  5548  4057  115.62020   29  221  -29.67519  200.45519   775%   126   80s
H 5685  3927                     -26.3965412  200.45519   859%   126   83s
H 5696  3767                     -25.7075564  200.45519   880%   127   83s
  5921  3939   96.73179   33  217  -25.70756  200.45519   880%   126   85s
  6848  4293   82.02407   39  210  -25.70756  200.45519   880%   131   90s
H 6858  4142                     -25.1764567  200.45519   896%   131   90s
H 6909  3985                     -24.7673246  200.45519   909%   131   90s
H 6912  3846                     -24.2727758  200.45519   926%   131   90s
H 6933  3711                     -23.8664097  200.45519   940%   131   90s
  6955  3735   78.92671   40  209  -23.86641  200.45519   940%   131   99s
H 6978  3607                     -23.8664094  200.45519   940%   132   99s
  6988  3670   72.46445   40  209  -23.86641  200.45519   940%   132  100s
  7573  3968   65.04438   44  202  -23.86641  200.45519   940%   133  110s
H 7583  3827                     -20.7222261  200.45519  1067%   133  110s
H 8912  4278                     -20.7222260  200.45519  1067%   132  129s
H 8914  4174                     -20.7222255  200.45519  1067%   132  129s
H 8936  4068                     -20.7222253  200.45519  1067%   133  129s
  8954  4342   40.68095   51  192  -20.72223  200.45519  1067%   133  130s
  9968  4696   21.36657   56  184  -20.72223  200.45519  1067%   133  135s
 11687  6520   10.87603   66  174  -20.72223  200.45519  1067%   134  140s
 13222  7859  -10.71774   74  161  -20.72223  200.45519  1067%   132  145s
 15222  9559  -16.45858   89  150  -20.72223  199.70635  1064%   134  151s
 17226 11510    5.22540   71  167  -20.72223  192.38335  1028%   132  156s
 18865 12591   92.02690   34  206  -20.72223  188.57615  1010%   130  160s
 21672 15063  -19.04779   83  138  -20.72223  182.34581   980%   126  166s
H22725 15090                     -20.7222253  174.06901   940%   125  177s
H22737 15090                     -20.7222251  174.06901   940%   125  177s
H22758 15090                     -20.7222250  174.06901   940%   125  177s
 23816 16190  157.24134   20  241  -20.72223  173.71487   938%   123  180s

Cutting planes:
  Gomory: 150
  Implied bound: 24
  MIR: 574
  Flow cover: 619
  Relax-and-lift: 43

Explored 24116 nodes (2976840 simplex iterations) in 180.06 seconds (500.88 work units)
Thread count was 32 (of 96 available processors)

Solution count 7: -20.7222 -23.8664 -24.7673 ... -30.3012

Time limit reached
Best objective -2.072222500180e+01, best bound 1.737148729761e+02, gap 938.3022%
No counter example exists in neighborhood.
Time elapsed for full adv. : 180.1572 sec

Saved to ./res/GRID/OBBT_-1/RESUME_|ARCH_2x200-EPOCHS_50-ID_10000|checkpoint_0.th.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, obbt=-1, pretrained_path='./saved_models/ARCH_2x200-EPOCHS_50-ID_10000/checkpoint_1.th', seed=0)

RESUME_|ARCH_2x200-EPOCHS_50-ID_10000|checkpoint_1.th
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x200-EPOCHS_50-ID_10000/checkpoint_1.th'
=> loaded pretrained arch 98.04, with accuracy '2x200'
Test: [49/79]	Loss 0.0000 (0.0958) ([0.000]+[0.000])	Prec@1 100.000 (97.578)
 * Prec@1 98.040
Model for sequential:
800 variables
410 constraints
400 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0            (1, 200)          200          200            0            0

relu_1              (1, 200)          200            0            0          200

linear_2            (1, 200)          200          200            0            0

relu_3              (1, 200)          200            0            0          200

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1979 rows, 2378 columns and 203130 nonzeros
Model fingerprint: 0x78abbd19
Model has 400 general constraints
Variable types: 2378 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [5e-07, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-05, 5e+00]
Presolve removed 644 rows and 423 columns
Presolve time: 0.37s
Presolved: 1335 rows, 1955 columns, 200156 nonzeros
Variable types: 1651 continuous, 304 integer (304 binary)

Root relaxation: objective 9.959311e+02, 1708 iterations, 0.19 seconds (0.51 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  995.93113    0  207          -  995.93113      -     -    0s
     0     0  949.92954    0  203          -  949.92954      -     -    2s
     0     0  924.90369    0  203          -  924.90369      -     -    2s
     0     0  903.98878    0  199          -  903.98878      -     -    2s
     0     0  899.00828    0  230          -  899.00828      -     -    2s
     0     0  897.55123    0  224          -  897.55123      -     -    2s
     0     0  886.06142    0  223          -  886.06142      -     -    2s
     0     0  883.56807    0  231          -  883.56807      -     -    3s
     0     0  881.95243    0  224          -  881.95243      -     -    3s
     0     0  841.45272    0  213          -  841.45272      -     -    4s
     0     0  802.98221    0  196          -  802.98221      -     -    4s
     0     0  790.31572    0  204          -  790.31572      -     -    4s
     0     0  776.23160    0  218          -  776.23160      -     -    4s
     0     0  769.18858    0  228          -  769.18858      -     -    4s
     0     0  712.03144    0  227          -  712.03144      -     -    4s
     0     0  702.73016    0  214          -  702.73016      -     -    4s
     0     0  695.54732    0  221          -  695.54732      -     -    4s
     0     0  692.25661    0  223          -  692.25661      -     -    5s
     0     0  690.48296    0  224          -  690.48296      -     -    5s
     0     0  688.75895    0  226          -  688.75895      -     -    5s
     0     0  688.24861    0  226          -  688.24861      -     -    5s
     0     0  688.18928    0  227          -  688.18928      -     -    5s
     0     0  580.03259    0  220          -  580.03259      -     -    5s
     0     0  545.44055    0  223          -  545.44055      -     -    5s
     0     0  540.49796    0  227          -  540.49796      -     -    5s
     0     0  537.31722    0  227          -  537.31722      -     -    5s
     0     0  536.50382    0  226          -  536.50382      -     -    5s
     0     0  536.17130    0  228          -  536.17130      -     -    5s
     0     0  536.15759    0  228          -  536.15759      -     -    5s
     0     0  489.44448    0  224          -  489.44448      -     -    6s
     0     0  466.86682    0  224          -  466.86682      -     -    6s
     0     0  460.98577    0  224          -  460.98577      -     -    6s
     0     0  460.11044    0  224          -  460.11044      -     -    6s
     0     0  459.06135    0  226          -  459.06135      -     -    6s
     0     0  458.84667    0  226          -  458.84667      -     -    6s
     0     0  434.41954    0  228          -  434.41954      -     -    7s
     0     0  430.96689    0  226          -  430.96689      -     -    7s
     0     0  425.20019    0  226          -  425.20019      -     -    7s
     0     0  424.28374    0  225          -  424.28374      -     -    7s
     0     0  423.77850    0  225          -  423.77850      -     -    7s
     0     0  410.80909    0  226          -  410.80909      -     -    7s
     0     0  407.56719    0  227          -  407.56719      -     -    7s
     0     0  405.77549    0  229          -  405.77549      -     -    7s
     0     0  405.10761    0  229          -  405.10761      -     -    7s
     0     0  404.70439    0  228          -  404.70439      -     -    7s
     0     0  397.58060    0  227          -  397.58060      -     -    8s
     0     0  396.31532    0  230          -  396.31532      -     -    8s
     0     0  396.10370    0  230          -  396.10370      -     -    8s
     0     0  392.40539    0  229          -  392.40539      -     -    8s
H    0     0                     -28.4144921  392.40539  1481%     -    9s
     0     0  392.40539    0  229  -28.41449  392.40539  1481%     -    9s
H    0     0                     -28.4144921  392.40539  1481%     -   10s
     0     2  392.40539    0  229  -28.41449  392.40539  1481%     -   11s
   127   160  287.40645    7  217  -28.41449  320.59143  1228%   242   15s
H  128   160                     -28.3626176  320.59143  1230%   240   15s
H  132   160                     -28.2544894  320.59143  1235%   236   15s
H  144   160                     -28.1639684  320.59143  1238%   228   15s
H 1164  1193                     -21.7909760  320.59143  1571%   135   20s
  2858  2832   71.09920   42  171  -21.79098  320.59143  1571%   111   25s
  3477  3274   48.02323   48  157  -21.79098  320.59143  1571%   106   35s
H 3478  3274                     -21.7909756  320.59143  1571%   106   35s
H 3483  3274                     -21.7909705  320.59143  1571%   106   35s
  4354  4007  134.67125   29  229  -21.79097  320.59143  1571%   101   58s
  4356  4008    6.18327   66  200  -21.79097  320.59143  1571%   101   60s
  4372  4019  176.62219   21  229  -21.79097  320.59143  1571%   101   65s
  4386  4028  149.58499   25  233  -21.79097  315.96234  1550%   100   70s
  4395  4034    7.59985   53  230  -21.79097  305.86107  1504%   100   75s
  4401  4038  117.06977   32  234  -21.79097  243.86465  1219%   100   80s
  4411  4045   79.66402   44  238  -21.79097  233.05302  1169%   100   85s
  4417  4049  162.39594   22  239  -21.79097  228.96667  1151%   100   90s
  4481  4125  161.44475   21  224  -21.79097  183.42105   942%   107   95s
H 4514  3942                     -21.4155902  183.42105   956%   109   97s
  4786  4117  133.66704   25  217  -21.41559  183.42105   956%   117  100s
  5322  4344   96.43270   32  204  -21.41559  183.42105   956%   126  105s
H 5589  4258                     -17.6971990  183.42105  1136%   130  111s
H 5591  4074                     -16.9150362  183.42105  1184%   130  111s
  6151  4470     cutoff   39       -16.91504  183.42105  1184%   133  115s
H 6448  4272                     -16.9150356  183.42105  1184%   133  133s
H 6450  4106                     -16.9150347  183.42105  1184%   133  133s
H 6463  3944                     -16.5434068  183.42105  1209%   133  133s
H 6479  3789                     -15.7732815  183.42105  1263%   134  133s
  6605  3992 infeasible   43       -15.77328  183.42105  1263%   134  135s
  6822  3950   53.98172   45  185  -15.77328  183.42105  1263%   135  148s
H 6831  3805                     -12.9627210  183.42105  1515%   135  148s
  7108  4039 infeasible   48       -12.96272  183.42105  1515%   135  150s
  8534  4877  119.11745   29  210  -12.96272  177.36541  1468%   138  155s
 10007  5575     cutoff   43       -12.96272  177.36541  1468%   136  160s
 11530  5884   38.87345   54  174  -12.96272  177.36541  1468%   132  180s
H11532  5748                     -12.9627210  177.36541  1468%   132  180s
H11541  5617                     -12.9627162  177.36541  1468%   132  180s

Cutting planes:
  Gomory: 37
  Cover: 1
  Implied bound: 21
  MIR: 585
  Flow cover: 630
  Inf proof: 1
  Relax-and-lift: 13

Explored 11566 nodes (1536242 simplex iterations) in 180.09 seconds (406.98 work units)
Thread count was 32 (of 96 available processors)

Solution count 10: -12.9627 -15.7733 -16.5434 ... -28.3626

Time limit reached
Best objective -1.296271620174e+01, best bound 1.773654061175e+02, gap 1468.2735%
No counter example exists in neighborhood.
Time elapsed for full adv. : 180.1932 sec

Saved to ./res/GRID/OBBT_-1/RESUME_|ARCH_2x200-EPOCHS_50-ID_10000|checkpoint_1.th.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, obbt=-1, pretrained_path='./saved_models/ARCH_2x200-EPOCHS_50-ID_10000/checkpoint_2.th', seed=0)

RESUME_|ARCH_2x200-EPOCHS_50-ID_10000|checkpoint_2.th
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x200-EPOCHS_50-ID_10000/checkpoint_2.th'
=> loaded pretrained arch 97.95, with accuracy '2x200'
Test: [49/79]	Loss 0.0002 (0.0949) ([0.000]+[0.000])	Prec@1 100.000 (97.484)
 * Prec@1 97.950
Model for sequential:
800 variables
410 constraints
400 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0            (1, 200)          200          200            0            0

relu_1              (1, 200)          200            0            0          200

linear_2            (1, 200)          200          200            0            0

relu_3              (1, 200)          200            0            0          200

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1979 rows, 2378 columns and 203130 nonzeros
Model fingerprint: 0x2a80e5d7
Model has 400 general constraints
Variable types: 2378 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [5e-07, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [5e-05, 5e+00]
Presolve removed 650 rows and 429 columns
Presolve time: 0.35s
Presolved: 1329 rows, 1949 columns, 200141 nonzeros
Variable types: 1648 continuous, 301 integer (301 binary)

Root relaxation: objective 1.007644e+03, 1768 iterations, 0.26 seconds (0.66 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 1007.64430    0  211          - 1007.64430      -     -    0s
     0     0  976.37110    0  251          -  976.37110      -     -    2s
     0     0  935.66015    0  240          -  935.66015      -     -    2s
     0     0  913.02191    0  233          -  913.02191      -     -    2s
     0     0  888.82671    0  225          -  888.82671      -     -    2s
     0     0  874.35696    0  223          -  874.35696      -     -    2s
     0     0  858.80067    0  222          -  858.80067      -     -    3s
     0     0  853.81431    0  216          -  853.81431      -     -    3s
     0     0  849.67955    0  235          -  849.67955      -     -    3s
     0     0  847.40491    0  237          -  847.40491      -     -    3s
     0     0  847.36544    0  229          -  847.36544      -     -    3s
     0     0  847.21102    0  228          -  847.21102      -     -    3s
     0     0  847.10606    0  229          -  847.10606      -     -    3s
     0     0  785.72878    0  225          -  785.72878      -     -    4s
     0     0  759.20693    0  223          -  759.20693      -     -    4s
     0     0  743.37019    0  225          -  743.37019      -     -    4s
     0     0  724.04703    0  228          -  724.04703      -     -    4s
     0     0  703.88788    0  232          -  703.88788      -     -    4s
     0     0  691.42862    0  237          -  691.42862      -     -    4s
     0     0  690.12952    0  236          -  690.12952      -     -    4s
     0     0  687.37707    0  240          -  687.37707      -     -    4s
     0     0  686.23951    0  239          -  686.23951      -     -    5s
     0     0  686.09567    0  238          -  686.09567      -     -    5s
     0     0  686.06752    0  239          -  686.06752      -     -    5s
     0     0  594.83971    0  232          -  594.83971      -     -    5s
     0     0  584.09253    0  233          -  584.09253      -     -    5s
     0     0  580.21657    0  232          -  580.21657      -     -    5s
     0     0  579.60035    0  232          -  579.60035      -     -    5s
     0     0  579.18620    0  232          -  579.18620      -     -    5s
     0     0  579.11356    0  232          -  579.11356      -     -    5s
     0     0  430.88660    0  228          -  430.88660      -     -    6s
     0     0  413.73453    0  236          -  413.73453      -     -    6s
     0     0  405.63194    0  236          -  405.63194      -     -    6s
     0     0  402.26722    0  241          -  402.26722      -     -    6s
     0     0  401.63871    0  240          -  401.63871      -     -    6s
     0     0  401.31374    0  242          -  401.31374      -     -    6s
     0     0  358.18349    0  243          -  358.18349      -     -    6s
     0     0  353.93017    0  244          -  353.93017      -     -    7s
     0     0  352.60853    0  245          -  352.60853      -     -    7s
     0     0  352.27986    0  246          -  352.27986      -     -    7s
     0     0  342.28892    0  233          -  342.28892      -     -    7s
     0     0  340.37183    0  236          -  340.37183      -     -    7s
     0     0  338.65244    0  235          -  338.65244      -     -    7s
     0     0  338.17833    0  233          -  338.17833      -     -    7s
     0     0  335.71956    0  235          -  335.71956      -     -    8s
H    0     0                     -28.4422177  335.71956  1280%     -    8s
     0     0  335.01381    0  231  -28.44222  335.01381  1278%     -    8s
     0     2  335.01381    0  231  -28.44222  335.01381  1278%     -    9s
     7    16  296.45085    3  230  -28.44222  310.28083  1191%   178   10s
H   31    64                     -28.4422177  284.39053  1100%   283   12s
H   44    64                     -28.4422173  284.39053  1100%   272   12s
H   56    64                     -28.4422172  276.10007  1071%   262   12s
H   59    64                     -28.4422170  274.64491  1066%   259   12s
   191   224  238.19478    9  221  -28.44222  274.64491  1066%   214   15s
  1424  1396  139.00973   21  202  -28.44222  274.64491  1066%   136   20s
  3175  2849   74.61240   36  178  -28.44222  274.64491  1066%   112   33s
  3350  3126   65.91742   38  173  -28.44222  274.64491  1066%   110   35s
H 3579  3126                     -28.4422167  274.64491  1066%   109   54s
  3580  3127   93.76213   27  231  -28.44222  274.64491  1066%   109   56s
  3588  3132   -1.18637   58  221  -28.44222  274.64491  1066%   109   60s
  3607  3145  131.40384   24  236  -28.44222  226.99232   898%   109   65s
  3621  3154  210.43420   10  249  -28.44222  211.43166   843%   108   70s
  3627  3158  -20.62653   96  239  -28.44222  198.97757   800%   108   75s
  3638  3166  177.84360   14  255  -28.44222  177.84360   725%   108   80s
  3643  3172  168.28737   13  244  -28.44222  176.21420   720%   111   85s
  3737  3265  131.53372   18  230  -28.44222  147.11356   617%   121   90s
H 3740  3104                     -28.2268636  147.11356   621%   122   90s
H 3745  2951                     -27.4888005  144.03974   624%   122   90s
  4248  3247   78.11356   24  214  -27.48880  144.03974   624%   131   95s
  4873  3515   77.81752   29  220  -27.48880  144.03974   624%   136  100s
H 4875  3370                     -24.5337409  144.03974   687%   136  100s
H 4876  3233                     -22.7170289  144.03974   734%   136  100s
H 4952  3078                     -22.5202575  144.03974   740%   136  100s
  5333  3373   64.48559   32  208  -22.52026  144.03974   740%   137  108s
H 5341  3247                     -22.5202565  144.03974   740%   138  108s
  5744  3424   58.69343   34  209  -22.52026  144.03974   740%   136  110s
H 6417  3470                     -20.2505268  144.03974   811%   136  114s
H 6424  3339                     -18.8759252  144.03974   863%   136  114s
  6469  3492   43.83326   39  191  -18.87593  144.03974   863%   136  115s
  7799  4035   24.65663   47  182  -18.87593  144.03974   863%   134  120s
  9556  4558    0.56529   60  165  -18.87593  144.03974   863%   134  137s
H 9557  4452                     -18.8759250  144.03974   863%   134  137s
H 9558  4430                     -18.5537076  144.03974   876%   134  137s
H 9562  4414                     -17.4337795  144.03974   926%   134  137s
H 9565  4414                     -17.4200779  144.03974   927%   134  137s
  9840  4784     cutoff   63       -17.42008  144.03974   927%   134  140s
H10147  4831                     -17.4200779  144.03974   927%   134  148s
H10148  4831                     -17.4200779  144.03974   927%   134  148s
 10656  5416     cutoff   71       -17.42008  142.93975   921%   133  151s
H11568  5823                     -16.7811058  142.93975   952%   133  160s
H11576  5823                     -16.7658311  142.93975   953%   133  160s
H11579  5823                     -16.7402298  142.93975   954%   133  160s
H11598  5816                     -16.5427848  142.93975   964%   133  160s
 12701  6853   23.62234   46  180  -16.54278  142.93975   964%   131  165s
 15128  8556   75.03245   29  215  -16.54278  142.63050   962%   128  171s
 15706  8930   59.78071   35  197  -16.54278  142.63050   962%   127  177s
H15759  8930                     -16.5427843  142.63050   962%   127  178s
 17235  9679    9.62116   61  162  -16.54278  142.63050   962%   124  180s

Cutting planes:
  Gomory: 73
  Cover: 2
  Implied bound: 21
  MIR: 704
  Flow cover: 694
  Inf proof: 2
  Relax-and-lift: 41

Explored 17449 nodes (2163561 simplex iterations) in 180.06 seconds (448.74 work units)
Thread count was 32 (of 96 available processors)

Solution count 10: -16.5428 -16.7402 -16.7658 ... -28.2269

Time limit reached
Best objective -1.654278426081e+01, best bound 1.426305045103e+02, gap 962.1916%
No counter example exists in neighborhood.
Time elapsed for full adv. : 180.1571 sec

Saved to ./res/GRID/OBBT_-1/RESUME_|ARCH_2x200-EPOCHS_50-ID_10000|checkpoint_2.th.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, obbt=-1, pretrained_path='./saved_models/ARCH_6x100-EPOCHS_50-ID_10000/checkpoint_0.th', seed=0)

RESUME_|ARCH_6x100-EPOCHS_50-ID_10000|checkpoint_0.th
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_6x100-EPOCHS_50-ID_10000/checkpoint_0.th'
=> loaded pretrained arch 97.6, with accuracy '6x100'
Test: [49/79]	Loss 0.0025 (0.2426) ([0.003]+[0.000])	Prec@1 100.000 (97.156)
 * Prec@1 97.600
Model for sequential:
1200 variables
610 constraints
600 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0            (1, 100)          100          100            0            0

relu_1              (1, 100)          100            0            0          100

linear_2            (1, 100)          100          100            0            0

relu_3              (1, 100)          100            0            0          100

linear_4            (1, 100)          100          100            0            0

relu_5              (1, 100)          100            0            0          100

linear_6            (1, 100)          100          100            0            0

relu_7              (1, 100)          100            0            0          100

linear_8            (1, 100)          100          100            0            0

relu_9              (1, 100)          100            0            0          100

linear_10           (1, 100)          100          100            0            0

relu_11             (1, 100)          100            0            0          100

linear_12            (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 2179 rows, 2778 columns and 133930 nonzeros
Model fingerprint: 0x1e59dddd
Model has 600 general constraints
Variable types: 2778 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e-07, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [5e-05, 5e+00]
Presolve added 181 rows and 202 columns
Presolve time: 0.58s
Presolved: 2360 rows, 2980 columns, 133852 nonzeros
Variable types: 2097 continuous, 883 integer (883 binary)

Root relaxation: objective 4.218465e+04, 12570 iterations, 2.33 seconds (4.49 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 42184.6457    0  566          - 42184.6457      -     -    3s
     0     0 42024.9076    0  574          - 42024.9076      -     -    5s
     0     0 40580.7061    0  619          - 40580.7061      -     -    6s
     0     0 40046.7436    0  623          - 40046.7436      -     -    6s
     0     0 40046.2681    0  620          - 40046.2681      -     -    6s
     0     0 40046.2165    0  619          - 40046.2165      -     -    6s
     0     0 40046.1725    0  618          - 40046.1725      -     -    6s
     0     0 40046.1664    0  619          - 40046.1664      -     -    6s
     0     0 39962.8169    0  631          - 39962.8169      -     -    8s
     0     0 39889.1219    0  640          - 39889.1219      -     -    9s
     0     0 39839.5179    0  653          - 39839.5179      -     -   10s
     0     0 39838.8187    0  652          - 39838.8187      -     -   10s
     0     0 39787.0263    0  660          - 39787.0263      -     -   11s
     0     0 39726.7458    0  671          - 39726.7458      -     -   11s
     0     0 39630.9669    0  680          - 39630.9669      -     -   11s
     0     0 39543.9333    0  683          - 39543.9333      -     -   12s
     0     0 39167.9529    0  681          - 39167.9529      -     -   12s
     0     0 39166.9256    0  683          - 39166.9256      -     -   12s
     0     0 39166.8521    0  685          - 39166.8521      -     -   12s
     0     0 39137.3928    0  695          - 39137.3928      -     -   14s
     0     0 39110.7826    0  690          - 39110.7826      -     -   14s
     0     0 39105.8556    0  695          - 39105.8556      -     -   14s
     0     0 39102.2696    0  691          - 39102.2696      -     -   14s
     0     0 39100.3623    0  696          - 39100.3623      -     -   14s
     0     0 39077.8159    0  692          - 39077.8159      -     -   16s
     0     0 39043.9121    0  707          - 39043.9121      -     -   16s
     0     0 39037.5905    0  702          - 39037.5905      -     -   16s
     0     0 39034.7149    0  711          - 39034.7149      -     -   16s
     0     0 39028.7996    0  710          - 39028.7996      -     -   17s
     0     0 39027.1396    0  711          - 39027.1396      -     -   17s
     0     0 39004.3481    0  711          - 39004.3481      -     -   18s
     0     0 38991.2276    0  705          - 38991.2276      -     -   18s
     0     0 38985.1103    0  714          - 38985.1103      -     -   18s
     0     0 38983.8618    0  716          - 38983.8618      -     -   18s
     0     0 38960.5390    0  719          - 38960.5390      -     -   19s
     0     0 38951.6399    0  717          - 38951.6399      -     -   21s
     0     0 38943.5561    0  721          - 38943.5561      -     -   21s
     0     0 38940.8338    0  724          - 38940.8338      -     -   21s
     0     0 38926.4794    0  727          - 38926.4794      -     -   22s
     0     0 38921.0884    0  726          - 38921.0884      -     -   22s
     0     0 38919.4594    0  725          - 38919.4594      -     -   22s
     0     0 38889.9157    0  731          - 38889.9157      -     -   23s
     0     0 38880.7524    0  727          - 38880.7524      -     -   24s
     0     0 38875.3993    0  729          - 38875.3993      -     -   24s
     0     0 38874.1974    0  730          - 38874.1974      -     -   24s
     0     0 38858.5847    0  727          - 38858.5847      -     -   25s
     0     0 38858.5847    0  727          - 38858.5847      -     -   27s
     0     2 38858.5847    0  727          - 38858.5847      -     -   37s
     7    16 32233.9091    3  648          - 34940.3180      -  1408   41s
    63    96 26940.3504    6  592          - 32809.0019      -  1100   46s
   159   192 26442.8188    8  630          - 32496.0211      -  1593   51s
   258   295 25581.6077    9  636          - 32092.2506      -  1576   57s
   294   330 25315.6876   10  618          - 32092.2506      -  1530   60s
   415   461 21022.9593   11  581          - 32092.2506      -  1506   65s
   498   544 19764.1438   12  623          - 32092.2506      -  1520   71s
   596   646 18360.3085   14  622          - 32092.2506      -  1514   76s
   710   787 16711.1136   16  607          - 32092.2506      -  1523   86s
   786   859 15367.1672   20  592          - 32092.2506      -  1519   90s
   858   952 14740.8913   22  587          - 32092.2506      -  1475   95s
  1047  1133 11772.7526   25  579          - 32092.2506      -  1384  103s
  1132  1226 10490.5408   27  562          - 32092.2506      -  1359  105s
  1363  1516 8504.68165   38  517          - 32092.2506      -  1248  110s
  1876  2043 7062.51503   47  510          - 32092.2506      -  1051  116s
  2139  2373 6203.22417   53  466          - 32092.2506      -   989  121s
  2928  3182 4802.64385   65  428          - 32092.2506      -   820  126s
  3706  3982 4100.91024   75  416          - 32092.2506      -   730  131s
  4462  4741 2696.39326   85  388          - 32092.2506      -   679  135s
  5376  5689 1432.08702  101  340          - 32092.2506      -   632  141s
  6006  6302 1185.61016  110  325          - 32092.2506      -   611  145s
  6516  6867  719.21447  122  315          - 32092.2506      -   601  151s
  7269  7593  434.70273  146  281          - 32092.2506      -   584  155s
  8041  8508  228.49941  164  250          - 32092.2506      -   574  160s
  8907  9389   61.02296  202  183          - 31202.2891      -   556  167s
 10050 10500 19964.2292   11  588          - 31202.2891      -   538  173s
 10667 10881 18256.4637   11  576          - 31202.2891      -   531  177s
 11096 11260 16322.2268   13  583          - 31202.2891      -   535  180s

Cutting planes:
  Implied bound: 194
  MIR: 439
  Flow cover: 115

Explored 11557 nodes (6248984 simplex iterations) in 180.03 seconds (579.40 work units)
Thread count was 32 (of 96 available processors)

Solution count 0

Time limit reached
Best objective -, best bound 3.120228910408e+04, gap -
No counter example exists in neighborhood.
Time elapsed for full adv. : 180.1365 sec

Saved to ./res/GRID/OBBT_-1/RESUME_|ARCH_6x100-EPOCHS_50-ID_10000|checkpoint_0.th.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, obbt=-1, pretrained_path='./saved_models/ARCH_6x100-EPOCHS_50-ID_10000/checkpoint_1.th', seed=0)

RESUME_|ARCH_6x100-EPOCHS_50-ID_10000|checkpoint_1.th
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_6x100-EPOCHS_50-ID_10000/checkpoint_1.th'
=> loaded pretrained arch 97.77, with accuracy '6x100'
Test: [49/79]	Loss 0.0001 (0.1956) ([0.000]+[0.000])	Prec@1 100.000 (97.391)
 * Prec@1 97.770
Model for sequential:
1200 variables
610 constraints
600 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0            (1, 100)          100          100            0            0

relu_1              (1, 100)          100            0            0          100

linear_2            (1, 100)          100          100            0            0

relu_3              (1, 100)          100            0            0          100

linear_4            (1, 100)          100          100            0            0

relu_5              (1, 100)          100            0            0          100

linear_6            (1, 100)          100          100            0            0

relu_7              (1, 100)          100            0            0          100

linear_8            (1, 100)          100          100            0            0

relu_9              (1, 100)          100            0            0          100

linear_10           (1, 100)          100          100            0            0

relu_11             (1, 100)          100            0            0          100

linear_12            (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 2179 rows, 2778 columns and 133930 nonzeros
Model fingerprint: 0xe96f9bbd
Model has 600 general constraints
Variable types: 2778 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [6e-07, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [5e-05, 5e+00]
Presolve added 176 rows and 197 columns
Presolve time: 0.58s
Presolved: 2355 rows, 2975 columns, 133840 nonzeros
Variable types: 2095 continuous, 880 integer (880 binary)

Root relaxation: objective 3.372406e+04, 12795 iterations, 2.26 seconds (4.55 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 33724.0604    0  549          - 33724.0604      -     -    3s
     0     0 33475.8343    0  552          - 33475.8343      -     -    5s
     0     0 33197.6535    0  569          - 33197.6535      -     -    5s
     0     0 31273.5103    0  602          - 31273.5103      -     -    6s
     0     0 31273.0345    0  600          - 31273.0345      -     -    6s
     0     0 31273.0037    0  600          - 31273.0037      -     -    6s
     0     0 31243.4900    0  615          - 31243.4900      -     -    8s
     0     0 31106.7931    0  608          - 31106.7931      -     -    9s
     0     0 31081.8476    0  615          - 31081.8476      -     -    9s
     0     0 31080.9166    0  612          - 31080.9166      -     -    9s
     0     0 31080.8462    0  614          - 31080.8462      -     -    9s
     0     0 31037.2873    0  630          - 31037.2873      -     -   10s
     0     0 31019.5856    0  639          - 31019.5856      -     -   11s
     0     0 30952.5257    0  660          - 30952.5257      -     -   11s
     0     0 30878.0685    0  665          - 30878.0685      -     -   12s
     0     0 30805.2529    0  656          - 30805.2529      -     -   12s
     0     0 30804.3589    0  659          - 30804.3589      -     -   12s
     0     0 30779.5857    0  672          - 30779.5857      -     -   13s
     0     0 30732.7073    0  677          - 30732.7073      -     -   14s
     0     0 30725.7984    0  674          - 30725.7984      -     -   14s
     0     0 30720.4942    0  681          - 30720.4942      -     -   14s
     0     0 30719.9465    0  678          - 30719.9465      -     -   14s
     0     0 30697.9160    0  679          - 30697.9160      -     -   15s
     0     0 30677.1135    0  680          - 30677.1135      -     -   16s
     0     0 30664.3015    0  680          - 30664.3015      -     -   16s
     0     0 30648.7407    0  679          - 30648.7407      -     -   16s
     0     0 30644.1663    0  674          - 30644.1663      -     -   17s
     0     0 30643.9709    0  675          - 30643.9709      -     -   17s
     0     0 30620.5129    0  678          - 30620.5129      -     -   18s
     0     0 30606.4908    0  683          - 30606.4908      -     -   18s
     0     0 30594.5875    0  678          - 30594.5875      -     -   18s
     0     0 30590.3680    0  678          - 30590.3680      -     -   18s
     0     0 30588.1644    0  684          - 30588.1644      -     -   19s
     0     0 30549.3938    0  688          - 30549.3938      -     -   20s
     0     0 30529.5629    0  677          - 30529.5629      -     -   21s
     0     0 30523.2352    0  677          - 30523.2352      -     -   22s
     0     0 30515.4176    0  681          - 30515.4176      -     -   22s
     0     0 30513.0648    0  683          - 30513.0648      -     -   22s
     0     0 30468.7556    0  690          - 30468.7556      -     -   23s
     0     0 30459.5127    0  693          - 30459.5127      -     -   23s
     0     0 30440.5008    0  702          - 30440.5008      -     -   23s
     0     0 30431.7905    0  696          - 30431.7905      -     -   24s
     0     0 30429.0325    0  698          - 30429.0325      -     -   24s
     0     0 30375.2737    0  698          - 30375.2737      -     -   25s
     0     0 30366.9411    0  696          - 30366.9411      -     -   25s
     0     0 30364.3383    0  703          - 30364.3383      -     -   25s
     0     0 30315.0586    0  704          - 30315.0586      -     -   26s
     0     0 30304.4172    0  708          - 30304.4172      -     -   26s
     0     0 30300.1464    0  704          - 30300.1464      -     -   26s
     0     0 30295.6604    0  704          - 30295.6604      -     -   26s
     0     0 30293.8984    0  707          - 30293.8984      -     -   26s
     0     0 30241.0592    0  701          - 30241.0592      -     -   27s
     0     0 30227.8638    0  703          - 30227.8638      -     -   28s
     0     0 30222.5286    0  702          - 30222.5286      -     -   28s
     0     0 30220.7473    0  704          - 30220.7473      -     -   28s
     0     0 30166.4906    0  706          - 30166.4906      -     -   29s
     0     0 30151.4122    0  704          - 30151.4122      -     -   29s
     0     0 30147.5035    0  708          - 30147.5035      -     -   29s
     0     0 30146.1350    0  708          - 30146.1350      -     -   29s
     0     0 30007.2005    0  704          - 30007.2005      -     -   30s
     0     0 29994.3086    0  700          - 29994.3086      -     -   30s
     0     0 29989.3027    0  701          - 29989.3027      -     -   30s
     0     0 29987.5675    0  700          - 29987.5675      -     -   30s
     0     0 29759.8085    0  703          - 29759.8085      -     -   31s
     0     0 29742.8404    0  708          - 29742.8404      -     -   31s
     0     0 29738.4216    0  705          - 29738.4216      -     -   32s
     0     0 29736.4080    0  707          - 29736.4080      -     -   32s
     0     0 29686.7634    0  712          - 29686.7634      -     -   32s
     0     0 29675.5900    0  712          - 29675.5900      -     -   33s
     0     0 29672.3582    0  709          - 29672.3582      -     -   33s
     0     0 29580.3715    0  709          - 29580.3715      -     -   33s
     0     0 29572.5052    0  708          - 29572.5052      -     -   33s
     0     0 29569.6529    0  709          - 29569.6529      -     -   34s
     0     0 29512.9988    0  715          - 29512.9988      -     -   34s
     0     0 29506.9768    0  709          - 29506.9768      -     -   35s
     0     0 29505.7172    0  711          - 29505.7172      -     -   35s
     0     0 29484.5424    0  715          - 29484.5424      -     -   35s
H    0     0                     -31.4465424 29484.5424      -     -   37s
     0     0 29484.5424    0  713  -31.44654 29484.5424      -     -   37s
     0     2 29484.5424    0  713  -31.44654 29484.5424      -     -   42s
    15    32 18904.3677    4  630  -31.44654 24991.8122      -  1255   45s
    31    64 18115.7258    5  616  -31.44654 24040.0627      -  1248   50s
    63    96 17751.6413    6  617  -31.44654 23358.7939      -  1060   75s
    95   128 16079.1204    7  559  -31.44654 23347.9610      -  1071   82s
H   98   128                     -31.4465420 23347.9610      -  1104   82s
H   99   128                     -31.4465419 23347.9610      -  1147   82s
   127   160 16670.6858    7  619  -31.44654 23347.9610      -  1739   86s
   159   192 16088.3386    8  610  -31.44654 23347.9610      -  1705  115s
H  169   192                     -31.4465416 23347.9610      -  1747  115s
H  170   192                     -31.4465388 23347.9610      -  1738  115s
H  177   192                     -31.4465373 23347.9610      -  1801  115s
   191   237 15895.3719    8  593  -31.44654 23347.9610      -  2085  123s
   236   284 14804.0418    9  568  -31.44654 23347.9610      -  2200  125s
   335   392 14879.2104   10  585  -31.44654 23347.9610      -  1924  130s
   444   493 13386.7520   12  581  -31.44654 23347.9610      -  1878  138s
   492   545 13245.6584   12  600  -31.44654 23347.9610      -  1928  143s
   544   605 12222.4208   13  557  -31.44654 23347.9610      -  1928  148s
   604   672 11247.9057   14  557  -31.44654 23347.9610      -  1941  153s
   671   747 10340.2854   15  571  -31.44654 23347.9610      -  1895  158s
   746   826 9008.46314   16  572  -31.44654 23347.9610      -  1843  162s
   825   928 8660.84857   17  558  -31.44654 23347.9610      -  1779  167s
   927  1023 7407.18254   20  536  -31.44654 23347.9610      -  1691  171s
  1059  1181 5918.40184   24  510  -31.44654 23347.9610      -  1639  178s
  1180  1271 5352.87511   26  502  -31.44654 23347.9610      -  1572  180s

Cutting planes:
  Implied bound: 613
  MIR: 1009
  Flow cover: 406
  Relax-and-lift: 8

Explored 1274 nodes (1989872 simplex iterations) in 180.02 seconds (468.35 work units)
Thread count was 32 (of 96 available processors)

Solution count 2: -31.4465 -31.4465 

Time limit reached
Best objective -3.144653732221e+01, best bound 2.334796101067e+04, gap 74346.5244%
No counter example exists in neighborhood.
Time elapsed for full adv. : 180.1273 sec

Saved to ./res/GRID/OBBT_-1/RESUME_|ARCH_6x100-EPOCHS_50-ID_10000|checkpoint_1.th.csv.



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=False, arch='2x50', path='./res/GRID/OBBT_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, obbt=-1, pretrained_path='./saved_models/ARCH_6x100-EPOCHS_50-ID_10000/checkpoint_2.th', seed=0)

RESUME_|ARCH_6x100-EPOCHS_50-ID_10000|checkpoint_2.th
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_6x100-EPOCHS_50-ID_10000/checkpoint_2.th'
=> loaded pretrained arch 97.67, with accuracy '6x100'
Test: [49/79]	Loss 0.0407 (0.2446) ([0.041]+[0.000])	Prec@1 99.219 (97.156)
 * Prec@1 97.670
Model for sequential:
1200 variables
610 constraints
600 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0            (1, 100)          100          100            0            0

relu_1              (1, 100)          100            0            0          100

linear_2            (1, 100)          100          100            0            0

relu_3              (1, 100)          100            0            0          100

linear_4            (1, 100)          100          100            0            0

relu_5              (1, 100)          100            0            0          100

linear_6            (1, 100)          100          100            0            0

relu_7              (1, 100)          100            0            0          100

linear_8            (1, 100)          100          100            0            0

relu_9              (1, 100)          100            0            0          100

linear_10           (1, 100)          100          100            0            0

relu_11             (1, 100)          100            0            0          100

linear_12            (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 2179 rows, 2778 columns and 133930 nonzeros
Model fingerprint: 0x041262cd
Model has 600 general constraints
Variable types: 2778 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [8e-07, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [2e-05, 5e+00]
Presolve added 132 rows and 153 columns
Presolve time: 0.59s
Presolved: 2311 rows, 2931 columns, 133744 nonzeros
Variable types: 2087 continuous, 844 integer (844 binary)

Root relaxation: objective 2.656685e+04, 7454 iterations, 1.24 seconds (2.52 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 26566.8468    0  499          - 26566.8468      -     -    1s
     0     0 26555.9426    0  512          - 26555.9426      -     -    3s
     0     0 26402.8778    0  518          - 26402.8778      -     -    4s
     0     0 25160.1778    0  573          - 25160.1778      -     -    5s
     0     0 25159.6434    0  574          - 25159.6434      -     -    5s
     0     0 25159.5594    0  572          - 25159.5594      -     -    5s
     0     0 25159.5578    0  573          - 25159.5578      -     -    5s
     0     0 25094.0517    0  578          - 25094.0517      -     -    7s
     0     0 24994.8236    0  588          - 24994.8236      -     -    7s
     0     0 24967.1834    0  596          - 24967.1834      -     -    8s
     0     0 24965.8782    0  602          - 24965.8782      -     -    8s
     0     0 24965.5866    0  600          - 24965.5866      -     -    8s
     0     0 24938.4195    0  596          - 24938.4195      -     -    9s
     0     0 24897.1102    0  618          - 24897.1102      -     -    9s
     0     0 24883.2581    0  629          - 24883.2581      -     -   10s
     0     0 24880.1002    0  631          - 24880.1002      -     -   10s
     0     0 24793.8825    0  626          - 24793.8825      -     -   10s
     0     0 24793.4996    0  626          - 24793.4996      -     -   10s
     0     0 24776.7103    0  620          - 24776.7103      -     -   11s
     0     0 24761.8575    0  624          - 24761.8575      -     -   12s
     0     0 24755.2824    0  621          - 24755.2824      -     -   12s
     0     0 24753.1976    0  628          - 24753.1976      -     -   12s
     0     0 24752.4385    0  626          - 24752.4385      -     -   12s
     0     0 24724.5071    0  638          - 24724.5071      -     -   13s
     0     0 24705.8077    0  645          - 24705.8077      -     -   14s
     0     0 24692.1642    0  652          - 24692.1642      -     -   14s
     0     0 24689.6120    0  647          - 24689.6120      -     -   14s
     0     0 24688.3641    0  648          - 24688.3641      -     -   15s
     0     0 24671.2031    0  649          - 24671.2031      -     -   16s
     0     0 24655.6818    0  644          - 24655.6818      -     -   16s
     0     0 24647.6770    0  648          - 24647.6770      -     -   16s
     0     0 24644.5886    0  646          - 24644.5886      -     -   16s
     0     0 24643.7169    0  650          - 24643.7169      -     -   16s
     0     0 24618.0710    0  640          - 24618.0710      -     -   17s
     0     0 24604.8257    0  650          - 24604.8257      -     -   18s
     0     0 24595.6819    0  646          - 24595.6819      -     -   18s
     0     0 24590.9160    0  650          - 24590.9160      -     -   18s
     0     0 24589.1621    0  649          - 24589.1621      -     -   18s
     0     0 24589.0096    0  648          - 24589.0096      -     -   18s
     0     0 24511.7114    0  658          - 24511.7114      -     -   19s
     0     0 24492.9148    0  654          - 24492.9148      -     -   19s
     0     0 24478.8364    0  661          - 24478.8364      -     -   19s
     0     0 24473.7442    0  659          - 24473.7442      -     -   20s
     0     0 24471.9477    0  660          - 24471.9477      -     -   20s
     0     0 24440.1313    0  656          - 24440.1313      -     -   21s
     0     0 24431.3474    0  659          - 24431.3474      -     -   22s
     0     0 24428.5096    0  658          - 24428.5096      -     -   22s
     0     0 24427.7204    0  658          - 24427.7204      -     -   22s
     0     0 24388.9456    0  656          - 24388.9456      -     -   23s
     0     0 24370.3149    0  661          - 24370.3149      -     -   23s
     0     0 24364.8210    0  660          - 24364.8210      -     -   24s
     0     0 24361.6030    0  660          - 24361.6030      -     -   24s
     0     0 24360.3381    0  659          - 24360.3381      -     -   24s
     0     0 24263.9702    0  664          - 24263.9702      -     -   25s
     0     0 24244.9955    0  666          - 24244.9955      -     -   25s
     0     0 24238.7944    0  663          - 24238.7944      -     -   25s
     0     0 24236.1565    0  667          - 24236.1565      -     -   25s
     0     0 24234.9987    0  668          - 24234.9987      -     -   25s
     0     0 24186.6475    0  667          - 24186.6475      -     -   26s
     0     0 24165.1253    0  665          - 24165.1253      -     -   26s
     0     0 24158.7094    0  670          - 24158.7094      -     -   26s
     0     0 24157.1150    0  671          - 24157.1150      -     -   26s
     0     0 24017.3102    0  677          - 24017.3102      -     -   27s
     0     0 23996.8433    0  674          - 23996.8433      -     -   27s
     0     0 23989.0134    0  674          - 23989.0134      -     -   28s
     0     0 23985.8625    0  672          - 23985.8625      -     -   28s
     0     0 23983.9472    0  673          - 23983.9472      -     -   28s
     0     0 23901.5105    0  670          - 23901.5105      -     -   29s
     0     0 23877.8424    0  671          - 23877.8424      -     -   29s
     0     0 23872.6494    0  672          - 23872.6494      -     -   29s
     0     0 23871.0082    0  673          - 23871.0082      -     -   29s
     0     0 23748.3583    0  684          - 23748.3583      -     -   30s
     0     0 23741.6491    0  684          - 23741.6491      -     -   30s
     0     0 23736.8636    0  682          - 23736.8636      -     -   30s
     0     0 23736.1894    0  683          - 23736.1894      -     -   30s
     0     0 23668.9675    0  686          - 23668.9675      -     -   31s
     0     0 23659.0672    0  688          - 23659.0672      -     -   31s
     0     0 23654.5109    0  682          - 23654.5109      -     -   31s
     0     0 23654.0406    0  682          - 23654.0406      -     -   31s
     0     0 23620.0921    0  684          - 23620.0921      -     -   32s
     0     0 23612.1671    0  685          - 23612.1671      -     -   32s
     0     0 23610.7644    0  686          - 23610.7644      -     -   32s
     0     0 23310.0098    0  684          - 23310.0098      -     -   33s
     0     0 23303.2012    0  687          - 23303.2012      -     -   33s
     0     0 23299.8395    0  686          - 23299.8395      -     -   33s
     0     0 23227.6801    0  690          - 23227.6801      -     -   34s
     0     0 23218.8416    0  690          - 23218.8416      -     -   34s
     0     0 23216.4737    0  690          - 23216.4737      -     -   34s
     0     0 23160.0110    0  691          - 23160.0110      -     -   35s
     0     0 23144.5756    0  694          - 23144.5756      -     -   35s
     0     0 23141.4892    0  694          - 23141.4892      -     -   35s
     0     0 23012.3428    0  693          - 23012.3428      -     -   35s
     0     0 23007.1697    0  691          - 23007.1697      -     -   36s
     0     0 23005.6118    0  691          - 23005.6118      -     -   36s
     0     0 22669.5162    0  700          - 22669.5162      -     -   36s
     0     0 22662.0772    0  701          - 22662.0772      -     -   36s
     0     0 22659.6151    0  699          - 22659.6151      -     -   36s
     0     0 22459.4246    0  707          - 22459.4246      -     -   37s
     0     0 22454.4173    0  698          - 22454.4173      -     -   37s
     0     0 22259.6118    0  704          - 22259.6118      -     -   38s
     0     0 22255.0646    0  704          - 22255.0646      -     -   38s
     0     0 22065.1066    0  705          - 22065.1066      -     -   38s
     0     0 22058.9068    0  704          - 22058.9068      -     -   39s
     0     0 22057.8605    0  704          - 22057.8605      -     -   39s
     0     0 21995.2565    0  709          - 21995.2565      -     -   39s
     0     0 21984.5987    0  708          - 21984.5987      -     -   39s
     0     0 21983.6248    0  706          - 21983.6248      -     -   39s
     0     0 21911.4453    0  700          - 21911.4453      -     -   40s
     0     0 21907.3296    0  704          - 21907.3296      -     -   40s
     0     0 21744.7338    0  704          - 21744.7338      -     -   41s
     0     0 21741.0692    0  705          - 21741.0692      -     -   41s
     0     0 21709.9999    0  708          - 21709.9999      -     -   41s
     0     0 21709.9999    0  706          - 21709.9999      -     -   44s
     0     2 21709.9999    0  703          - 21709.9999      -     -   55s
   255   294 15014.8381    9  660          - 19468.4302      -   352   60s
   487   542 13300.5299   14  627          - 19468.4302      -   367   65s
  1077  1153 7173.45683   25  588          - 19468.4302      -   317   70s
  1838  1923 3781.18998   41  510          - 19468.4302      -   265   75s
  2663  2794 2376.89980   55  476          - 19468.4302      -   246   80s
  3754  3921 1182.09067   76  401          - 19468.4302      -   251   85s
  4745  4936  615.71920   95  331          - 19468.4302      -   253   90s
  5695  5967  413.04693  130  289          - 19468.4302      -   262   95s
  6770  7116  260.60311  158  256          - 19468.4302      -   264  100s
  7958  7927  160.33272  193  207          - 19468.4302      -   258  107s
  8488  8697  122.58705  218  167          - 19468.4302      -   259  110s
  9900 10047   10.66014  272  118          - 19437.1365      -   258  115s
 11619 11775 6198.58841   27  571          - 19437.1365      -   255  121s
 13493 13413 1229.18985   69  393          - 19437.1365      -   255  126s
 14049 13414  124.73439  109  706          - 19437.1365      -   256  130s
 14052 13416  654.89278   89  394          - 19152.6636      -   256  137s
 14060 13421   24.81063  174  461          - 15520.1887      -   256  141s
 14070 13428 3568.71835   42  468          - 12918.7515      -   256  145s
 14078 13433  256.56117  154  489          - 9471.78778      -   256  150s
 14088 13440 8128.89080   14  495          - 8128.89080      -   256  155s
 14099 13447 6899.71282   11  495          - 6899.71282      -   255  162s
 14105 13451 4240.92206   35  498          - 6639.73032      -   255  165s
 14112 13456 6106.46929   20  500          - 6106.46929      -   255  170s
H14114 12783                     -31.5682590 6007.52162      -   255  172s
 14120 12788  246.86182  109  282  -31.56826 6007.52162      -   257  176s

Cutting planes:
  Gomory: 2
  MIR: 89
  Flow cover: 71
  Relax-and-lift: 5

Explored 14120 nodes (3679745 simplex iterations) in 180.02 seconds (381.27 work units)
Thread count was 32 (of 96 available processors)

Solution count 1: -31.5683 

Time limit reached
Best objective -3.156825902910e+01, best bound 6.007521623941e+03, gap 19130.2595%
No counter example exists in neighborhood.
Time elapsed for full adv. : 180.1512 sec

Saved to ./res/GRID/OBBT_-1/RESUME_|ARCH_6x100-EPOCHS_50-ID_10000|checkpoint_2.th.csv.



===================================================================
===================================================================


