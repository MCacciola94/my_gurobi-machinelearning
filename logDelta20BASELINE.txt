===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=True, arch='2x50', path='./res/GRID/OBBT_-1-CUTS_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, delta=20.0, obbt=-1, cuts=-1, pretrained_path='./saved_models/ARCH_2x50-EPOCHS_50-ID_10000/checkpoint_0.th')

RESUME_|ARCH_2x50-EPOCHS_50-ID_10000|checkpoint_0.th-ID_10000-DELTA_20.0
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x50-EPOCHS_50-ID_10000/checkpoint_0.th'
=> loaded pretrained arch 97.55, with accuracy '2x50'
Test: [49/79]	Loss 0.0005 (0.1286) ([0.001]+[0.000])	Prec@1 100.000 (97.031)
 * Prec@1 97.550
Correct label is  tensor(3)  || Wrong label is  tensor(5)
Set parameter TokenServer to value "licences.gerad.lan"
Model for sequential:
200 variables
110 constraints
100 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0             (1, 50)           50           50            0            0

relu_1               (1, 50)           50            0            0           50

linear_2             (1, 50)           50           50            0            0

relu_3               (1, 50)           50            0            0           50

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1679 rows, 1778 columns and 46230 nonzeros
Model fingerprint: 0xa5513796
Model has 100 general constraints
Variable types: 1778 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [4e-07, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [2e-03, 2e+01]
Presolve removed 1094 rows and 573 columns
Presolve time: 0.18s
Presolved: 585 rows, 1205 columns, 43631 nonzeros
Variable types: 1126 continuous, 79 integer (79 binary)

Root relaxation: objective 7.912491e+02, 456 iterations, 0.01 seconds (0.02 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  791.24912    0   58          -  791.24912      -     -    0s
     0     0  746.82791    0   64          -  746.82791      -     -    0s
     0     0  742.30275    0   64          -  742.30275      -     -    0s
     0     0  672.96247    0   61          -  672.96247      -     -    0s
     0     0  609.45609    0   64          -  609.45609      -     -    1s
     0     0  607.14850    0   64          -  607.14850      -     -    1s
     0     0  607.14850    0   64          -  607.14850      -     -    1s
     0     0  607.14850    0   64          -  607.14850      -     -    1s
     0     0  566.22418    0   65          -  566.22418      -     -    1s
     0     0  556.48203    0   64          -  556.48203      -     -    1s
     0     0  556.19242    0   64          -  556.19242      -     -    1s
     0     0  556.19176    0   64          -  556.19176      -     -    1s
     0     0  437.47766    0   67          -  437.47766      -     -    1s
     0     0  424.80225    0   66          -  424.80225      -     -    1s
     0     0  424.47600    0   65          -  424.47600      -     -    1s
     0     0  424.38314    0   66          -  424.38314      -     -    1s
     0     0  396.21938    0   66          -  396.21938      -     -    1s
     0     0  388.83240    0   65          -  388.83240      -     -    1s
     0     0  386.29545    0   64          -  386.29545      -     -    1s
     0     0  386.23245    0   65          -  386.23245      -     -    1s
     0     0  344.45179    0   68          -  344.45179      -     -    1s
     0     0  336.13947    0   67          -  336.13947      -     -    1s
     0     0  335.45216    0   68          -  335.45216      -     -    1s
     0     0  335.32391    0   68          -  335.32391      -     -    1s
     0     0  314.32987    0   69          -  314.32987      -     -    1s
     0     0  310.32923    0   69          -  310.32923      -     -    1s
     0     0  307.90664    0   68          -  307.90664      -     -    1s
H    0     0                      -3.9103245  307.37652  7961%     -    1s
     0     0  307.37652    0   68   -3.91032  307.37652  7961%     -    1s
     0     0  307.35937    0   68   -3.91032  307.35937  7960%     -    1s
H    0     0                       9.8020614  307.35937  3036%     -    1s

Cutting planes:
  Gomory: 8
  Implied bound: 3
  MIR: 140
  Flow cover: 52

Explored 1 nodes (5015 simplex iterations) in 1.85 seconds (2.11 work units)
Thread count was 32 (of 96 available processors)

Solution count 2: 9.80206 -3.91032 

Optimization achieved user objective limit
Best objective 9.802061411694e+00, best bound 3.073593651416e+02, gap 3035.6605%
Solution is classified as 5
Time elapsed for full adv. : 2.2911 sec

{'Acc': 97.55, 'Loss': 0.002766466699540615, 'Elapsed': 1.8501379489898682, 'Nodes': 1.0, 'Arch': '2x50'}
DONT_SAVE OPTION ACTIVE, RESULTS NOT SAVED



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=True, arch='2x50', path='./res/GRID/OBBT_-1-CUTS_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, delta=20.0, obbt=-1, cuts=-1, pretrained_path='./saved_models/ARCH_2x50-EPOCHS_50-ID_10000/checkpoint_1.th', seed=0)

RESUME_|ARCH_2x50-EPOCHS_50-ID_10000|checkpoint_1.th-ID_10000-DELTA_20.0
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x50-EPOCHS_50-ID_10000/checkpoint_1.th'
=> loaded pretrained arch 97.47, with accuracy '2x50'
Test: [49/79]	Loss 0.0012 (0.1283) ([0.001]+[0.000])	Prec@1 100.000 (97.062)
 * Prec@1 97.470
Correct label is  tensor(3)  || Wrong label is  tensor(2)
Model for sequential:
200 variables
110 constraints
100 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0             (1, 50)           50           50            0            0

relu_1               (1, 50)           50            0            0           50

linear_2             (1, 50)           50           50            0            0

relu_3               (1, 50)           50            0            0           50

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1679 rows, 1778 columns and 46230 nonzeros
Model fingerprint: 0x21c2706f
Model has 100 general constraints
Variable types: 1778 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [5e-07, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [4e-03, 2e+01]
Presolve removed 1092 rows and 571 columns
Presolve time: 0.18s
Presolved: 587 rows, 1207 columns, 43636 nonzeros
Variable types: 1127 continuous, 80 integer (80 binary)

Root relaxation: objective 7.516607e+02, 462 iterations, 0.01 seconds (0.02 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  751.66068    0   60          -  751.66068      -     -    0s
     0     0  723.56804    0   66          -  723.56804      -     -    0s
     0     0  720.65007    0   68          -  720.65007      -     -    0s
     0     0  625.28693    0   67          -  625.28693      -     -    0s
     0     0  605.14127    0   69          -  605.14127      -     -    0s
     0     0  605.14127    0   69          -  605.14127      -     -    0s
     0     0  605.14127    0   69          -  605.14127      -     -    1s
     0     0  605.14127    0   68          -  605.14127      -     -    1s
     0     0  605.14127    0   68          -  605.14127      -     -    1s
     0     0  605.14127    0   70          -  605.14127      -     -    1s
     0     0  605.14127    0   71          -  605.14127      -     -    1s
     0     0  605.14127    0   70          -  605.14127      -     -    1s
     0     0  605.13241    0   70          -  605.13241      -     -    1s
     0     0  536.15591    0   75          -  536.15591      -     -    1s
     0     0  529.09965    0   73          -  529.09965      -     -    1s
     0     0  528.40464    0   73          -  528.40464      -     -    1s
     0     0  528.12564    0   73          -  528.12564      -     -    1s
     0     0  527.88121    0   73          -  527.88121      -     -    1s
     0     0  527.87729    0   73          -  527.87729      -     -    1s
     0     0  497.10370    0   75          -  497.10370      -     -    1s
     0     0  491.48150    0   76          -  491.48150      -     -    1s
     0     0  490.51830    0   76          -  490.51830      -     -    1s
     0     0  490.39426    0   77          -  490.39426      -     -    1s
     0     0  467.73411    0   76          -  467.73411      -     -    1s
     0     0  460.76596    0   76          -  460.76596      -     -    1s
     0     0  458.42072    0   75          -  458.42072      -     -    1s
     0     0  458.19325    0   75          -  458.19325      -     -    1s
     0     0  435.20683    0   76          -  435.20683      -     -    1s
     0     0  427.53138    0   77          -  427.53138      -     -    1s
     0     0  426.76695    0   76          -  426.76695      -     -    1s
     0     0  426.70486    0   76          -  426.70486      -     -    1s
     0     0  409.75518    0   76          -  409.75518      -     -    1s
     0     0  395.20905    0   76          -  395.20905      -     -    2s
     0     0  394.41160    0   77          -  394.41160      -     -    2s
     0     0  394.39703    0   77          -  394.39703      -     -    2s
     0     0  378.83368    0   73          -  378.83368      -     -    2s
     0     0  374.77126    0   73          -  374.77126      -     -    2s
     0     0  374.11522    0   73          -  374.11522      -     -    2s
     0     0  373.97722    0   73          -  373.97722      -     -    2s
     0     0  360.99522    0   74          -  360.99522      -     -    2s
     0     0  357.74881    0   73          -  357.74881      -     -    2s
     0     0  357.47237    0   74          -  357.47237      -     -    2s
     0     0  347.37976    0   74          -  347.37976      -     -    2s
     0     0  345.82402    0   74          -  345.82402      -     -    2s
     0     0  345.13228    0   74          -  345.13228      -     -    2s
     0     0  344.99874    0   75          -  344.99874      -     -    2s
     0     0  335.64458    0   74          -  335.64458      -     -    2s
     0     0  329.04556    0   74          -  329.04556      -     -    2s
     0     0  328.26526    0   74          -  328.26526      -     -    2s
     0     0  327.80886    0   74          -  327.80886      -     -    2s
     0     0  327.76622    0   74          -  327.76622      -     -    2s
     0     0  314.88671    0   75          -  314.88671      -     -    2s
     0     0  314.23348    0   76          -  314.23348      -     -    2s
     0     0  314.13234    0   77          -  314.13234      -     -    2s
     0     0  309.40590    0   76          -  309.40590      -     -    2s
     0     0  308.08868    0   76          -  308.08868      -     -    2s
     0     0  307.98345    0   77          -  307.98345      -     -    2s
     0     0  306.77614    0   76          -  306.77614      -     -    3s
H    0     0                     -29.5279765  306.77614  1139%     -    3s
     0     0  306.77614    0   76  -29.52798  306.77614  1139%     -    3s
     0     2  306.77614    0   76  -29.52798  306.77614  1139%     -    3s
H   32    64                     -29.5279761  230.88782   882%   185    4s
* 1032   897              52     -27.5876093  215.14285   880%  83.1    4s
  1045   966   51.95390   20   42  -27.58761  215.14285   880%  82.9    5s
* 1186  1044              55       4.0089104  215.14285  5267%  80.5    5s

Cutting planes:
  Gomory: 2
  Implied bound: 6
  MIR: 267
  Flow cover: 128
  Relax-and-lift: 4

Explored 1221 nodes (105256 simplex iterations) in 5.06 seconds (9.48 work units)
Thread count was 32 (of 96 available processors)

Solution count 3: 4.00891 -27.5876 -29.528 

Optimization achieved user objective limit
Best objective 4.008910419016e+00, best bound 2.151428510267e+02, gap 5266.6166%
Solution is classified as 2
Time elapsed for full adv. : 5.1930 sec

{'Acc': 97.47, 'Loss': 0.01072560716420412, 'Elapsed': 5.0610740184783936, 'Nodes': 1221.0, 'Arch': '2x50'}
DONT_SAVE OPTION ACTIVE, RESULTS NOT SAVED



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=True, arch='2x50', path='./res/GRID/OBBT_-1-CUTS_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, delta=20.0, obbt=-1, cuts=-1, pretrained_path='./saved_models/ARCH_2x50-EPOCHS_50-ID_10000/checkpoint_2.th', seed=0)

RESUME_|ARCH_2x50-EPOCHS_50-ID_10000|checkpoint_2.th-ID_10000-DELTA_20.0
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x50-EPOCHS_50-ID_10000/checkpoint_2.th'
=> loaded pretrained arch 97.25, with accuracy '2x50'
Test: [49/79]	Loss 0.0004 (0.1333) ([0.000]+[0.000])	Prec@1 100.000 (96.672)
 * Prec@1 97.250
Correct label is  tensor(3)  || Wrong label is  tensor(9)
Model for sequential:
200 variables
110 constraints
100 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0             (1, 50)           50           50            0            0

relu_1               (1, 50)           50            0            0           50

linear_2             (1, 50)           50           50            0            0

relu_3               (1, 50)           50            0            0           50

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1679 rows, 1778 columns and 46230 nonzeros
Model fingerprint: 0x3b473b50
Model has 100 general constraints
Variable types: 1778 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [2e-06, 2e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-04, 2e+01]
Presolve removed 1108 rows and 587 columns
Presolve time: 0.19s
Presolved: 571 rows, 1191 columns, 43596 nonzeros
Variable types: 1119 continuous, 72 integer (72 binary)

Root relaxation: objective 6.806743e+02, 424 iterations, 0.01 seconds (0.02 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  680.67432    0   51          -  680.67432      -     -    0s
     0     0  628.43781    0   54          -  628.43781      -     -    0s
     0     0  624.11445    0   57          -  624.11445      -     -    0s
     0     0  623.84294    0   56          -  623.84294      -     -    0s
     0     0  461.47150    0   56          -  461.47150      -     -    0s
     0     0  417.56314    0   56          -  417.56314      -     -    0s
     0     0  417.56314    0   56          -  417.56314      -     -    0s
     0     0  417.56314    0   56          -  417.56314      -     -    0s
     0     0  417.56314    0   58          -  417.56314      -     -    1s
     0     0  417.56314    0   57          -  417.56314      -     -    1s
     0     0  417.56314    0   56          -  417.56314      -     -    1s
     0     0  417.56314    0   57          -  417.56314      -     -    1s
     0     0  357.00082    0   63          -  357.00082      -     -    1s
     0     0  349.68326    0   61          -  349.68326      -     -    1s
     0     0  348.37970    0   61          -  348.37970      -     -    1s
     0     0  347.88207    0   61          -  347.88207      -     -    1s
     0     0  347.86935    0   61          -  347.86935      -     -    1s
     0     0  323.65491    0   61          -  323.65491      -     -    1s
     0     0  321.16062    0   61          -  321.16062      -     -    1s
     0     0  320.63118    0   63          -  320.63118      -     -    1s
     0     0  320.55531    0   62          -  320.55531      -     -    1s
     0     0  309.77950    0   62          -  309.77950      -     -    1s
     0     0  307.69856    0   63          -  307.69856      -     -    1s
     0     0  307.61419    0   63          -  307.61419      -     -    1s
H    0     0                      -8.3623794  290.56652  3575%     -    1s
     0     0  290.56652    0   61   -8.36238  290.56652  3575%     -    1s
H    0     0                       5.2672713  287.99049  5368%     -    1s
     0     0  287.99049    0   60    5.26727  287.99049  5368%     -    1s

Cutting planes:
  Implied bound: 1
  MIR: 116
  Flow cover: 33
  Relax-and-lift: 2

Explored 1 nodes (3876 simplex iterations) in 1.66 seconds (1.78 work units)
Thread count was 32 (of 96 available processors)

Solution count 2: 5.26727 -8.36238 

Optimization achieved user objective limit
Best objective 5.267271292159e+00, best bound 2.879904924157e+02, gap 5367.5462%
Solution is classified as 9
Time elapsed for full adv. : 1.8165 sec

{'Acc': 97.25, 'Loss': 0.006010493729263544, 'Elapsed': 1.6583170890808105, 'Nodes': 1.0, 'Arch': '2x50'}
DONT_SAVE OPTION ACTIVE, RESULTS NOT SAVED



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=True, arch='2x50', path='./res/GRID/OBBT_-1-CUTS_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, delta=20.0, obbt=-1, cuts=-1, pretrained_path='./saved_models/ARCH_2x100-EPOCHS_50-ID_10000/checkpoint_0.th', seed=0)

RESUME_|ARCH_2x100-EPOCHS_50-ID_10000|checkpoint_0.th-ID_10000-DELTA_20.0
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x100-EPOCHS_50-ID_10000/checkpoint_0.th'
=> loaded pretrained arch 97.96, with accuracy '2x100'
Test: [49/79]	Loss 0.0002 (0.1080) ([0.000]+[0.000])	Prec@1 100.000 (97.516)
 * Prec@1 97.960
Correct label is  tensor(3)  || Wrong label is  tensor(9)
Model for sequential:
400 variables
210 constraints
200 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0            (1, 100)          100          100            0            0

relu_1              (1, 100)          100            0            0          100

linear_2            (1, 100)          100          100            0            0

relu_3              (1, 100)          100            0            0          100

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1779 rows, 1978 columns and 93530 nonzeros
Model fingerprint: 0xf5ec5864
Model has 200 general constraints
Variable types: 1978 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [8e-07, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-04, 2e+01]
Presolve removed 962 rows and 541 columns
Presolve time: 0.43s
Presolved: 817 rows, 1437 columns, 90761 nonzeros
Variable types: 1292 continuous, 145 integer (145 binary)

Root relaxation: objective 7.506304e+02, 929 iterations, 0.06 seconds (0.14 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  750.63041    0  100          -  750.63041      -     -    0s
     0     0  703.50757    0   94          -  703.50757      -     -    1s
     0     0  682.79403    0  105          -  682.79403      -     -    1s
     0     0  672.15724    0  109          -  672.15724      -     -    1s
     0     0  670.16585    0  105          -  670.16585      -     -    1s
     0     0  670.15754    0  102          -  670.15754      -     -    1s
     0     0  572.85107    0  105          -  572.85107      -     -    2s
     0     0  546.61679    0  112          -  546.61679      -     -    2s
     0     0  539.91969    0  105          -  539.91969      -     -    2s
     0     0  539.50781    0  108          -  539.50781      -     -    2s
     0     0  539.35847    0  108          -  539.35847      -     -    2s
     0     0  539.35847    0  109          -  539.35847      -     -    2s
     0     0  473.58733    0  105          -  473.58733      -     -    3s
     0     0  457.18209    0  106          -  457.18209      -     -    3s
     0     0  453.96514    0  105          -  453.96514      -     -    3s
     0     0  453.25904    0  104          -  453.25904      -     -    3s
     0     0  453.18945    0  103          -  453.18945      -     -    3s
     0     0  385.73455    0  113          -  385.73455      -     -    3s
     0     0  379.26425    0  118          -  379.26425      -     -    3s
     0     0  376.40969    0  115          -  376.40969      -     -    3s
     0     0  375.66187    0  116          -  375.66187      -     -    3s
     0     0  375.63220    0  117          -  375.63220      -     -    3s
     0     0  355.62058    0  115          -  355.62058      -     -    3s
     0     0  350.63684    0  119          -  350.63684      -     -    3s
     0     0  348.94845    0  122          -  348.94845      -     -    4s
     0     0  348.62019    0  121          -  348.62019      -     -    4s
     0     0  348.52314    0  121          -  348.52314      -     -    4s
     0     0  334.24213    0  121          -  334.24213      -     -    4s
     0     0  329.57470    0  120          -  329.57470      -     -    4s
     0     0  327.99544    0  121          -  327.99544      -     -    4s
     0     0  327.61587    0  120          -  327.61587      -     -    4s
     0     0  317.90781    0  118          -  317.90781      -     -    4s
     0     0  315.51062    0  120          -  315.51062      -     -    4s
     0     0  314.81565    0  120          -  314.81565      -     -    4s
     0     0  314.65050    0  120          -  314.65050      -     -    4s
     0     0  308.43054    0  121          -  308.43054      -     -    5s
     0     0  306.61725    0  120          -  306.61725      -     -    5s
     0     0  305.91902    0  120          -  305.91902      -     -    5s
     0     0  305.74016    0  123          -  305.74016      -     -    5s
     0     0  296.07543    0  117          -  296.07543      -     -    5s
     0     0  294.11328    0  120          -  294.11328      -     -    5s
     0     0  293.48164    0  121          -  293.48164      -     -    5s
     0     0  293.24683    0  120          -  293.24683      -     -    5s
H    0     0                     -10.5050778  293.24683  2891%     -    5s
     0     0  287.07426    0  120  -10.50508  287.07426  2833%     -    5s
     0     0  286.42241    0  121  -10.50508  286.42241  2827%     -    6s
     0     0  286.21738    0  122  -10.50508  286.21738  2825%     -    6s
     0     0  278.03171    0  121  -10.50508  278.03171  2747%     -    6s
     0     0  276.81803    0  122  -10.50508  276.81803  2735%     -    6s
     0     0  276.17818    0  121  -10.50508  276.17818  2729%     -    6s
     0     0  276.05683    0  120  -10.50508  276.05683  2728%     -    6s
     0     0  270.29977    0  121  -10.50508  270.29977  2673%     -    6s
     0     0  269.39552    0  121  -10.50508  269.39552  2664%     -    7s
     0     0  269.20578    0  121  -10.50508  269.20578  2663%     -    7s
     0     0  255.92912    0  121  -10.50508  255.92912  2536%     -    7s
     0     0  254.89247    0  119  -10.50508  254.89247  2526%     -    7s
     0     0  254.53708    0  120  -10.50508  254.53708  2523%     -    7s
     0     0  250.65418    0  118  -10.50508  250.65418  2486%     -    7s
     0     0  249.64089    0  120  -10.50508  249.64089  2476%     -    7s
     0     0  249.27378    0  121  -10.50508  249.27378  2473%     -    7s
     0     0  222.01450    0  124  -10.50508  222.01450  2213%     -    7s
     0     0  221.06113    0  124  -10.50508  221.06113  2204%     -    8s
     0     0  220.84817    0  124  -10.50508  220.84817  2202%     -    8s
     0     0  214.44144    0  124  -10.50508  214.44144  2141%     -    8s
     0     0  213.49393    0  123  -10.50508  213.49393  2132%     -    8s
     0     0  212.91815    0  123  -10.50508  212.91815  2127%     -    8s
     0     0  212.85599    0  123  -10.50508  212.85599  2126%     -    8s
     0     0  210.59474    0  124  -10.50508  210.59474  2105%     -    8s
     0     0  210.59474    0  124  -10.50508  210.59474  2105%     -    8s
     0     2  210.59474    0  124  -10.50508  210.59474  2105%     -    9s
    31    64  132.72625    5  110  -10.50508  175.04128  1766%   292   10s
H   95   128                      -7.7576720  169.42212  2284%   285   13s
H  108   128                      -6.8991644  169.42212  2556%   287   13s
   839   781   41.94740   20   84   -6.89916  169.42212  2556%   132   15s
H 1164  1078                       0.4207821  169.42212      -   122   17s
H 1167  1078                       1.7158387  169.42212  9774%   122   17s
H 1169  1078                       2.0540237  169.42212  8148%   122   17s
H 1200  1078                       2.6749347  169.42212  6234%   121   17s

Cutting planes:
  Gomory: 6
  Implied bound: 1
  MIR: 368
  Flow cover: 227
  Relax-and-lift: 1

Explored 1217 nodes (159226 simplex iterations) in 17.34 seconds (30.30 work units)
Thread count was 32 (of 96 available processors)

Solution count 4: 2.67493 2.05402 -7.75767 -10.5051 

Optimization achieved user objective limit
Best objective 2.674934654525e+00, best bound 1.694221180196e+02, gap 6233.6918%
Solution is classified as 9
Time elapsed for full adv. : 17.5182 sec

{'Acc': 97.96, 'Loss': 0.001779633923433721, 'Elapsed': 17.352388858795166, 'Nodes': 1217.0, 'Arch': '2x100'}
DONT_SAVE OPTION ACTIVE, RESULTS NOT SAVED



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=True, arch='2x50', path='./res/GRID/OBBT_-1-CUTS_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, delta=20.0, obbt=-1, cuts=-1, pretrained_path='./saved_models/ARCH_2x100-EPOCHS_50-ID_10000/checkpoint_1.th', seed=0)

RESUME_|ARCH_2x100-EPOCHS_50-ID_10000|checkpoint_1.th-ID_10000-DELTA_20.0
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x100-EPOCHS_50-ID_10000/checkpoint_1.th'
=> loaded pretrained arch 97.76, with accuracy '2x100'
Test: [49/79]	Loss 0.0026 (0.1133) ([0.003]+[0.000])	Prec@1 100.000 (97.297)
 * Prec@1 97.760
Correct label is  tensor(3)  || Wrong label is  tensor(9)
Model for sequential:
400 variables
210 constraints
200 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0            (1, 100)          100          100            0            0

relu_1              (1, 100)          100            0            0          100

linear_2            (1, 100)          100          100            0            0

relu_3              (1, 100)          100            0            0          100

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1779 rows, 1978 columns and 93530 nonzeros
Model fingerprint: 0xfa98ea58
Model has 200 general constraints
Variable types: 1978 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [4e-07, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-03, 2e+01]
Presolve removed 950 rows and 529 columns
Presolve time: 0.45s
Presolved: 829 rows, 1449 columns, 90791 nonzeros
Variable types: 1298 continuous, 151 integer (151 binary)

Root relaxation: objective 8.363655e+02, 938 iterations, 0.07 seconds (0.15 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  836.36552    0  110          -  836.36552      -     -    0s
     0     0  789.31908    0  110          -  789.31908      -     -    1s
     0     0  775.82465    0  117          -  775.82465      -     -    1s
     0     0  766.78527    0  119          -  766.78527      -     -    1s
     0     0  766.70951    0  121          -  766.70951      -     -    1s
     0     0  674.41587    0  112          -  674.41587      -     -    3s
     0     0  674.41587    0  109          -  674.41587      -     -    3s
     0     0  674.41587    0  121          -  674.41587      -     -    3s
     0     0  660.06903    0  113          -  660.06903      -     -    3s
     0     0  658.20680    0  111          -  658.20680      -     -    3s
     0     0  653.77149    0  113          -  653.77149      -     -    3s
     0     0  652.96878    0  116          -  652.96878      -     -    3s
     0     0  652.78242    0  117          -  652.78242      -     -    3s
     0     0  652.76379    0  117          -  652.76379      -     -    3s
     0     0  539.08253    0  124          -  539.08253      -     -    3s
     0     0  515.87333    0  122          -  515.87333      -     -    3s
     0     0  504.74825    0  121          -  504.74825      -     -    3s
     0     0  500.65548    0  126          -  500.65548      -     -    3s
     0     0  498.80381    0  125          -  498.80381      -     -    3s
     0     0  498.40489    0  123          -  498.40489      -     -    3s
     0     0  498.13686    0  127          -  498.13686      -     -    3s
     0     0  498.08620    0  126          -  498.08620      -     -    3s
     0     0  461.99708    0  128          -  461.99708      -     -    4s
     0     0  454.49191    0  127          -  454.49191      -     -    4s
     0     0  452.13785    0  127          -  452.13785      -     -    4s
     0     0  451.48250    0  126          -  451.48250      -     -    4s
     0     0  451.36702    0  126          -  451.36702      -     -    4s
     0     0  416.00917    0  128          -  416.00917      -     -    4s
     0     0  406.03105    0  127          -  406.03105      -     -    4s
     0     0  402.55043    0  130          -  402.55043      -     -    4s
     0     0  401.78488    0  131          -  401.78488      -     -    4s
     0     0  401.60601    0  131          -  401.60601      -     -    4s
     0     0  389.19914    0  127          -  389.19914      -     -    5s
     0     0  384.99295    0  128          -  384.99295      -     -    5s
     0     0  384.62481    0  130          -  384.62481      -     -    5s
     0     0  374.50343    0  131          -  374.50343      -     -    5s
     0     0  369.31430    0  129          -  369.31430      -     -    5s
     0     0  368.53251    0  129          -  368.53251      -     -    5s
     0     0  368.39935    0  130          -  368.39935      -     -    5s
     0     0  358.50443    0  129          -  358.50443      -     -    5s
     0     0  357.61584    0  128          -  357.61584      -     -    5s
     0     0  357.23700    0  129          -  357.23700      -     -    5s
     0     0  348.39440    0  129          -  348.39440      -     -    6s
     0     0  346.95126    0  130          -  346.95126      -     -    6s
     0     0  346.52033    0  130          -  346.52033      -     -    6s
     0     0  332.01912    0  129          -  332.01912      -     -    6s
     0     0  329.34144    0  129          -  329.34144      -     -    6s
     0     0  329.15072    0  129          -  329.15072      -     -    6s
     0     0  318.50452    0  129          -  318.50452      -     -    6s
     0     0  315.53795    0  130          -  315.53795      -     -    6s
     0     0  315.10004    0  129          -  315.10004      -     -    6s
     0     0  307.16734    0  127          -  307.16734      -     -    7s
     0     0  305.68420    0  128          -  305.68420      -     -    7s
     0     0  305.16694    0  128          -  305.16694      -     -    7s
     0     0  301.53336    0  126          -  301.53336      -     -    7s
     0     0  300.59262    0  127          -  300.59262      -     -    7s
     0     0  300.17354    0  128          -  300.17354      -     -    7s
     0     0  289.11427    0  127          -  289.11427      -     -    8s
     0     0  287.79269    0  128          -  287.79269      -     -    8s
     0     0  287.43954    0  128          -  287.43954      -     -    8s
     0     0  285.01533    0  127          -  285.01533      -     -    8s
H    0     0                     -18.7422223  285.01533  1621%     -    8s
     0     0  285.01533    0  127  -18.74222  285.01533  1621%     -    8s
     0     2  285.01533    0  127  -18.74222  285.01533  1621%     -    9s
    31    64  208.02763    5  122  -18.74222  227.02474  1311%   330   10s
H   39    64                     -18.7422214  227.02474  1311%   316   10s
* 2178  1930             107     -10.2177598  216.90395  2223%  98.4   13s
H 2987  2591                     -10.2177598  216.90395  2223%  91.1   20s
H 2993  2591                     -10.2177597  216.90395  2223%  91.1   20s
H 3000  2591                     -10.2177594  216.90395  2223%  91.0   20s
H 3019  2591                     -10.2177594  216.90395  2223%  90.9   30s
  3032  2600    7.53493   59  129  -10.21776  216.90395  2223%  90.5   35s
  3054  2615  116.46880   12  125  -10.21776  181.30737  1874%  89.9   40s
H 3064  2489                     -10.2177590  163.11012  1696%  89.6   43s
  3066  2491   38.81953   35  128  -10.21776  161.58822  1681%  89.5   51s
  3077  2499   48.93414   27  126  -10.21776  131.01940  1382%  92.7   55s
  3089  2507   17.80826   29  119  -10.21776  116.23547  1238%  92.3   60s
  3091  2508   72.76476   22  121  -10.21776  115.61010  1231%  92.3   67s
  3095  2512   64.00847   22  102  -10.21776   87.86634   960%  94.1   70s
  3105  2519   -8.64009   28  116  -10.21776   76.81214   852%  93.8   75s
  3108  2521   54.71891   33  116  -10.21776   76.81214   852%  93.7   86s
  3118  2529   59.52081   18  117  -10.21776   76.81214   852%  94.2   91s
  3122  2532   -0.56968   59  118  -10.21776   76.81214   852%  94.1   95s
  3124  2533   76.81214   14  117  -10.21776   76.81214   852%  94.0  106s
  3134  2541   54.65419   26  116  -10.21776   76.81214   852%  94.6  111s
  3138  2544   76.61914   13  119  -10.21776   76.61914   850%  94.4  115s
  3140  2545   30.90734   24  119  -10.21776   76.39558   848%  94.4  127s
  3236  2642   42.74306   80   84  -10.21776   65.30522   739%  98.0  132s
H 3237  2514                     -10.2177590   65.30522   739%  97.9  132s
H 3238  2393                      -6.3236108   65.30522  1133%  98.0  132s
H 3241  2277                      -5.7896114   65.30522  1228%  98.1  132s
H 3255  2162                      -5.6892121   65.30522  1248%  98.1  132s
  4407  2879   36.27819   93   80   -5.68921   65.30522  1248%  87.2  138s
  4444  2894   36.04882   93   81   -5.68921   65.30522  1248%  86.8  146s
* 6886  4001             170      -1.0657465   65.30522  6228%  74.1  147s
* 6889  3864             172      -0.5352977   65.30522      -  74.0  147s
* 7248  2770             176      11.8015131   65.30522   453%  72.3  147s

Cutting planes:
  Gomory: 9
  MIR: 94
  Flow cover: 5

Explored 7532 nodes (547392 simplex iterations) in 147.66 seconds (234.89 work units)
Thread count was 32 (of 96 available processors)

Solution count 8: 11.8015 -0.535298 -1.06575 ... -18.7422

Optimization achieved user objective limit
Best objective 1.180151312945e+01, best bound 6.530521837565e+01, gap 453.3631%
Solution is classified as 9
Time elapsed for full adv. : 147.8513 sec

{'Acc': 97.76, 'Loss': 0.001547658466733992, 'Elapsed': 147.671893119812, 'Nodes': 7532.0, 'Arch': '2x100'}
DONT_SAVE OPTION ACTIVE, RESULTS NOT SAVED



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=True, arch='2x50', path='./res/GRID/OBBT_-1-CUTS_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, delta=20.0, obbt=-1, cuts=-1, pretrained_path='./saved_models/ARCH_2x100-EPOCHS_50-ID_10000/checkpoint_2.th', seed=0)

RESUME_|ARCH_2x100-EPOCHS_50-ID_10000|checkpoint_2.th-ID_10000-DELTA_20.0
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x100-EPOCHS_50-ID_10000/checkpoint_2.th'
=> loaded pretrained arch 97.97, with accuracy '2x100'
Test: [49/79]	Loss 0.0083 (0.0981) ([0.008]+[0.000])	Prec@1 99.219 (97.531)
 * Prec@1 97.970
Correct label is  tensor(3)  || Wrong label is  tensor(5)
Model for sequential:
400 variables
210 constraints
200 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0            (1, 100)          100          100            0            0

relu_1              (1, 100)          100            0            0          100

linear_2            (1, 100)          100          100            0            0

relu_3              (1, 100)          100            0            0          100

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1779 rows, 1978 columns and 93530 nonzeros
Model fingerprint: 0xee4eed75
Model has 200 general constraints
Variable types: 1978 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e-06, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e-03, 2e+01]
Presolve removed 952 rows and 531 columns
Presolve time: 0.41s
Presolved: 827 rows, 1447 columns, 90786 nonzeros
Variable types: 1297 continuous, 150 integer (150 binary)

Root relaxation: objective 8.375042e+02, 852 iterations, 0.05 seconds (0.11 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  837.50417    0  114          -  837.50417      -     -    0s
     0     0  774.17522    0  106          -  774.17522      -     -    1s
     0     0  767.14293    0  116          -  767.14293      -     -    1s
     0     0  767.12638    0  117          -  767.12638      -     -    1s
     0     0  766.67078    0  118          -  766.67078      -     -    1s
     0     0  676.46228    0  118          -  676.46228      -     -    3s
     0     0  670.23051    0  119          -  670.23051      -     -    3s
     0     0  670.23051    0  124          -  670.23051      -     -    3s
     0     0  670.23051    0  124          -  670.23051      -     -    3s
     0     0  670.23051    0  125          -  670.23051      -     -    3s
     0     0  670.23051    0  125          -  670.23051      -     -    3s
     0     0  670.23051    0  119          -  670.23051      -     -    3s
     0     0  665.85545    0  119          -  665.85545      -     -    3s
     0     0  660.68042    0  120          -  660.68042      -     -    3s
     0     0  660.43196    0  121          -  660.43196      -     -    3s
     0     0  660.42215    0  121          -  660.42215      -     -    3s
     0     0  577.89047    0  128          -  577.89047      -     -    3s
     0     0  553.59636    0  130          -  553.59636      -     -    3s
     0     0  550.15218    0  129          -  550.15218      -     -    4s
     0     0  549.42833    0  128          -  549.42833      -     -    4s
     0     0  549.25650    0  128          -  549.25650      -     -    4s
     0     0  549.23438    0  129          -  549.23438      -     -    4s
     0     0  500.05068    0  126          -  500.05068      -     -    4s
     0     0  492.44840    0  125          -  492.44840      -     -    4s
     0     0  492.08067    0  126          -  492.08067      -     -    4s
     0     0  492.06046    0  127          -  492.06046      -     -    4s
     0     0  464.15692    0  129          -  464.15692      -     -    4s
     0     0  456.59042    0  130          -  456.59042      -     -    4s
     0     0  455.10959    0  132          -  455.10959      -     -    4s
     0     0  454.33896    0  130          -  454.33896      -     -    4s
     0     0  454.27601    0  131          -  454.27601      -     -    4s
     0     0  432.60965    0  133          -  432.60965      -     -    5s
     0     0  427.70457    0  132          -  427.70457      -     -    5s
     0     0  425.96783    0  129          -  425.96783      -     -    5s
     0     0  425.54252    0  129          -  425.54252      -     -    5s
     0     0  425.47138    0  129          -  425.47138      -     -    5s
     0     0  413.59379    0  125          -  413.59379      -     -    5s
     0     0  409.32748    0  127          -  409.32748      -     -    5s
     0     0  408.26987    0  127          -  408.26987      -     -    5s
     0     0  408.05354    0  128          -  408.05354      -     -    5s
     0     0  396.82159    0  127          -  396.82159      -     -    6s
     0     0  393.06093    0  126          -  393.06093      -     -    6s
     0     0  392.10988    0  126          -  392.10988      -     -    6s
     0     0  392.02307    0  126          -  392.02307      -     -    6s
     0     0  374.50898    0  127          -  374.50898      -     -    6s
     0     0  372.62060    0  128          -  372.62060      -     -    6s
     0     0  372.38373    0  126          -  372.38373      -     -    6s
H    0     0                      -3.9616935  364.75825  9307%     -    6s
     0     0  364.75825    0  126   -3.96169  364.75825  9307%     -    6s
     0     0  363.94856    0  128   -3.96169  363.94856  9287%     -    7s
     0     0  363.80731    0  127   -3.96169  363.80731  9283%     -    7s
     0     0  360.16068    0  127   -3.96169  360.16068  9191%     -    7s
     0     0  357.95085    0  127   -3.96169  357.95085  9135%     -    7s
     0     0  357.55694    0  126   -3.96169  357.55694  9125%     -    7s
     0     0  350.20256    0  124   -3.96169  350.20256  8940%     -    7s
     0     0  347.30634    0  127   -3.96169  347.30634  8867%     -    7s
     0     0  346.21758    0  127   -3.96169  346.21758  8839%     -    7s
     0     0  346.04272    0  125   -3.96169  346.04272  8835%     -    7s
     0     0  342.94271    0  124   -3.96169  342.94271  8756%     -    8s
     0     0  342.01695    0  125   -3.96169  342.01695  8733%     -    8s
     0     0  341.70609    0  126   -3.96169  341.70609  8725%     -    8s
     0     0  322.19149    0  128   -3.96169  322.19149  8233%     -    8s
     0     0  321.14452    0  128   -3.96169  321.14452  8206%     -    8s
     0     0  320.82264    0  128   -3.96169  320.82264  8198%     -    8s
     0     0  317.29512    0  130   -3.96169  317.29512  8109%     -    8s
     0     0  314.29573    0  129   -3.96169  314.29573  8033%     -    9s
     0     0  313.86357    0  129   -3.96169  313.86357  8022%     -    9s
     0     0  311.49288    0  129   -3.96169  311.49288  7963%     -    9s
     0     0  310.67448    0  130   -3.96169  310.67448  7942%     -    9s
     0     0  310.47023    0  129   -3.96169  310.47023  7937%     -    9s
     0     0  308.26160    0  130   -3.96169  308.26160  7881%     -    9s
     0     2  308.26160    0  130   -3.96169  308.26160  7881%     -   10s
  1587  1508   43.97100   32   74   -3.96169  247.33240  6343%   126   15s
  3010  2609   28.22395   36  130   -3.96169  238.35053  6116%  98.3   22s
  3017  2614   29.86654   34  129   -3.96169  238.35053  6116%  98.1   25s
  3038  2628  108.68692   19  131   -3.96169  223.73538  5747%  97.4   30s
  3057  2640  184.32498    8  132   -3.96169  184.32498  4753%  96.8   35s
  3067  2647   27.40120   37  132   -3.96169  175.75751  4536%  96.5   45s
  3078  2656  106.14343   16  129   -3.96169  134.07556  3484%   101   50s
  3090  2664   67.80302   25  128   -3.96169  125.21454  3261%   100   61s
  3099  2672   20.40172   72  100   -3.96169   81.74028  2163%   102   65s
  3106  2676   77.50920   21  115   -3.96169   77.50920  2056%   102   79s
  3110  2680   28.22395   36   99   -3.96169   77.50920  2056%   102   81s
  3118  2686   17.77087   55  117   -3.96169   77.50920  2056%   102   85s
  3124  2690   19.89746   53  107   -3.96169   76.89316  2041%   102   98s
H 3220  2652                      -2.5464191   68.41478  2787%   104  102s
H 3222  2523                       1.8642534   68.41478  3570%   104  102s

Cutting planes:
  Gomory: 5
  MIR: 90
  Flow cover: 4

Explored 3252 nodes (351018 simplex iterations) in 102.66 seconds (157.24 work units)
Thread count was 32 (of 96 available processors)

Solution count 3: 1.86425 -2.54642 -3.96169 

Optimization achieved user objective limit
Best objective 1.864253446995e+00, best bound 6.841477943706e+01, gap 3569.8218%
Solution is classified as 5
Time elapsed for full adv. : 102.8649 sec

{'Acc': 97.97, 'Loss': 0.0024882424622774124, 'Elapsed': 102.67132782936096, 'Nodes': 3252.0, 'Arch': '2x100'}
DONT_SAVE OPTION ACTIVE, RESULTS NOT SAVED



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=True, arch='2x50', path='./res/GRID/OBBT_-1-CUTS_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, delta=20.0, obbt=-1, cuts=-1, pretrained_path='./saved_models/ARCH_2x200-EPOCHS_50-ID_10000/checkpoint_0.th', seed=0)

RESUME_|ARCH_2x200-EPOCHS_50-ID_10000|checkpoint_0.th-ID_10000-DELTA_20.0
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x200-EPOCHS_50-ID_10000/checkpoint_0.th'
=> loaded pretrained arch 98.14, with accuracy '2x200'
Test: [49/79]	Loss 0.0004 (0.0901) ([0.000]+[0.000])	Prec@1 100.000 (97.750)
 * Prec@1 98.140
Correct label is  tensor(3)  || Wrong label is  tensor(9)
Model for sequential:
800 variables
410 constraints
400 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0            (1, 200)          200          200            0            0

relu_1              (1, 200)          200            0            0          200

linear_2            (1, 200)          200          200            0            0

relu_3              (1, 200)          200            0            0          200

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1979 rows, 2378 columns and 203130 nonzeros
Model fingerprint: 0x7045ad77
Model has 400 general constraints
Variable types: 2378 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e-08, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [4e-05, 2e+01]
Presolve removed 646 rows and 425 columns
Presolve time: 0.35s
Presolved: 1333 rows, 1953 columns, 200150 nonzeros
Variable types: 1650 continuous, 303 integer (303 binary)

Root relaxation: objective 9.696970e+02, 1696 iterations, 0.22 seconds (0.57 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  969.69696    0  210          -  969.69696      -     -    0s
     0     0  944.08321    0  241          -  944.08321      -     -    2s
     0     0  917.62833    0  236          -  917.62833      -     -    2s
     0     0  908.58651    0  221          -  908.58651      -     -    2s
     0     0  891.21210    0  238          -  891.21210      -     -    3s
     0     0  888.98309    0  235          -  888.98309      -     -    3s
     0     0  886.33481    0  229          -  886.33481      -     -    3s
     0     0  886.17966    0  232          -  886.17966      -     -    3s
     0     0  886.17772    0  232          -  886.17772      -     -    3s
     0     0  865.12374    0  231          -  865.12374      -     -    4s
     0     0  855.91197    0  230          -  855.91197      -     -    4s
     0     0  844.46628    0  231          -  844.46628      -     -    4s
     0     0  825.53341    0  224          -  825.53341      -     -    5s
     0     0  811.52607    0  222          -  811.52607      -     -    5s
     0     0  788.63407    0  229          -  788.63407      -     -    5s
     0     0  786.47463    0  225          -  786.47463      -     -    5s
     0     0  784.33023    0  227          -  784.33023      -     -    5s
     0     0  783.93215    0  226          -  783.93215      -     -    5s
     0     0  783.89698    0  227          -  783.89698      -     -    5s
     0     0  737.68238    0  221          -  737.68238      -     -    6s
     0     0  733.36780    0  217          -  733.36780      -     -    6s
     0     0  715.95446    0  219          -  715.95446      -     -    6s
     0     0  713.73943    0  220          -  713.73943      -     -    6s
     0     0  711.58848    0  218          -  711.58848      -     -    6s
     0     0  710.74949    0  221          -  710.74949      -     -    6s
     0     0  710.18411    0  221          -  710.18411      -     -    6s
     0     0  710.10757    0  219          -  710.10757      -     -    6s
     0     0  583.19216    0  244          -  583.19216      -     -    7s
     0     0  565.26140    0  242          -  565.26140      -     -    7s
     0     0  556.65107    0  241          -  556.65107      -     -    7s
     0     0  547.98776    0  240          -  547.98776      -     -    7s
     0     0  545.31798    0  240          -  545.31798      -     -    7s
     0     0  543.98241    0  241          -  543.98241      -     -    7s
     0     0  543.32071    0  243          -  543.32071      -     -    7s
     0     0  543.17771    0  241          -  543.17771      -     -    7s
     0     0  517.98764    0  245          -  517.98764      -     -    8s
     0     0  511.09380    0  243          -  511.09380      -     -    8s
     0     0  508.69196    0  243          -  508.69196      -     -    8s
     0     0  506.91133    0  243          -  506.91133      -     -    8s
     0     0  506.06939    0  242          -  506.06939      -     -    8s
     0     0  505.59575    0  243          -  505.59575      -     -    8s
     0     0  505.28483    0  244          -  505.28483      -     -    8s
     0     0  484.08773    0  240          -  484.08773      -     -    9s
     0     0  479.54857    0  238          -  479.54857      -     -    9s
     0     0  478.36619    0  239          -  478.36619      -     -    9s
     0     0  476.79274    0  238          -  476.79274      -     -    9s
     0     0  476.11212    0  239          -  476.11212      -     -    9s
     0     0  475.45860    0  239          -  475.45860      -     -    9s
     0     0  475.31518    0  239          -  475.31518      -     -    9s
     0     0  466.17728    0  245          -  466.17728      -     -   10s
     0     0  465.56784    0  242          -  465.56784      -     -   10s
     0     0  465.10597    0  243          -  465.10597      -     -   10s
     0     0  444.87109    0  246          -  444.87109      -     -   11s
     0     0  443.03220    0  246          -  443.03220      -     -   11s
     0     0  441.78334    0  246          -  441.78334      -     -   11s
     0     0  441.04948    0  245          -  441.04948      -     -   11s
     0     0  440.64605    0  245          -  440.64605      -     -   11s
     0     0  436.27276    0  245          -  436.27276      -     -   12s
     0     0  434.49550    0  246          -  434.49550      -     -   13s
     0     0  433.99166    0  245          -  433.99166      -     -   13s
     0     0  433.15689    0  248          -  433.15689      -     -   13s
H    0     0                     -24.6536920  433.15689  1857%     -   14s
H    0     0                     -24.6536920  433.15689  1857%     -   16s
     0     2  433.15689    0  248  -24.65369  433.15689  1857%     -   17s
H   36    64                     -24.6536919  399.07307  1719%   500   19s
H   49    64                     -24.6536913  387.77861  1673%   496   19s
    63    96  349.46201    6  238  -24.65369  382.92410  1653%   553   21s
   191   224  318.44541    8  228  -24.65369  373.92244  1617%   470   25s
   837   945  264.10404   15  223  -24.65369  373.92244  1617%   284   30s
  2222  2189  204.80021   28  200  -24.65369  373.92244  1617%   194   35s
  2723  2523  179.88857   35  193  -24.65369  373.92244  1617%   183   52s
H 2728  2523                     -24.6536911  373.92244  1617%   183   52s
H 2734  2523                     -24.6536910  373.92244  1617%   183   52s
H 2737  2523                     -24.6536909  373.92244  1617%   183   52s
H 2752  2523                     -24.6536889  373.92244  1617%   183   52s
H 2753  2523                     -24.6536846  373.92244  1617%   183   52s
  3533  3541  146.51119   44  179  -24.65368  373.92244  1617%   165   55s
  5196  4919  112.55418   54  165  -24.65368  373.92244  1617%   145   60s
  5487  4920  208.09882   26  248  -24.65368  373.92244  1617%   144  104s
  5489  4921  328.53896   10  211  -24.65368  373.92244  1617%   144  106s
  5503  4931  195.04384   36  245  -24.65368  373.92244  1617%   144  110s
  5512  4937    4.77616  109  250  -24.65368  373.92244  1617%   143  115s
  5528  4947   63.61448   77  251  -24.65368  360.99516  1564%   143  122s
  5539  4955  309.30024   11  259  -24.65368  347.47228  1509%   143  126s
  5544  4958  166.67289   39  260  -24.65368  336.48952  1465%   142  130s
  5557  4967  310.32253    6  261  -24.65368  310.32253  1359%   142  135s
  5566  4973  122.44856   50  261  -24.65368  305.86238  1341%   142  145s
  5574  4987  256.51305   13  254  -24.65368  282.50563  1246%   146  150s
  5662  5068  225.60369   16  244  -24.65368  256.54552  1141%   154  158s
H 5663  4817                     -23.2594165  256.54552  1203%   154  158s
H 5675  4575                     -22.7934178  256.54552  1226%   154  158s
H 5684  4346                     -22.7827781  256.54552  1226%   155  158s
H 5687  4131                     -21.9756992  256.54552  1267%   155  158s
  5793  4220  225.54017   18  245  -21.97570  256.54552  1267%   157  160s
  6118  4434  198.71463   22  235  -21.97570  256.54552  1267%   163  165s
  6657  4822  183.46002   28  232  -21.97570  256.54552  1267%   165  170s
H 6744  4640                     -18.5167333  256.54552  1485%   165  173s
H 6761  4441                     -17.9628701  256.54552  1528%   166  173s
H 6769  4255                     -17.8341487  256.54552  1539%   166  173s
H 6772  4080                     -17.4682292  256.54552  1569%   165  173s
H 6773  3913                     -17.4655871  256.54552  1569%   165  173s
  6981  4195  166.07801   31  228  -17.46559  256.54552  1569%   166  175s
  8026  4757  150.91144   36  220  -17.46559  256.54552  1569%   163  180s

Cutting planes:
  Gomory: 10
  Implied bound: 16
  MIR: 807
  Flow cover: 652
  Relax-and-lift: 12

Explored 8236 nodes (1350508 simplex iterations) in 180.06 seconds (419.66 work units)
Thread count was 32 (of 96 available processors)

Solution count 10: -17.4656 -17.4682 -17.8341 ... -24.6537

Time limit reached
Best objective -1.746558709807e+01, best bound 2.565455170225e+02, gap 1568.8628%
No counter example exists in neighborhood.
Time elapsed for full adv. : 180.1586 sec

{'Acc': 98.14, 'Loss': 0.0013320106081664562, 'Elapsed': 180.07148790359497, 'Nodes': 8236.0, 'Arch': '2x200'}
DONT_SAVE OPTION ACTIVE, RESULTS NOT SAVED



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=True, arch='2x50', path='./res/GRID/OBBT_-1-CUTS_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, delta=20.0, obbt=-1, cuts=-1, pretrained_path='./saved_models/ARCH_2x200-EPOCHS_50-ID_10000/checkpoint_1.th', seed=0)

RESUME_|ARCH_2x200-EPOCHS_50-ID_10000|checkpoint_1.th-ID_10000-DELTA_20.0
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x200-EPOCHS_50-ID_10000/checkpoint_1.th'
=> loaded pretrained arch 98.04, with accuracy '2x200'
Test: [49/79]	Loss 0.0000 (0.0958) ([0.000]+[0.000])	Prec@1 100.000 (97.578)
 * Prec@1 98.040
Correct label is  tensor(3)  || Wrong label is  tensor(9)
Model for sequential:
800 variables
410 constraints
400 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0            (1, 200)          200          200            0            0

relu_1              (1, 200)          200            0            0          200

linear_2            (1, 200)          200          200            0            0

relu_3              (1, 200)          200            0            0          200

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1979 rows, 2378 columns and 203130 nonzeros
Model fingerprint: 0xd26601cd
Model has 400 general constraints
Variable types: 2378 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [5e-07, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [3e-05, 2e+01]
Presolve removed 644 rows and 423 columns
Presolve time: 0.35s
Presolved: 1335 rows, 1955 columns, 200156 nonzeros
Variable types: 1651 continuous, 304 integer (304 binary)

Root relaxation: objective 1.003807e+03, 1902 iterations, 0.21 seconds (0.54 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 1003.80691    0  207          - 1003.80691      -     -    0s
     0     0  963.93676    0  206          -  963.93676      -     -    2s
     0     0  944.68788    0  221          -  944.68788      -     -    2s
     0     0  935.44225    0  227          -  935.44225      -     -    2s
     0     0  926.83995    0  229          -  926.83995      -     -    3s
     0     0  926.71862    0  224          -  926.71862      -     -    3s
     0     0  925.84582    0  225          -  925.84582      -     -    3s
     0     0  901.69913    0  220          -  901.69913      -     -    4s
     0     0  891.83580    0  203          -  891.83580      -     -    4s
     0     0  887.60887    0  222          -  887.60887      -     -    4s
     0     0  880.60311    0  233          -  880.60311      -     -    4s
     0     0  864.35134    0  235          -  864.35134      -     -    4s
     0     0  864.35134    0  233          -  864.35134      -     -    5s
     0     0  849.18711    0  233          -  849.18711      -     -    5s
     0     0  846.04233    0  233          -  846.04233      -     -    5s
     0     0  841.49300    0  235          -  841.49300      -     -    5s
     0     0  840.70273    0  235          -  840.70273      -     -    5s
     0     0  840.58806    0  236          -  840.58806      -     -    5s
     0     0  840.57998    0  235          -  840.57998      -     -    5s
     0     0  760.18377    0  229          -  760.18377      -     -    5s
     0     0  751.39781    0  235          -  751.39781      -     -    6s
     0     0  736.91273    0  231          -  736.91273      -     -    6s
     0     0  733.21413    0  229          -  733.21413      -     -    6s
     0     0  732.60672    0  231          -  732.60672      -     -    6s
     0     0  731.50685    0  229          -  731.50685      -     -    6s
     0     0  731.00227    0  231          -  731.00227      -     -    6s
     0     0  730.50227    0  231          -  730.50227      -     -    6s
     0     0  730.48311    0  231          -  730.48311      -     -    6s
     0     0  670.45957    0  224          -  670.45957      -     -    7s
     0     0  666.27165    0  225          -  666.27165      -     -    7s
     0     0  665.10777    0  225          -  665.10777      -     -    7s
     0     0  664.85510    0  227          -  664.85510      -     -    7s
     0     0  635.08827    0  226          -  635.08827      -     -    7s
     0     0  617.50648    0  237          -  617.50648      -     -    7s
     0     0  613.40766    0  239          -  613.40766      -     -    8s
     0     0  611.33529    0  240          -  611.33529      -     -    8s
     0     0  610.38613    0  237          -  610.38613      -     -    8s
     0     0  609.36892    0  238          -  609.36892      -     -    8s
     0     0  608.60214    0  237          -  608.60214      -     -    8s
     0     0  608.34506    0  238          -  608.34506      -     -    8s
     0     0  583.30301    0  238          -  583.30301      -     -    8s
     0     0  580.92617    0  238          -  580.92617      -     -    9s
     0     0  579.26546    0  237          -  579.26546      -     -    9s
     0     0  577.80903    0  241          -  577.80903      -     -    9s
     0     0  577.07029    0  237          -  577.07029      -     -    9s
     0     0  576.90314    0  237          -  576.90314      -     -    9s
     0     0  562.33060    0  236          -  562.33060      -     -    9s
     0     0  561.55694    0  235          -  561.55694      -     -   10s
     0     0  560.16076    0  238          -  560.16076      -     -   10s
     0     0  559.54538    0  239          -  559.54538      -     -   10s
     0     0  556.40014    0  239          -  556.40014      -     -   10s
     0     0  555.41676    0  238          -  555.41676      -     -   10s
     0     0  554.24603    0  241          -  554.24603      -     -   10s
     0     0  553.79373    0  239          -  553.79373      -     -   10s
     0     0  553.59713    0  242          -  553.59713      -     -   10s
     0     0  542.15108    0  243          -  542.15108      -     -   11s
     0     0  541.46505    0  242          -  541.46505      -     -   11s
     0     0  540.76179    0  244          -  540.76179      -     -   11s
     0     0  540.40777    0  246          -  540.40777      -     -   11s
     0     0  539.19095    0  244          -  539.19095      -     -   11s
H    0     0                     -23.1436863  539.19095  2430%     -   12s
     0     0  539.19095    0  244  -23.14369  539.19095  2430%     -   12s
     0     2  539.19095    0  244  -23.14369  539.19095  2430%     -   14s
     1     4  522.89073    1  238  -23.14369  539.18197  2430%   236   15s
H   34    64                     -23.1436862  481.23009  2179%   433   17s
H   38    64                     -23.1436861  481.23009  2179%   423   17s
H   45    64                     -23.1436848  481.23009  2179%   400   17s
    95   128  455.92086    6  231  -23.14368  472.77906  2143%   485   20s
   545   614  381.86577   12  226  -23.14368  472.35419  2141%   325   25s
  2062  2074  284.50341   23  210  -23.14368  472.35419  2141%   197   30s
  2198  2106  267.52390   26  206  -23.14368  472.35419  2141%   195   44s
H 2200  2106                     -23.1435953  472.35419  2141%   195   44s
H 2204  2106                     -23.0641187  472.35419  2148%   196   44s
  2230  2240  255.20828   27  203  -23.06412  472.35419  2148%   196   45s
  3425  3372  164.46226   45  183  -23.06412  472.35419  2148%   179   51s
H 3440  3372                     -22.1908531  472.35419  2229%   179   51s
H 3451  3369                     -21.2507085  472.35419  2323%   179   51s
H 3452  3363                     -20.6728512  472.35419  2385%   179   51s
H 3453  3330                     -18.2216343  472.35419  2692%   179   51s
H 4712  4429                     -13.5357030  472.35419  3590%   164   57s
H 4728  4422                     -13.3349403  472.35419  3642%   164   57s
H 4745  4419                     -13.2809434  472.35419  3657%   165   57s
H 4778  4413                     -12.9832036  472.35419  3738%   164   57s
H 4779  4408                     -12.6360546  472.35419  3838%   164   57s
H 4788  4390                     -11.5074287  472.35419  4205%   164   57s
H 4806  4382                     -11.1281680  472.35419  4345%   164   57s
H 4829  4380                     -11.0316019  472.35419  4382%   164   57s
  6083  6036   59.02587   90  124  -11.03160  472.35419  4382%   152   60s
  6597  6037  267.14572   26  244  -11.03160  472.35419  4382%   148  103s
H 6598  5736                     -11.0316012  472.35419  4382%   148  104s
H 6598  5449                     -11.0316010  472.35419  4382%   148  104s
  6599  5449   75.46729   46  207  -11.03160  472.35419  4382%   148  105s
  6616  5461   59.72794   52  248  -11.03160  472.35419  4382%   147  110s
  6626  5467  169.09367   30  249  -11.03160  455.87885  4232%   147  115s
  6644  5479   90.32501   63  247  -11.03160  405.30047  3774%   147  120s
H 6652  5210                     -11.0316006  393.18468  3664%   147  124s
  6653  5210  230.27349   28  250  -11.03160  390.92913  3644%   147  125s
  6659  5214  388.38207    8  250  -11.03160  388.38207  3621%   146  134s
  6661  5217  209.51169   25  244  -11.03160  388.38207  3621%   149  135s
H 6662  4957                     -11.0316000  388.38207  3621%   149  137s
  6664  4958  121.94331   55  229  -11.03160  388.38207  3621%   149  140s
  6681  4969  172.26168   39  247  -11.03160  366.24917  3420%   148  145s
  6693  4977   20.78554   61  247  -11.03160  350.05740  3273%   148  150s

Cutting planes:
  Gomory: 21
  Implied bound: 7
  MIR: 365
  Flow cover: 146
  Relax-and-lift: 4

Explored 6696 nodes (1014882 simplex iterations) in 180.03 seconds (384.87 work units)
Thread count was 32 (of 96 available processors)

Solution count 9: -11.0316 -11.1282 -11.5074 ... -23.1437

Time limit reached
Best objective -1.103160003666e+01, best bound 3.487467767526e+02, gap 3261.3436%
No counter example exists in neighborhood.
Time elapsed for full adv. : 180.1447 sec

{'Acc': 98.04, 'Loss': 0.0010240235133096576, 'Elapsed': 180.05819511413574, 'Nodes': 6696.0, 'Arch': '2x200'}
DONT_SAVE OPTION ACTIVE, RESULTS NOT SAVED



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=True, arch='2x50', path='./res/GRID/OBBT_-1-CUTS_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, delta=20.0, obbt=-1, cuts=-1, pretrained_path='./saved_models/ARCH_2x200-EPOCHS_50-ID_10000/checkpoint_2.th', seed=0)

RESUME_|ARCH_2x200-EPOCHS_50-ID_10000|checkpoint_2.th-ID_10000-DELTA_20.0
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_2x200-EPOCHS_50-ID_10000/checkpoint_2.th'
=> loaded pretrained arch 97.95, with accuracy '2x200'
Test: [49/79]	Loss 0.0002 (0.0949) ([0.000]+[0.000])	Prec@1 100.000 (97.484)
 * Prec@1 97.950
Correct label is  tensor(3)  || Wrong label is  tensor(5)
Model for sequential:
800 variables
410 constraints
400 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0            (1, 200)          200          200            0            0

relu_1              (1, 200)          200            0            0          200

linear_2            (1, 200)          200          200            0            0

relu_3              (1, 200)          200            0            0          200

linear_4             (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 1979 rows, 2378 columns and 203130 nonzeros
Model fingerprint: 0x6b125f9b
Model has 400 general constraints
Variable types: 2378 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [5e-07, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [5e-05, 2e+01]
Presolve removed 650 rows and 429 columns
Presolve time: 0.35s
Presolved: 1329 rows, 1949 columns, 200141 nonzeros
Variable types: 1648 continuous, 301 integer (301 binary)

Root relaxation: objective 1.017107e+03, 1753 iterations, 0.24 seconds (0.66 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 1017.10747    0  217          - 1017.10747      -     -    0s
     0     0  977.07376    0  212          -  977.07376      -     -    2s
     0     0  962.02941    0  211          -  962.02941      -     -    2s
     0     0  939.79817    0  209          -  939.79817      -     -    2s
     0     0  925.73016    0  220          -  925.73016      -     -    2s
     0     0  923.42729    0  221          -  923.42729      -     -    3s
     0     0  923.37607    0  223          -  923.37607      -     -    3s
     0     0  880.57254    0  213          -  880.57254      -     -    4s
     0     0  852.56038    0  205          -  852.56038      -     -    4s
     0     0  842.03141    0  204          -  842.03141      -     -    4s
     0     0  824.99356    0  205          -  824.99356      -     -    4s
     0     0  806.96364    0  213          -  806.96364      -     -    4s
     0     0  775.33997    0  223          -  775.33997      -     -    4s
     0     0  772.69898    0  221          -  772.69898      -     -    4s
     0     0  771.57022    0  224          -  771.57022      -     -    4s
     0     0  769.57977    0  223          -  769.57977      -     -    5s
     0     0  769.45161    0  223          -  769.45161      -     -    5s
     0     0  769.43207    0  223          -  769.43207      -     -    5s
     0     0  735.11912    0  220          -  735.11912      -     -    5s
     0     0  716.79350    0  216          -  716.79350      -     -    5s
     0     0  690.98216    0  221          -  690.98216      -     -    5s
     0     0  684.58873    0  221          -  684.58873      -     -    5s
     0     0  683.41108    0  222          -  683.41108      -     -    6s
     0     0  682.28888    0  224          -  682.28888      -     -    6s
     0     0  681.67248    0  222          -  681.67248      -     -    6s
     0     0  681.58498    0  223          -  681.58498      -     -    6s
     0     0  562.04068    0  232          -  562.04068      -     -    6s
     0     0  548.09458    0  230          -  548.09458      -     -    6s
     0     0  543.06866    0  232          -  543.06866      -     -    6s
     0     0  538.79436    0  231          -  538.79436      -     -    7s
     0     0  537.05470    0  233          -  537.05470      -     -    7s
     0     0  536.77720    0  233          -  536.77720      -     -    7s
     0     0  502.46508    0  234          -  502.46508      -     -    7s
     0     0  496.51626    0  230          -  496.51626      -     -    7s
     0     0  493.80261    0  233          -  493.80261      -     -    7s
     0     0  492.83029    0  233          -  492.83029      -     -    7s
     0     0  490.92745    0  233          -  490.92745      -     -    7s
     0     0  490.45305    0  233          -  490.45305      -     -    8s
     0     0  463.47597    0  233          -  463.47597      -     -    8s
     0     0  459.82973    0  235          -  459.82973      -     -    8s
     0     0  458.48692    0  236          -  458.48692      -     -    8s
     0     0  457.40463    0  236          -  457.40463      -     -    8s
     0     0  457.05189    0  237          -  457.05189      -     -    8s
     0     0  452.92017    0  241          -  452.92017      -     -    9s
     0     0  451.46625    0  240          -  451.46625      -     -    9s
     0     0  450.65625    0  238          -  450.65625      -     -    9s
     0     0  449.77145    0  237          -  449.77145      -     -    9s
     0     0  449.02591    0  239          -  449.02591      -     -    9s
     0     0  448.70299    0  238          -  448.70299      -     -    9s
     0     0  447.41390    0  238          -  447.41390      -     -   10s
H    0     0                     -16.2939697  447.41390  2846%     -   10s
     0     0  447.41390    0  238  -16.29397  447.41390  2846%     -   11s
     0     2  447.41390    0  238  -16.29397  447.41390  2846%     -   13s
    31    64  373.82810    5  237  -16.29397  408.68811  2608%   435   15s
H   96   128                     -16.1470548  390.56015  2519%   345   19s
H  106   128                     -16.1104770  390.56015  2524%   366   19s
H  112   128                     -15.9533797  390.56015  2548%   355   19s
H  118   128                     -14.8084546  390.56015  2737%   354   19s
   127   160  354.18419    7  234  -14.80845  390.56015  2737%   341   20s
   915  1022  243.18057   15  221  -14.80845  390.56015  2737%   261   25s
  1021  1054  224.67857   16  212  -14.80845  390.56015  2737%   252   37s
  1189  1222  216.36249   18  216  -14.80845  390.56015  2737%   239   41s
H 1191  1222                      -2.1408055  390.56015      -   239   41s
  2223  2206  159.91725   26  201   -2.14081  390.56015      -   201   45s
* 3774  3612             244      -1.5296782  390.56015      -   173   49s
  4132  4041   87.58280   45  174   -1.52968  390.56015      -   169   50s
  4674  4287    9.95101   80  238   -1.52968  390.56015      -   165   88s
  4676  4288  274.13700   13  213   -1.52968  390.56015      -   165   91s
  4694  4300  253.18673   16  241   -1.52968  390.56015      -   164   95s
  4708  4310   44.57734   68  245   -1.52968  390.56015      -   164  100s
  4723  4320   61.43352   39  247   -1.52968  345.71414      -   163  105s
  4733  4326   34.73769   59  249   -1.52968  330.94375      -   163  110s
  4735  4328    7.31543   80  252   -1.52968  330.51755      -   163  152s
H 4738  4114                      -1.5296782  199.89505      -   166  157s
  4739  4114  187.02495   11  191   -1.52968  187.02495      -   166  160s
  4748  4120  159.92624   26  235   -1.52968  159.92624      -   166  165s
  4760  4128  118.03081   31  228   -1.52968  147.86074  9766%   165  170s

Cutting planes:
  Gomory: 21
  MIR: 264
  Flow cover: 11

Explored 4764 nodes (806749 simplex iterations) in 180.03 seconds (366.67 work units)
Thread count was 32 (of 96 available processors)

Solution count 7: -1.52968 -1.52968 -2.14081 ... -16.1471

Time limit reached
Best objective -1.529678166660e+00, best bound 1.455879152194e+02, gap 9617.5520%
No counter example exists in neighborhood.
Time elapsed for full adv. : 180.1813 sec

{'Acc': 97.95, 'Loss': 0.0013240360422059894, 'Elapsed': 180.06607699394226, 'Nodes': 4764.0, 'Arch': '2x200'}
DONT_SAVE OPTION ACTIVE, RESULTS NOT SAVED



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=True, arch='2x50', path='./res/GRID/OBBT_-1-CUTS_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, delta=20.0, obbt=-1, cuts=-1, pretrained_path='./saved_models/ARCH_6x100-EPOCHS_50-ID_10000/checkpoint_0.th', seed=0)

RESUME_|ARCH_6x100-EPOCHS_50-ID_10000|checkpoint_0.th-ID_10000-DELTA_20.0
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_6x100-EPOCHS_50-ID_10000/checkpoint_0.th'
=> loaded pretrained arch 97.6, with accuracy '6x100'
Test: [49/79]	Loss 0.0025 (0.2426) ([0.003]+[0.000])	Prec@1 100.000 (97.156)
 * Prec@1 97.600
Correct label is  tensor(3)  || Wrong label is  tensor(9)
Model for sequential:
1200 variables
610 constraints
600 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0            (1, 100)          100          100            0            0

relu_1              (1, 100)          100            0            0          100

linear_2            (1, 100)          100          100            0            0

relu_3              (1, 100)          100            0            0          100

linear_4            (1, 100)          100          100            0            0

relu_5              (1, 100)          100            0            0          100

linear_6            (1, 100)          100          100            0            0

relu_7              (1, 100)          100            0            0          100

linear_8            (1, 100)          100          100            0            0

relu_9              (1, 100)          100            0            0          100

linear_10           (1, 100)          100          100            0            0

relu_11             (1, 100)          100            0            0          100

linear_12            (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 2179 rows, 2778 columns and 133930 nonzeros
Model fingerprint: 0x3d4a3d28
Model has 600 general constraints
Variable types: 2778 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [1e-07, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [5e-05, 2e+01]
Presolve added 181 rows and 202 columns
Presolve time: 0.58s
Presolved: 2360 rows, 2980 columns, 133852 nonzeros
Variable types: 2097 continuous, 883 integer (883 binary)

Root relaxation: objective 4.218493e+04, 12103 iterations, 2.18 seconds (4.18 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 42184.9278    0  567          - 42184.9278      -     -    2s
     0     0 42175.1859    0  574          - 42175.1859      -     -    4s
     0     0 41925.4648    0  570          - 41925.4648      -     -    5s
     0     0 40051.8632    0  616          - 40051.8632      -     -    6s
     0     0 40051.6874    0  618          - 40051.6874      -     -    6s
     0     0 40051.6574    0  617          - 40051.6574      -     -    6s
     0     0 40051.6574    0  617          - 40051.6574      -     -    6s
     0     0 39987.6935    0  637          - 39987.6935      -     -    8s
     0     0 39933.5759    0  633          - 39933.5759      -     -    8s
     0     0 39846.2726    0  648          - 39846.2726      -     -    9s
     0     0 39821.0033    0  654          - 39821.0033      -     -   10s
     0     0 39819.4152    0  650          - 39819.4152      -     -   10s
     0     0 39818.4085    0  653          - 39818.4085      -     -   10s
     0     0 39816.9403    0  650          - 39816.9403      -     -   10s
     0     0 39816.8462    0  650          - 39816.8462      -     -   10s
     0     0 39793.1147    0  657          - 39793.1147      -     -   11s
     0     0 39756.2882    0  674          - 39756.2882      -     -   12s
     0     0 39736.4283    0  676          - 39736.4283      -     -   12s
     0     0 39733.2707    0  676          - 39733.2707      -     -   12s
     0     0 39602.3378    0  677          - 39602.3378      -     -   13s
     0     0 39595.3556    0  677          - 39595.3556      -     -   13s
     0     0 39594.5288    0  679          - 39594.5288      -     -   13s
     0     0 39567.0546    0  684          - 39567.0546      -     -   14s
     0     0 39556.1418    0  683          - 39556.1418      -     -   16s
     0     0 39545.8540    0  688          - 39545.8540      -     -   17s
     0     0 39538.5283    0  697          - 39538.5283      -     -   17s
     0     0 39536.2532    0  695          - 39536.2532      -     -   17s
     0     0 39535.0973    0  698          - 39535.0973      -     -   17s
     0     0 39507.7032    0  696          - 39507.7032      -     -   19s
     0     0 39495.9174    0  696          - 39495.9174      -     -   19s
     0     0 39489.8934    0  694          - 39489.8934      -     -   19s
     0     0 39486.1590    0  700          - 39486.1590      -     -   19s
     0     0 39483.6074    0  704          - 39483.6074      -     -   20s
     0     0 39482.6403    0  706          - 39482.6403      -     -   20s
     0     0 39463.4107    0  705          - 39463.4107      -     -   21s
     0     0 39454.1129    0  710          - 39454.1129      -     -   21s
     0     0 39446.9016    0  713          - 39446.9016      -     -   22s
     0     0 39443.9412    0  711          - 39443.9412      -     -   22s
     0     0 39442.1750    0  709          - 39442.1750      -     -   22s
     0     0 39430.5994    0  711          - 39430.5994      -     -   23s
     0     0 39423.3473    0  707          - 39423.3473      -     -   24s
     0     0 39419.8790    0  714          - 39419.8790      -     -   24s
     0     0 39417.9372    0  713          - 39417.9372      -     -   24s
     0     0 39406.1708    0  710          - 39406.1708      -     -   25s
     0     0 39401.6126    0  708          - 39401.6126      -     -   26s
     0     0 39399.3159    0  714          - 39399.3159      -     -   26s
     0     0 39396.9622    0  712          - 39396.9622      -     -   26s
     0     0 39393.4998    0  717          - 39393.4998      -     -   27s
     0     0 39393.1696    0  717          - 39393.1696      -     -   27s
     0     0 39382.4717    0  720          - 39382.4717      -     -   28s
     0     0 39382.4717    0  719          - 39382.4717      -     -   29s
     0     2 39382.4717    0  719          - 39382.4717      -     -   41s
     7    16 29971.9756    3  631          - 35336.8551      -  1417   46s
    31    64 25919.3943    5  607          - 32512.4188      -  1961   53s
    95   128 24528.6903    6  576          - 31262.2089      -  1727   55s
   191   226 22015.0163    8  588          - 30054.5696      -  1714   60s
   330   371 20289.3365   10  590          - 29321.8207      -  1654   65s
   409   458 19617.7691   11  579          - 29321.8207      -  1666   70s
   509   565 18429.9967   12  533          - 29321.8207      -  1583   75s
   751   834 17766.6751   14  572          - 29321.8207      -  1430   80s
  1027  1088 14830.1973   17  556          - 29321.8207      -  1344   86s
  1157  1232 13234.6737   18  551          - 29321.8207      -  1386   92s
  1303  1392 10511.6380   20  546          - 29321.8207      -  1416   96s
  1495  1641 8667.34985   22  525          - 29321.8207      -  1393  100s
  2098  2251 5329.41650   35  476          - 29321.8207      -  1210  106s
  2642  2893 4495.86107   42  461          - 29321.8207      -  1097  111s
  3422  3735 3271.74069   56  414          - 29321.8207      -   952  116s
  4291  4551 2242.12677   67  384          - 29321.8207      -   852  121s
  5098  5354 1151.86512   73  367          - 29321.8207      -   807  126s
  5635  5980  855.42294   82  334          - 29321.8207      -   791  130s
  6107  6443  543.34983   91  326          - 29321.8207      -   771  136s
  6800  7178  427.91271   97  303          - 29321.8207      -   751  141s
  7602  8077  206.97039  103  302          - 29321.8207      -   729  145s
  8605  9068   80.62925  117  263          - 29321.8207      -   700  150s
  9675 10240    3.13998  127  176          - 29321.8207      -   679  156s
 10910 11482   -7.52875  148  126          - 29321.8207      -   652  162s
 11595 12139  -16.13269  150  125          - 29287.6511      -   641  165s
 13049 13633 16903.2680   15  602          - 29287.6511      -   619  172s
 13864 14089 13102.4501   23  575          - 29287.6511      -   607  177s
 14390 14704 10180.8751   30  536          - 29287.6511      -   603  180s

Cutting planes:
  Implied bound: 200
  MIR: 389
  Flow cover: 87
  Relax-and-lift: 2

Explored 15055 nodes (9031835 simplex iterations) in 180.03 seconds (606.38 work units)
Thread count was 32 (of 96 available processors)

Solution count 0

Time limit reached
Best objective -, best bound 2.928765110030e+04, gap -
No counter example exists in neighborhood.
Time elapsed for full adv. : 180.1658 sec

{'Acc': 97.6, 'Loss': 6.005989052937366e-05, 'Elapsed': 180.03329706192017, 'Nodes': 15055.0, 'Arch': '6x100'}
DONT_SAVE OPTION ACTIVE, RESULTS NOT SAVED



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=True, arch='2x50', path='./res/GRID/OBBT_-1-CUTS_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, delta=20.0, obbt=-1, cuts=-1, pretrained_path='./saved_models/ARCH_6x100-EPOCHS_50-ID_10000/checkpoint_1.th', seed=0)

RESUME_|ARCH_6x100-EPOCHS_50-ID_10000|checkpoint_1.th-ID_10000-DELTA_20.0
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_6x100-EPOCHS_50-ID_10000/checkpoint_1.th'
=> loaded pretrained arch 97.77, with accuracy '6x100'
Test: [49/79]	Loss 0.0001 (0.1956) ([0.000]+[0.000])	Prec@1 100.000 (97.391)
 * Prec@1 97.770
Correct label is  tensor(3)  || Wrong label is  tensor(2)
Model for sequential:
1200 variables
610 constraints
600 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0            (1, 100)          100          100            0            0

relu_1              (1, 100)          100            0            0          100

linear_2            (1, 100)          100          100            0            0

relu_3              (1, 100)          100            0            0          100

linear_4            (1, 100)          100          100            0            0

relu_5              (1, 100)          100            0            0          100

linear_6            (1, 100)          100          100            0            0

relu_7              (1, 100)          100            0            0          100

linear_8            (1, 100)          100          100            0            0

relu_9              (1, 100)          100            0            0          100

linear_10           (1, 100)          100          100            0            0

relu_11             (1, 100)          100            0            0          100

linear_12            (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 2179 rows, 2778 columns and 133930 nonzeros
Model fingerprint: 0xab662c51
Model has 600 general constraints
Variable types: 2778 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [6e-07, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [5e-05, 2e+01]
Presolve added 176 rows and 197 columns
Presolve time: 0.56s
Presolved: 2355 rows, 2975 columns, 133840 nonzeros
Variable types: 2095 continuous, 880 integer (880 binary)

Root relaxation: objective 3.372488e+04, 12716 iterations, 2.29 seconds (4.65 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 33724.8777    0  550          - 33724.8777      -     -    3s
     0     0 33564.7153    0  556          - 33564.7153      -     -    5s
     0     0 33073.4483    0  560          - 33073.4483      -     -    5s
     0     0 31231.9290    0  596          - 31231.9290      -     -    6s
     0     0 31217.1186    0  588          - 31217.1186      -     -    7s
     0     0 31217.0114    0  590          - 31217.0114      -     -    7s
     0     0 31216.9972    0  590          - 31216.9972      -     -    7s
     0     0 31216.9967    0  590          - 31216.9967      -     -    7s
     0     0 31184.3511    0  590          - 31184.3511      -     -    8s
     0     0 31135.9966    0  601          - 31135.9966      -     -    9s
     0     0 31050.4877    0  622          - 31050.4877      -     -    9s
     0     0 31032.0881    0  638          - 31032.0881      -     -   10s
     0     0 31029.4169    0  631          - 31029.4169      -     -   10s
     0     0 31029.1300    0  630          - 31029.1300      -     -   10s
     0     0 31006.5972    0  644          - 31006.5972      -     -   11s
     0     0 30995.6671    0  653          - 30995.6671      -     -   12s
     0     0 30979.2557    0  658          - 30979.2557      -     -   12s
     0     0 30972.6896    0  653          - 30972.6896      -     -   12s
     0     0 30855.7810    0  658          - 30855.7810      -     -   13s
     0     0 30855.0254    0  659          - 30855.0254      -     -   13s
     0     0 30831.7596    0  657          - 30831.7596      -     -   15s
     0     0 30812.8256    0  666          - 30812.8256      -     -   15s
     0     0 30808.7285    0  669          - 30808.7285      -     -   15s
     0     0 30803.9629    0  666          - 30803.9629      -     -   16s
     0     0 30799.2093    0  670          - 30799.2093      -     -   16s
     0     0 30798.1725    0  667          - 30798.1725      -     -   16s
     0     0 30776.3270    0  675          - 30776.3270      -     -   17s
     0     0 30763.5344    0  673          - 30763.5344      -     -   20s
     0     0 30756.7966    0  681          - 30756.7966      -     -   20s
     0     0 30737.0514    0  684          - 30737.0514      -     -   20s
     0     0 30730.7301    0  689          - 30730.7301      -     -   21s
     0     0 30729.6753    0  686          - 30729.6753      -     -   21s
     0     0 30712.5356    0  680          - 30712.5356      -     -   22s
     0     0 30698.5210    0  685          - 30698.5210      -     -   23s
     0     0 30683.6752    0  683          - 30683.6752      -     -   23s
     0     0 30677.7778    0  679          - 30677.7778      -     -   24s
     0     0 30674.6193    0  687          - 30674.6193      -     -   24s
     0     0 30672.8833    0  685          - 30672.8833      -     -   24s
     0     0 30659.6040    0  677          - 30659.6040      -     -   25s
     0     0 30655.3474    0  676          - 30655.3474      -     -   26s
     0     0 30647.4251    0  680          - 30647.4251      -     -   26s
     0     0 30644.9752    0  689          - 30644.9752      -     -   26s
     0     0 30643.8218    0  685          - 30643.8218      -     -   26s
     0     0 30592.0080    0  690          - 30592.0080      -     -   28s
     0     0 30583.2608    0  681          - 30583.2608      -     -   28s
     0     0 30579.9709    0  682          - 30579.9709      -     -   28s
     0     0 30578.3460    0  687          - 30578.3460      -     -   28s
     0     0 30565.6458    0  692          - 30565.6458      -     -   29s
     0     0 30557.3703    0  688          - 30557.3703      -     -   30s
     0     0 30550.1925    0  692          - 30550.1925      -     -   30s
     0     0 30547.2408    0  689          - 30547.2408      -     -   30s
     0     0 30544.2532    0  689          - 30544.2532      -     -   31s
     0     0 30542.3562    0  691          - 30542.3562      -     -   31s
     0     0 30535.6231    0  690          - 30535.6231      -     -   32s
     0     0 30526.7980    0  687          - 30526.7980      -     -   32s
     0     0 30525.0158    0  690          - 30525.0158      -     -   32s
     0     0 30515.2580    0  691          - 30515.2580      -     -   33s
     0     0 30515.2580    0  691          - 30515.2580      -     -   35s
     0     2 30515.2580    0  691          - 30515.2580      -     -   47s
     7    16 25453.9129    3  695          - 28419.8780      -  1638   50s
    95   128 19901.4033    6  628          - 26087.7401      -   855   57s
   224   263 19855.0836    8  645          - 24225.4767      -  1152   61s
   341   380 16903.6208   10  592          - 23603.6512      -  1075   65s
   479   528 16213.3625   13  604          - 23231.0543      -  1069   70s
   634   667 14041.8960   17  584          - 23231.0543      -  1165   78s
   720   793 13656.5148   18  580          - 23231.0543      -  1250   81s
   870   947 11161.3028   21  581          - 23231.0543      -  1162   85s
  1308  1435 7907.26139   33  509          - 23231.0543      -   938   90s
  1779  1929 5259.61103   46  470          - 23231.0543      -   856   95s
  2690  2928 3716.27514   59  396          - 23231.0543      -   707  100s
  3813  4073 2381.34198   79  363          - 23231.0543      -   613  106s
  4869  5173 1118.60601   95  326          - 23231.0543      -   564  111s
  5738  6038  686.91059  107  309          - 23231.0543      -   542  115s
  7061  7428  391.72890  125  261          - 23231.0543      -   519  121s
  7875  8384  221.64678  141  226          - 23231.0543      -   506  126s
  8411  8817  155.32328  155  213          - 23231.0543      -   496  130s
  9950 10382   40.39185  209  137          - 23231.0543      -   479  137s
 10477 10840   20.66043  226  111          - 23029.1729      -   474  141s
 11777 12416 15777.3277   13  547          - 23029.1729      -   456  147s
 12677 13161 14080.8142   21  584          - 23029.1729      -   444  150s
 14411 14611 10297.5442   32  540          - 23029.1729      -   428  157s
 15219 14612   17.01530  248  691          - 23029.1729      -   424  161s

Explored 15221 nodes (6510194 simplex iterations) in 180.01 seconds (514.91 work units)
Thread count was 32 (of 96 available processors)

Solution count 0

Time limit reached
Best objective -, best bound 2.302917293013e+04, gap -
No counter example exists in neighborhood.
Time elapsed for full adv. : 180.1390 sec

{'Acc': 97.77, 'Loss': 9.031626541400328e-05, 'Elapsed': 180.03658986091614, 'Nodes': 15221.0, 'Arch': '6x100'}
DONT_SAVE OPTION ACTIVE, RESULTS NOT SAVED



===================================================================
===================================================================


===================================================================
===================================================================

Experiments configuration:
Namespace(trainonly=False, prune=False, expnum=1, dont_save=True, arch='2x50', path='./res/GRID/OBBT_-1-CUTS_-1', save_path='./saved_models', epochs=50, optim='sgd', lr=0.1, wd=0.0, momentum=0.0, batch_size=128, print_freq=100, reg='spr', lamb=0.0, alpha=0.0, M='layer', dim=1, ft_epochs=10, threshold=0.05, threshold_str=0.005, samp_id=10000, time=180, delta=20.0, obbt=-1, cuts=-1, pretrained_path='./saved_models/ARCH_6x100-EPOCHS_50-ID_10000/checkpoint_2.th', seed=0)

RESUME_|ARCH_6x100-EPOCHS_50-ID_10000|checkpoint_2.th-ID_10000-DELTA_20.0
===============================================================
Experiment 0:
===============================================================

=> loading pretrained model from './saved_models/ARCH_6x100-EPOCHS_50-ID_10000/checkpoint_2.th'
=> loaded pretrained arch 97.67, with accuracy '6x100'
Test: [49/79]	Loss 0.0407 (0.2446) ([0.041]+[0.000])	Prec@1 99.219 (97.156)
 * Prec@1 97.670
Correct label is  tensor(3)  || Wrong label is  tensor(8)
Model for sequential:
1200 variables
610 constraints
600 general constraints
Input has shape (1, 784)
Output has shape (1, 10)

--------------------------------------------------------------------------------
Layer           Output Shape    Variables              Constraints              
                                                Linear    Quadratic      General
================================================================================
linear_0            (1, 100)          100          100            0            0

relu_1              (1, 100)          100            0            0          100

linear_2            (1, 100)          100          100            0            0

relu_3              (1, 100)          100            0            0          100

linear_4            (1, 100)          100          100            0            0

relu_5              (1, 100)          100            0            0          100

linear_6            (1, 100)          100          100            0            0

relu_7              (1, 100)          100            0            0          100

linear_8            (1, 100)          100          100            0            0

relu_9              (1, 100)          100            0            0          100

linear_10           (1, 100)          100          100            0            0

relu_11             (1, 100)          100            0            0          100

linear_12            (1, 10)            0           10            0            0

--------------------------------------------------------------------------------
Set parameter BestBdStop to value 0
Set parameter BestObjStop to value 0
Set parameter TimeLimit to value 180
Gurobi Optimizer version 10.0.1 build v10.0.1rc0 (linux64)

CPU model: AMD EPYC 7402 24-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 48 physical cores, 96 logical processors, using up to 32 threads

Optimize a model with 2179 rows, 2778 columns and 133930 nonzeros
Model fingerprint: 0x9247466c
Model has 600 general constraints
Variable types: 2778 continuous, 0 integer (0 binary)
Coefficient statistics:
  Matrix range     [8e-07, 1e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [2e-05, 2e+01]
Presolve added 132 rows and 153 columns
Presolve time: 0.56s
Presolved: 2311 rows, 2931 columns, 133744 nonzeros
Variable types: 2087 continuous, 844 integer (844 binary)

Root relaxation: objective 2.656730e+04, 6465 iterations, 0.98 seconds (2.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 26567.3041    0  499          - 26567.3041      -     -    1s
     0     0 26557.5704    0  511          - 26557.5704      -     -    3s
     0     0 26405.0909    0  516          - 26405.0909      -     -    3s
     0     0 25162.3528    0  578          - 25162.3528      -     -    4s
     0     0 25161.3303    0  576          - 25161.3303      -     -    4s
     0     0 25161.3070    0  574          - 25161.3070      -     -    4s
     0     0 25161.3015    0  575          - 25161.3015      -     -    4s
     0     0 25161.3010    0  575          - 25161.3010      -     -    4s
     0     0 25090.6681    0  581          - 25090.6681      -     -    5s
     0     0 25015.1144    0  572          - 25015.1144      -     -    7s
     0     0 24991.2001    0  599          - 24991.2001      -     -    8s
     0     0 24986.0507    0  602          - 24986.0507      -     -    8s
     0     0 24985.3866    0  599          - 24985.3866      -     -    8s
     0     0 24985.3334    0  599          - 24985.3334      -     -    8s
     0     0 24964.5405    0  601          - 24964.5405      -     -    9s
     0     0 24924.6226    0  616          - 24924.6226      -     -   10s
     0     0 24916.5541    0  612          - 24916.5541      -     -   10s
     0     0 24909.3245    0  612          - 24909.3245      -     -   10s
     0     0 24841.8338    0  615          - 24841.8338      -     -   10s
     0     0 24841.5780    0  616          - 24841.5780      -     -   10s
     0     0 24827.6665    0  615          - 24827.6665      -     -   12s
     0     0 24810.8676    0  623          - 24810.8676      -     -   12s
     0     0 24807.0389    0  626          - 24807.0389      -     -   12s
     0     0 24804.0476    0  624          - 24804.0476      -     -   13s
     0     0 24802.7945    0  626          - 24802.7945      -     -   13s
     0     0 24802.1640    0  627          - 24802.1640      -     -   13s
     0     0 24784.3272    0  634          - 24784.3272      -     -   14s
     0     0 24778.0219    0  632          - 24778.0219      -     -   14s
     0     0 24765.9193    0  638          - 24765.9193      -     -   15s
     0     0 24762.6826    0  636          - 24762.6826      -     -   15s
     0     0 24759.8468    0  639          - 24759.8468      -     -   15s
     0     0 24759.4497    0  634          - 24759.4497      -     -   15s
     0     0 24743.3208    0  634          - 24743.3208      -     -   16s
     0     0 24735.5392    0  637          - 24735.5392      -     -   17s
     0     0 24730.4942    0  636          - 24730.4942      -     -   17s
     0     0 24727.8756    0  643          - 24727.8756      -     -   17s
     0     0 24726.1439    0  643          - 24726.1439      -     -   17s
     0     0 24725.2316    0  642          - 24725.2316      -     -   17s
     0     0 24707.2415    0  635          - 24707.2415      -     -   18s
     0     0 24698.0951    0  638          - 24698.0951      -     -   19s
     0     0 24688.3614    0  642          - 24688.3614      -     -   19s
     0     0 24682.4728    0  649          - 24682.4728      -     -   19s
     0     0 24678.8230    0  655          - 24678.8230      -     -   19s
     0     0 24677.7440    0  653          - 24677.7440      -     -   20s
     0     0 24665.4517    0  649          - 24665.4517      -     -   21s
     0     0 24661.3472    0  655          - 24661.3472      -     -   21s
     0     0 24658.6780    0  656          - 24658.6780      -     -   21s
     0     0 24656.5182    0  656          - 24656.5182      -     -   21s
     0     0 24653.8417    0  655          - 24653.8417      -     -   22s
     0     0 24653.3139    0  655          - 24653.3139      -     -   22s
     0     0 24633.5456    0  662          - 24633.5456      -     -   23s
     0     0 24620.2564    0  658          - 24620.2564      -     -   23s
     0     0 24615.4497    0  656          - 24615.4497      -     -   24s
     0     0 24612.7488    0  656          - 24612.7488      -     -   24s
     0     0 24611.4492    0  656          - 24611.4492      -     -   24s
     0     0 24602.7885    0  657          - 24602.7885      -     -   25s
     0     0 24597.1556    0  664          - 24597.1556      -     -   25s
     0     0 24593.3991    0  662          - 24593.3991      -     -   25s
     0     0 24591.9831    0  666          - 24591.9831      -     -   26s
     0     0 24579.6066    0  663          - 24579.6066      -     -   27s
     0     0 24576.2103    0  666          - 24576.2103      -     -   29s
     0     0 24573.7239    0  667          - 24573.7239      -     -   29s
     0     0 24571.8542    0  668          - 24571.8542      -     -   29s
     0     0 24545.4236    0  664          - 24545.4236      -     -   30s
     0     0 24533.3149    0  668          - 24533.3149      -     -   30s
     0     0 24526.3599    0  665          - 24526.3599      -     -   31s
     0     0 24524.4648    0  668          - 24524.4648      -     -   31s
     0     0 24514.0747    0  666          - 24514.0747      -     -   32s
     0     0 24509.0470    0  669          - 24509.0470      -     -   32s
     0     0 24507.6748    0  670          - 24507.6748      -     -   32s
     0     0 24448.1744    0  668          - 24448.1744      -     -   33s
     0     0 24426.6614    0  671          - 24426.6614      -     -   33s
     0     0 24422.3052    0  670          - 24422.3052      -     -   34s
     0     0 24420.0513    0  670          - 24420.0513      -     -   34s
     0     0 24418.9385    0  671          - 24418.9385      -     -   34s
     0     0 24390.7364    0  664          - 24390.7364      -     -   35s
     0     0 24377.4882    0  669          - 24377.4882      -     -   35s
     0     0 24373.7887    0  667          - 24373.7887      -     -   35s
     0     0 24371.8057    0  668          - 24371.8057      -     -   35s
     0     0 24296.3051    0  671          - 24296.3051      -     -   37s
     0     0 24287.4489    0  674          - 24287.4489      -     -   37s
     0     0 24284.3617    0  678          - 24284.3617      -     -   37s
     0     0 24282.8419    0  671          - 24282.8419      -     -   37s
     0     0 24275.9327    0  674          - 24275.9327      -     -   38s
H    0     0                      -9.4228516 24275.9327      -     -   40s
     0     0 24275.9327    0  674   -9.42285 24275.9327      -     -   40s
     0     2 24275.9327    0  674   -9.42285 24275.9327      -     -   45s
     3     8 16752.9509    2  579   -9.42285 22534.2337      -  4565   50s
H   31    64                      -9.4228516 19402.9962      -  2731   61s
H   35    64                      -9.4228495 19402.9962      -  2835   61s
    64    65 15101.2642    6  674   -9.42285 18469.7064      -  2747   79s
    66    66 15271.7264    6  296   -9.42285 18469.7064      -  2664   81s
    71    75 18469.7064   15  301   -9.42285 18469.7064      -  58.8   85s
    83    95 18469.7064   17  297   -9.42285 18469.7064      -   732   91s
    99   121 18469.7064   18  298   -9.42285 18469.7064      -  1764   97s
   131   143 18469.7064   19  297   -9.42285 18469.7064      -  2853  102s
   310   289 15890.3614   22  293   -9.42285 18469.7064      -  2492  105s
   830   831 12561.2899   32  290   -9.42285 18469.7064      -  1385  110s
  1612  1652 9549.97671   44  261   -9.42285 18469.7064      -   972  115s
  2660  2744 6997.49801   60  257   -9.42285 18469.7064      -   765  120s
  3994  4124 3890.40889   80  220   -9.42285 18469.7064      -   671  125s
  5058  5245 2734.85418   98  212   -9.42285 18469.7064      -   647  130s
  6321  6512 2037.22130  122  195   -9.42285 18469.7064      -   629  141s
  6763  7002 1661.09949  130  197   -9.42285 18469.7064      -   624  149s
  7079  7243 1375.09116  135  188   -9.42285 18469.7064      -   620  151s
  8119  8432 1182.50230  153  175   -9.42285 18469.7064      -   604  156s
  8987  9224  686.56694  170  165   -9.42285 18469.7064      -   592  161s
  9399  9657  655.41956  179  156   -9.42285 18469.7064      -   588  168s
  9838 10108  580.81864  189  154   -9.42285 18469.7064      -   585  170s
 11370 11710  180.69352  221  131   -9.42285 18469.7064      -   591  176s
 12436 12366   86.39426  247  120   -9.42285 18469.7064      -   585  180s

Explored 12601 nodes (7574705 simplex iterations) in 180.02 seconds (475.41 work units)
Thread count was 32 (of 96 available processors)

Solution count 2: -9.42285 -9.42285 

Time limit reached
Best objective -9.422849456449e+00, best bound 1.846970641205e+04, gap 196109.7792%
No counter example exists in neighborhood.
Time elapsed for full adv. : 180.1486 sec

{'Acc': 97.67, 'Loss': 8.251458893937524e-06, 'Elapsed': 180.0302770137787, 'Nodes': 12601.0, 'Arch': '6x100'}
DONT_SAVE OPTION ACTIVE, RESULTS NOT SAVED



===================================================================
===================================================================


